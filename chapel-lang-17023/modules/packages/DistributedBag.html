

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>DistributedBag &mdash; Chapel Documentation 1.24</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="DistributedDeque" href="DistributedDeque.html" />
    <link rel="prev" title="Curl" href="Curl.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

<a href="../../index.html" class="icon icon-home"> Chapel Documentation

<!-- display version if button won't be rendered -->
<?php if (false) { ?>
<br>1.24
<?php } ?>

</a>

<?php
// Variables given by sphinx
$chplTitle = "1.24";
$pagename = "modules/packages/DistributedBag";
include "../..//versionButton.php";
?>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Compiling and Running Chapel</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../usingchapel/QUICKSTART.html">Quickstart Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usingchapel/index.html">Using Chapel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../platforms/index.html">Platform-Specific Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../technotes/index.html">Technical Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">Tools</a></li>
</ul>
<p class="caption"><span class="caption-text">Writing Chapel Programs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../language/reference.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Hello World Variants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../primers/index.html">Primers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../language/spec/index.html">Language Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../builtins/index.html">Built-in Types and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../standard.html">Standard Modules</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../packages.html">Package Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="AllLocalesBarriers.html">AllLocalesBarriers</a></li>
<li class="toctree-l2"><a class="reference internal" href="AtomicObjects.html">AtomicObjects</a></li>
<li class="toctree-l2"><a class="reference internal" href="BLAS.html">BLAS</a></li>
<li class="toctree-l2"><a class="reference internal" href="Buffers.html">Buffers</a></li>
<li class="toctree-l2"><a class="reference internal" href="Collection.html">Collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="Crypto.html">Crypto</a></li>
<li class="toctree-l2"><a class="reference internal" href="Curl.html">Curl</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">DistributedBag</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#planned-improvements">Planned Improvements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="DistributedDeque.html">DistributedDeque</a></li>
<li class="toctree-l2"><a class="reference internal" href="DistributedIters.html">DistributedIters</a></li>
<li class="toctree-l2"><a class="reference internal" href="EpochManager.html">EpochManager</a></li>
<li class="toctree-l2"><a class="reference internal" href="FFTW.html">FFTW</a></li>
<li class="toctree-l2"><a class="reference internal" href="FunctionalOperations.html">FunctionalOperations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Futures.html">Futures</a></li>
<li class="toctree-l2"><a class="reference internal" href="HDF5.html">HDF5</a></li>
<li class="toctree-l2"><a class="reference internal" href="HDFS.html">HDFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="LAPACK.html">LAPACK</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebra.html">LinearAlgebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinkedLists.html">LinkedLists</a></li>
<li class="toctree-l2"><a class="reference internal" href="LockFreeQueue.html">LockFreeQueue</a></li>
<li class="toctree-l2"><a class="reference internal" href="LockFreeStack.html">LockFreeStack</a></li>
<li class="toctree-l2"><a class="reference internal" href="MPI.html">MPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="NetCDF.html">NetCDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="Norm.html">Norm</a></li>
<li class="toctree-l2"><a class="reference internal" href="OrderedSet.html">OrderedSet</a></li>
<li class="toctree-l2"><a class="reference internal" href="PeekPoke.html">PeekPoke</a></li>
<li class="toctree-l2"><a class="reference internal" href="RangeChunk.html">RangeChunk</a></li>
<li class="toctree-l2"><a class="reference internal" href="RecordParser.html">RecordParser</a></li>
<li class="toctree-l2"><a class="reference internal" href="ReplicatedVar.html">ReplicatedVar</a></li>
<li class="toctree-l2"><a class="reference internal" href="Search.html">Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="Sort.html">Sort</a></li>
<li class="toctree-l2"><a class="reference internal" href="TOML.html">TOML</a></li>
<li class="toctree-l2"><a class="reference internal" href="URL.html">URL</a></li>
<li class="toctree-l2"><a class="reference internal" href="UnitTest.html">UnitTest</a></li>
<li class="toctree-l2"><a class="reference internal" href="UnorderedAtomics.html">UnorderedAtomics</a></li>
<li class="toctree-l2"><a class="reference internal" href="UnorderedCopy.html">UnorderedCopy</a></li>
<li class="toctree-l2"><a class="reference internal" href="VisualDebug.html">VisualDebug</a></li>
<li class="toctree-l2"><a class="reference internal" href="ZMQ.html">ZMQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../packages.html#index">Index</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../layoutdist.html">Standard Layouts and Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mason-packages.html">Mason Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users-guide/index.html">Chapel Users Guide (WIP)</a></li>
</ul>
<p class="caption"><span class="caption-text">Language History</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../language/evolution.html">Chapel Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../language/archivedSpecs.html">Documentation Archives</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Chapel Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../packages.html">Package Modules</a> &raquo;</li>
        
      <li>DistributedBag</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/modules/packages/DistributedBag.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="module-DistributedBag"></span><div class="section" id="distributedbag">
<h1>DistributedBag<a class="headerlink" href="#distributedbag" title="Permalink to this headline">¶</a></h1>
<p><strong>Usage</strong></p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">DistributedBag</span><span class="p">;</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nx">DistributedBag</span><span class="p">;</span>
</pre></div>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>A parallel-safe distributed multiset implementation that scales in terms of
nodes, processors per node (PPN), and workload; The more PPN, the more segments
we allocate to increase raw parallelism, and the larger the workload the better
locality (see <a class="reference internal" href="#DistributedBag.distributedBagInitialBlockSize" title="DistributedBag.distributedBagInitialBlockSize"><code class="xref chpl chpl-const docutils literal notranslate"><span class="pre">distributedBagInitialBlockSize</span></code></a>). This data structure is unordered
and employs its own work stealing algorithm to balance work across nodes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This module is a work in progress and may change in future releases.</p>
</div>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>To use <a class="reference internal" href="#DistributedBag.DistBag" title="DistributedBag.DistBag"><code class="xref chpl chpl-record docutils literal notranslate"><span class="pre">DistBag</span></code></a>, the initializer must be invoked explicitly to
properly initialize the structure. Using the default state without initializing
will result in a halt.</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">bag</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">DistBag</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="nx">targetLocales</span><span class="o">=</span><span class="nx">ourTargetLocales</span><span class="p">);</span>
</pre></div>
</div>
<p>While the bag is safe to use in a distributed manner, each node always operates on it’s privatized
instance. This means that it is easy to add data in bulk, expecting it to be distributed, when in
reality it is not; if another node needs data, it will steal work on-demand. This may not always be
desired, and likely will more memory consumption on a single node. We offer a way for the user to
invoke a more static load balancing approach, called <a class="reference internal" href="#DistributedBag.DistributedBagImpl.balance" title="DistributedBag.DistributedBagImpl.balance"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">DistributedBagImpl.balance</span></code></a>, which will redistributed work.</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">bag</span><span class="p">.</span><span class="nx">addBulk</span><span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="nx">N</span><span class="p">);</span>
<span class="nx">bag</span><span class="p">.</span><span class="nx">balance</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="planned-improvements">
<h2>Planned Improvements<a class="headerlink" href="#planned-improvements" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Dynamic work-stealing will require an overhaul to use a helper algorithm to keep down
the number of tasks spawned. Currently user tasks will wait on the current work-stealer
task, which will spawn is own helper tasks which act as shepherds, which then spawns more
in a fork-join fashion. This leads to an excessive amount of tasks being spawned at once.
To make matters worse, the waiting tasks don’t even get any elements, nor does the work
stealing task, which opens up the possibility of live-lock where nodes steal work back
and forth before either can process it.</p></li>
<li><p>Static work-stealing (A.K.A <a class="reference internal" href="#DistributedBag.DistributedBagImpl.balance" title="DistributedBag.DistributedBagImpl.balance"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">DistributedBagImpl.balance</span></code></a>) requires a rework that performs a more distributed
and fast way of distributing memory, as currently ‘excess’ elements are shifted to a single
node to be redistributed in the next pass. On the note, we need to collapse the pass for moving
excess elements into a single pass, hopefully with a zero-copy overhead.</p></li>
</ol>
</div>
<div class="section" id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h2>
<dl class="chpl data">
<dt id="DistributedBag.distributedBagInitialBlockSize">
<em class="property">config const </em><code class="sig-name descname">distributedBagInitialBlockSize</code> = 1024<a class="headerlink" href="#DistributedBag.distributedBagInitialBlockSize" title="Permalink to this definition">¶</a></dt>
<dd><p>The initial amount of elements in an unroll block. Each successive unroll block
is double the size of it’s predecessor, allowing for better locality for when
there are larger numbers of elements. The better the locality, the better raw
performance and easier it is to redistribute work.</p>
</dd></dl>

<dl class="chpl data">
<dt id="DistributedBag.distributedBagWorkStealingRatio">
<em class="property">config const </em><code class="sig-name descname">distributedBagWorkStealingRatio</code> = 0.25<a class="headerlink" href="#DistributedBag.distributedBagWorkStealingRatio" title="Permalink to this definition">¶</a></dt>
<dd><p>To prevent stealing too many elements (horizontally) from another node’s segment
(hence creating an artificial load imbalance), if the other node’s segment has
less than a certain threshold (see <a class="reference internal" href="#DistributedBag.distributedBagWorkStealingMemCap" title="DistributedBag.distributedBagWorkStealingMemCap"><code class="xref chpl chpl-const docutils literal notranslate"><span class="pre">distributedBagWorkStealingMemCap</span></code></a>) but above
another threshold (see <a class="reference internal" href="#DistributedBag.distributedBagWorkStealingMinElems" title="DistributedBag.distributedBagWorkStealingMinElems"><code class="xref chpl chpl-const docutils literal notranslate"><span class="pre">distributedBagWorkStealingMinElems</span></code></a>), we steal a percentage of their
elements, leaving them with majority of their elements. This way, the amount the
other segment loses is proportional to how much it owns, ensuring a balance.</p>
</dd></dl>

<dl class="chpl data">
<dt id="DistributedBag.distributedBagWorkStealingMemCap">
<em class="property">config const </em><code class="sig-name descname">distributedBagWorkStealingMemCap</code>: real = 1.0<a class="headerlink" href="#DistributedBag.distributedBagWorkStealingMemCap" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum amount of work to steal from a horizontal node’s segment. This
should be set to a value, in megabytes, that determines the maximum amount of
data that should be sent in bulk at once. The maximum number of elements is
determined by: (<a class="reference internal" href="#DistributedBag.distributedBagWorkStealingMemCap" title="DistributedBag.distributedBagWorkStealingMemCap"><code class="xref chpl chpl-const docutils literal notranslate"><span class="pre">distributedBagWorkStealingMemCap</span></code></a> * 1024 * 1024) / sizeof(<code class="docutils literal notranslate"><span class="pre">eltType</span></code>).
For example, if we are storing 8-byte integers and have a 1MB limit, we would
have a maximum of 125,000 elements stolen at once.</p>
</dd></dl>

<dl class="chpl data">
<dt id="DistributedBag.distributedBagWorkStealingMinElems">
<em class="property">config const </em><code class="sig-name descname">distributedBagWorkStealingMinElems</code> = 1<a class="headerlink" href="#DistributedBag.distributedBagWorkStealingMinElems" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum number of elements a horizontal segment must have to become eligible
to be stolen from. This may be useful if some segments produce less elements than
others and should not be stolen from.</p>
</dd></dl>

<dl class="chpl data">
<dt id="DistributedBag.distributedBagMaxBlockSize">
<em class="property">config const </em><code class="sig-name descname">distributedBagMaxBlockSize</code> = 1024*1024<a class="headerlink" href="#DistributedBag.distributedBagMaxBlockSize" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum amount of elements in an unroll block. This is crucial to ensure memory
usage does not rapidly grow out of control.</p>
</dd></dl>

<dl class="chpl record">
<dt id="DistributedBag.DistBag">
<em class="property">record </em><code class="sig-name descname">DistBag</code><a class="headerlink" href="#DistributedBag.DistBag" title="Permalink to this definition">¶</a></dt>
<dd><p>A parallel-safe distributed multiset implementation that scales in terms of
nodes, processors per node (PPN), and workload; The more PPN, the more segments
we allocate to increase raw parallelism, and the larger the workload the better
locality (see <a class="reference internal" href="#DistributedBag.distributedBagInitialBlockSize" title="DistributedBag.distributedBagInitialBlockSize"><code class="xref chpl chpl-const docutils literal notranslate"><span class="pre">distributedBagInitialBlockSize</span></code></a>). This data structure is unordered and employs
its own work-stealing algorithm, and provides a means to obtain a privatized instance of
the data structure for maximized performance.</p>
<dl class="chpl attribute">
<dt id="DistributedBag.DistBag.eltType">
<em class="property">type </em><code class="sig-name descname">eltType</code><a class="headerlink" href="#DistributedBag.DistBag.eltType" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="chpl attribute">
<dt id="DistributedBag.DistBag._impl">
<em class="property">var </em><code class="sig-name descname">_impl</code>: unmanaged nilable DistributedBagImpl(eltType)<a class="headerlink" href="#DistributedBag.DistBag._impl" title="Permalink to this definition">¶</a></dt>
<dd><p>The implementation of the Bag is forwarded. See <a class="reference internal" href="#DistributedBag.DistributedBagImpl" title="DistributedBag.DistributedBagImpl"><code class="xref chpl chpl-class docutils literal notranslate"><span class="pre">DistributedBagImpl</span></code></a> for
documentation.</p>
</dd></dl>

</dd></dl>

<dl class="chpl class">
<dt id="DistributedBag.DistributedBagImpl">
<em class="property">class </em><code class="sig-name descname">DistributedBagImpl</code>: CollectionImpl<a class="headerlink" href="#DistributedBag.DistributedBagImpl" title="Permalink to this definition">¶</a></dt>
<dd><dl class="chpl attribute">
<dt id="DistributedBag.DistributedBagImpl.targetLocales">
<em class="property">var </em><code class="sig-name descname">targetLocales</code>: [targetLocDom] locale<a class="headerlink" href="#DistributedBag.DistributedBagImpl.targetLocales" title="Permalink to this definition">¶</a></dt>
<dd><p>The locales to allocate bags for and load balance across.</p>
</dd></dl>

<dl class="chpl method">
<dt id="DistributedBag.DistributedBagImpl.init">
<em class="property">proc </em><code class="sig-name descname">init</code><span class="sig-paren">(</span><em class="sig-param">type eltType</em>, <em class="sig-param">targetLocales: [?targetLocDom] locale = Locales</em><span class="sig-paren">)</span><a class="headerlink" href="#DistributedBag.DistributedBagImpl.init" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="chpl method">
<dt id="DistributedBag.DistributedBagImpl.add">
<em class="property">override proc </em><code class="sig-name descname">add</code><span class="sig-paren">(</span><em class="sig-param">elt: eltType</em><span class="sig-paren">)</span>: bool<a class="headerlink" href="#DistributedBag.DistributedBagImpl.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert an element to this node’s bag. The ordering is not guaranteed to be
preserved.</p>
</dd></dl>

<dl class="chpl method">
<dt id="DistributedBag.DistributedBagImpl.remove">
<em class="property">override proc </em><code class="sig-name descname">remove</code><span class="sig-paren">(</span><span class="sig-paren">)</span>: (bool, eltType)<a class="headerlink" href="#DistributedBag.DistributedBagImpl.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove an element from this node’s bag. The order in which elements are removed
are not guaranteed to be the same order it has been inserted. If this node’s
bag is empty, it will attempt to steal elements from bags of other nodes.</p>
</dd></dl>

<dl class="chpl method">
<dt id="DistributedBag.DistributedBagImpl.getSize">
<em class="property">override proc </em><code class="sig-name descname">getSize</code><span class="sig-paren">(</span><span class="sig-paren">)</span>: int<a class="headerlink" href="#DistributedBag.DistributedBagImpl.getSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain the number of elements held in all bags across all nodes. This method
is best-effort and can be non-deterministic for concurrent updates across nodes,
and may miss elements or even count duplicates resulting from any concurrent
insertion or removal operations.</p>
</dd></dl>

<dl class="chpl method">
<dt id="DistributedBag.DistributedBagImpl.contains">
<em class="property">override proc </em><code class="sig-name descname">contains</code><span class="sig-paren">(</span><em class="sig-param">elt: eltType</em><span class="sig-paren">)</span>: bool<a class="headerlink" href="#DistributedBag.DistributedBagImpl.contains" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a lookup to determine if the requested element exists in this bag.
This method is best-effort and can be non-deterministic for concurrent
updates across nodes, and may miss elements resulting from any concurrent
insertion or removal operations.</p>
</dd></dl>

<dl class="chpl method">
<dt id="DistributedBag.DistributedBagImpl.clear">
<em class="property">proc </em><code class="sig-name descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DistributedBag.DistributedBagImpl.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear all bags across all nodes in a best-effort approach. Elements added or
moved around from concurrent additions or removals may be missed while clearing.</p>
</dd></dl>

<dl class="chpl method">
<dt id="DistributedBag.DistributedBagImpl.balance">
<em class="property">proc </em><code class="sig-name descname">balance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#DistributedBag.DistributedBagImpl.balance" title="Permalink to this definition">¶</a></dt>
<dd><p>Triggers a more static approach to load balancing, fairly redistributing all
elements fairly for bags across nodes. The result will result in all segments
having roughly the same amount of elements.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is very heavy-weight in that it should not be called too
often. Dynamic work stealing handles cases where there is a relatively fair
distribution across majority of nodes, but this should be called when you have
a severe imbalance, or when you have a smaller number of elements to balance.
Furthermore, while this operation is parallel-safe, it should be called from at
most one task.</p>
</div>
</dd></dl>

<dl class="chpl itermethod">
<dt id="DistributedBag.DistributedBagImpl.these">
<em class="property">override iter </em><code class="sig-name descname">these</code><span class="sig-paren">(</span><span class="sig-paren">)</span>: eltType<a class="headerlink" href="#DistributedBag.DistributedBagImpl.these" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over each bag in each node. To avoid holding onto locks, we take
a snapshot approach, increasing memory consumption but also increasing parallelism.
This allows other concurrent, even mutating, operations while iterating,
but opens the possibility to iterating over duplicates or missing elements
from concurrent operations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>zip</cite> iteration is not yet supported with rectangular data structures.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Iteration takes a snapshot approach, and as such can easily result in a
Out-Of-Memory issue. If the data structure is large, the user is doubly advised to use
parallel iteration, for both performance and memory benefit.</p>
</div>
</dd></dl>

<dl class="chpl itermethod">
<dt>
<em class="property">iter </em><code class="sig-name descname">these</code><span class="sig-paren">(</span><em class="sig-param">param tag: iterKind</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="chpl itermethod">
<dt>
<em class="property">iter </em><code class="sig-name descname">these</code><span class="sig-paren">(</span><em class="sig-param">param tag: iterKind</em>, <em class="sig-param">followThis</em><span class="sig-paren">)</span></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="DistributedDeque.html" class="btn btn-neutral float-right" title="DistributedDeque" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Curl.html" class="btn btn-neutral float-left" title="Curl" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Hewlett Packard Enterprise Development LP

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 



</body>
</html>