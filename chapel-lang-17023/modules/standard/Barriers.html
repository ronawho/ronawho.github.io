

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Barriers &mdash; Chapel Documentation 1.24</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="DynamicIters" href="DynamicIters.html" />
    <link rel="prev" title="RandomSupport" href="Random/RandomSupport.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

<a href="../../index.html" class="icon icon-home"> Chapel Documentation

<!-- display version if button won't be rendered -->
<?php if (false) { ?>
<br>1.24
<?php } ?>

</a>

<?php
// Variables given by sphinx
$chplTitle = "1.24";
$pagename = "modules/standard/Barriers";
include "../..//versionButton.php";
?>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Compiling and Running Chapel</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../usingchapel/QUICKSTART.html">Quickstart Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usingchapel/index.html">Using Chapel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../platforms/index.html">Platform-Specific Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../technotes/index.html">Technical Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">Tools</a></li>
</ul>
<p class="caption"><span class="caption-text">Writing Chapel Programs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../language/reference.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Hello World Variants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../primers/index.html">Primers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../language/spec/index.html">Language Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../builtins/index.html">Built-in Types and Functions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../standard.html">Standard Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../standard.html#automatic-modules">Automatic Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../standard.html#data-structures">Data Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../standard.html#diagnostics">Diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../standard.html#files-io">Files/IO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../standard.html#language-support">Language Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../standard.html#math-numerical">Math/Numerical</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../standard.html#parallelism-distributed-computing">Parallelism/Distributed Computing</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Barriers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#future-direction">Future direction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="DynamicIters.html">DynamicIters</a></li>
<li class="toctree-l3"><a class="reference internal" href="VectorizingIterator.html">VectorizingIterator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../standard.html#system-interoperability">System/Interoperability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../standard.html#utilities">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../standard.html#deprecated-modules">Deprecated Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../standard.html#index">Index</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../packages.html">Package Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../layoutdist.html">Standard Layouts and Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mason-packages.html">Mason Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users-guide/index.html">Chapel Users Guide (WIP)</a></li>
</ul>
<p class="caption"><span class="caption-text">Language History</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../language/evolution.html">Chapel Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../language/archivedSpecs.html">Documentation Archives</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Chapel Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../standard.html">Standard Modules</a> &raquo;</li>
        
      <li>Barriers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/modules/standard/Barriers.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="module-Barriers"></span><div class="section" id="barriers">
<h1>Barriers<a class="headerlink" href="#barriers" title="Permalink to this headline">¶</a></h1>
<p><strong>Usage</strong></p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Barriers</span><span class="p">;</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nx">Barriers</span><span class="p">;</span>
</pre></div>
</div>
<p>Support for task barriers.</p>
<p>The Barrier type provided in this module can be used to prevent tasks
from proceeding until all other related tasks have also reached the
barrier.</p>
<p>In the following example, all of the tasks created by the coforall loop
will print their “entering the barrier” messages in an unspecified order,
then all of the tasks will print their “past the barrier” messages, also
in an unspecified order.  Because of the barrier, all of the
“entering the barrier” messages will be printed before any of the
“past the barrier” messages.</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Barriers</span><span class="p">;</span>

<span class="kd">config</span> <span class="kd">const</span> <span class="nx">numTasks</span> <span class="o">=</span> <span class="nx">here</span><span class="p">.</span><span class="nx">maxTaskPar</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Barrier</span><span class="p">(</span><span class="nx">numTasks</span><span class="p">);</span>

<span class="k">coforall</span> <span class="nx">tid</span> <span class="kd">in</span> <span class="mi">1</span><span class="o">..</span><span class="nx">numTasks</span> <span class="p">{</span>
  <span class="nx">writeln</span><span class="p">(</span><span class="s">&quot;Task &quot;</span><span class="p">,</span> <span class="nx">tid</span><span class="p">,</span> <span class="s">&quot; is entering the barrier&quot;</span><span class="p">);</span>
  <span class="nx">b</span><span class="p">.</span><span class="nx">barrier</span><span class="p">();</span>
  <span class="nx">writeln</span><span class="p">(</span><span class="s">&quot;Task &quot;</span><span class="p">,</span> <span class="nx">tid</span><span class="p">,</span> <span class="s">&quot; is past the barrier&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note: When a barrier instance goes out of scope it is automatically deleted.
After it is deleted, any copies of the barrier that remain are invalid.</p>
<div class="section" id="future-direction">
<h2>Future direction<a class="headerlink" href="#future-direction" title="Permalink to this headline">¶</a></h2>
<p>In the future, we expect to add more language-level support for a
“task-team” concept.  A task-team will more directly support collective
operations such as barriers between the tasks within a team.</p>
<p>The current implementation is designed for correctness, but is not expected
to perform well at scale.  We expect performance at scale to improve as
this barrier implementation is optimized and as the task-team concept is
implemented and optimized.</p>
<dl class="chpl enum">
<dt id="Barriers.BarrierType">
<em class="property">enum </em><code class="sig-name descname">BarrierType</code> { Atomic, Sync }<a class="headerlink" href="#Barriers.BarrierType" title="Permalink to this definition">¶</a></dt>
<dd><p>An enumeration of the different barrier implementations.  Used to choose
the implementation to use when constructing a new barrier object.</p>
<ul class="simple">
<li><p><cite>BarrierType.Atomic</cite> uses Chapel atomic variables to control the barrier.</p></li>
<li><p><cite>BarrierType.Sync</cite> uses Chapel sync variables to control the barrier.</p></li>
</ul>
</dd></dl>

<dl class="chpl record">
<dt id="Barriers.Barrier">
<em class="property">record </em><code class="sig-name descname">Barrier</code><a class="headerlink" href="#Barriers.Barrier" title="Permalink to this definition">¶</a></dt>
<dd><p>A barrier that will cause <cite>numTasks</cite> to wait before proceeding.</p>
<dl class="chpl method">
<dt id="Barriers.Barrier.init">
<em class="property">proc </em><code class="sig-name descname">init</code><span class="sig-paren">(</span><em class="sig-param">numTasks: int</em>, <em class="sig-param">barrierType: BarrierType = BarrierType.Atomic</em>, <em class="sig-param">reusable: bool = true</em><span class="sig-paren">)</span><a class="headerlink" href="#Barriers.Barrier.init" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a new barrier object.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>numTasks</strong> – The number of tasks that will use this barrier</p></li>
<li><p><strong>barrierType</strong> – The barrier implementation to use</p></li>
<li><p><strong>reusable</strong> – Incur some extra overhead to allow reuse of this barrier?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="chpl method">
<dt id="Barriers.Barrier.barrier">
<em class="property">proc </em><code class="sig-name descname">barrier</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Barriers.Barrier.barrier" title="Permalink to this definition">¶</a></dt>
<dd><p>Block until all related tasks have called this method.  If <cite>reusable</cite>
is true, reset the barrier to be used again.</p>
</dd></dl>

<dl class="chpl method">
<dt id="Barriers.Barrier.notify">
<em class="property">proc </em><code class="sig-name descname">notify</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Barriers.Barrier.notify" title="Permalink to this definition">¶</a></dt>
<dd><p>Notify the barrier that this task has reached this point.</p>
</dd></dl>

<dl class="chpl method">
<dt id="Barriers.Barrier.wait">
<em class="property">proc </em><code class="sig-name descname">wait</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Barriers.Barrier.wait" title="Permalink to this definition">¶</a></dt>
<dd><p>Wait until <cite>n</cite> tasks have called <a class="reference internal" href="#Barriers.Barrier.notify" title="Barriers.Barrier.notify"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">notify</span></code></a>.  If <cite>reusable</cite> is true,
reset the barrier to be used again.</p>
<p>Note: if <cite>reusable</cite> is true the tasks will wait until all <cite>n</cite> tasks
have called both <a class="reference internal" href="#Barriers.Barrier.notify" title="Barriers.Barrier.notify"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">notify</span></code></a> and <a class="reference internal" href="#Barriers.Barrier.wait" title="Barriers.Barrier.wait"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">wait</span></code></a> at which point the
barrier will automatically be reset for the next use.  If <cite>reusable</cite>
is false, each task calling <a class="reference internal" href="#Barriers.Barrier.wait" title="Barriers.Barrier.wait"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">wait</span></code></a> can return as soon as all
<cite>n</cite> tasks have called <a class="reference internal" href="#Barriers.Barrier.notify" title="Barriers.Barrier.notify"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">notify</span></code></a>.</p>
</dd></dl>

<dl class="chpl method">
<dt id="Barriers.Barrier.check">
<em class="property">proc </em><code class="sig-name descname">check</code><span class="sig-paren">(</span><span class="sig-paren">)</span>: bool<a class="headerlink" href="#Barriers.Barrier.check" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <cite>true</cite> if <cite>n</cite> tasks have called <a class="reference internal" href="#Barriers.Barrier.notify" title="Barriers.Barrier.notify"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">notify</span></code></a></p>
</dd></dl>

<dl class="chpl method">
<dt id="Barriers.Barrier.reset">
<em class="property">proc </em><code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param">nTasks: int</em><span class="sig-paren">)</span><a class="headerlink" href="#Barriers.Barrier.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the barrier, setting it to work with <cite>nTasks</cite> tasks.  If some
(but not all) tasks had already called <a class="reference internal" href="#Barriers.Barrier.barrier" title="Barriers.Barrier.barrier"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">barrier</span></code></a> or <a class="reference internal" href="#Barriers.Barrier.check" title="Barriers.Barrier.check"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">check</span></code></a>
when <a class="reference internal" href="#Barriers.Barrier.reset" title="Barriers.Barrier.reset"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">reset</span></code></a> is called, the behavior is undefined.</p>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="DynamicIters.html" class="btn btn-neutral float-right" title="DynamicIters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Random/RandomSupport.html" class="btn btn-neutral float-left" title="RandomSupport" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Hewlett Packard Enterprise Development LP

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 



</body>
</html>