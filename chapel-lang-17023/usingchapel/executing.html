

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Executing Chapel Programs &mdash; Chapel Documentation 1.24</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/style.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Multilocale Chapel Execution" href="multilocale.html" />
    <link rel="prev" title="chpl" href="man.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

<a href="../index.html" class="icon icon-home"> Chapel Documentation

<!-- display version if button won't be rendered -->
<?php if (false) { ?>
<br>1.24
<?php } ?>

</a>

<?php
// Variables given by sphinx
$chplTitle = "1.24";
$pagename = "usingchapel/executing";
include "..//versionButton.php";
?>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Compiling and Running Chapel</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="QUICKSTART.html">Quickstart Instructions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Using Chapel</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="prereqs.html">Chapel Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="chplenv.html">Setting up Your Environment for Chapel</a></li>
<li class="toctree-l2"><a class="reference internal" href="building.html">Building Chapel</a></li>
<li class="toctree-l2"><a class="reference internal" href="compiling.html">Compiling Chapel Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="man.html">Chapel Man Page</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Executing Chapel Programs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#getting-help">Getting Help</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-configuration-variables">Setting Configuration Variables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#command-line">Command Line</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-file">Configuration File</a></li>
<li class="toctree-l4"><a class="reference internal" href="#non-configuration-variable-arguments">Non-Configuration Variable Arguments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#setting-the-number-of-locales">Setting the Number of Locales</a></li>
<li class="toctree-l3"><a class="reference internal" href="#controlling-degree-of-data-parallelism">Controlling Degree of Data Parallelism</a></li>
<li class="toctree-l3"><a class="reference internal" href="#environment-variable-control-over-chapel-behavior">Environment Variable Control over Chapel Behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="#controlling-the-call-stack-size">Controlling the Call Stack Size</a></li>
<li class="toctree-l3"><a class="reference internal" href="#controlling-the-number-of-threads">Controlling the Number of Threads</a></li>
<li class="toctree-l3"><a class="reference internal" href="#controlling-the-amount-of-non-user-output">Controlling the Amount of Non-User Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="#oversubscription">Oversubscription</a></li>
<li class="toctree-l3"><a class="reference internal" href="#launcher-support">Launcher Support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="multilocale.html">Multilocale Chapel Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="launcher.html">Chapel Launchers</a></li>
<li class="toctree-l2"><a class="reference internal" href="tasks.html">Chapel Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html">Debugging Chapel Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="bugs.html">Reporting Chapel Issues</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../platforms/index.html">Platform-Specific Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../technotes/index.html">Technical Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Tools</a></li>
</ul>
<p class="caption"><span class="caption-text">Writing Chapel Programs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../language/reference.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Hello World Variants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../primers/index.html">Primers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language/spec/index.html">Language Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../builtins/index.html">Built-in Types and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/standard.html">Standard Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/packages.html">Package Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/layoutdist.html">Standard Layouts and Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mason-packages.html">Mason Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users-guide/index.html">Chapel Users Guide (WIP)</a></li>
</ul>
<p class="caption"><span class="caption-text">Language History</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../language/evolution.html">Chapel Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language/archivedSpecs.html">Documentation Archives</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Chapel Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Using Chapel</a> &raquo;</li>
        
      <li>Executing Chapel Programs</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/usingchapel/executing.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="executing-chapel-programs">
<span id="readme-executing"></span><h1><a class="toc-backref" href="#id1">Executing Chapel Programs</a><a class="headerlink" href="#executing-chapel-programs" title="Permalink to this headline">Â¶</a></h1>
<p>Once you have compiled a Chapel program using the chpl compiler, you
can execute it from the command-line like any other program.  This
document discusses command line options, environment variables, and
other topics having to do with running programs written in Chapel.</p>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#executing-chapel-programs" id="id1">Executing Chapel Programs</a></p>
<ul>
<li><p><a class="reference internal" href="#getting-help" id="id2">Getting Help</a></p></li>
<li><p><a class="reference internal" href="#setting-configuration-variables" id="id3">Setting Configuration Variables</a></p>
<ul>
<li><p><a class="reference internal" href="#command-line" id="id4">Command Line</a></p></li>
<li><p><a class="reference internal" href="#configuration-file" id="id5">Configuration File</a></p></li>
<li><p><a class="reference internal" href="#non-configuration-variable-arguments" id="id6">Non-Configuration Variable Arguments</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#setting-the-number-of-locales" id="id7">Setting the Number of Locales</a></p></li>
<li><p><a class="reference internal" href="#controlling-degree-of-data-parallelism" id="id8">Controlling Degree of Data Parallelism</a></p></li>
<li><p><a class="reference internal" href="#environment-variable-control-over-chapel-behavior" id="id9">Environment Variable Control over Chapel Behavior</a></p></li>
<li><p><a class="reference internal" href="#controlling-the-call-stack-size" id="id10">Controlling the Call Stack Size</a></p></li>
<li><p><a class="reference internal" href="#controlling-the-number-of-threads" id="id11">Controlling the Number of Threads</a></p></li>
<li><p><a class="reference internal" href="#controlling-the-amount-of-non-user-output" id="id12">Controlling the Amount of Non-User Output</a></p></li>
<li><p><a class="reference internal" href="#oversubscription" id="id13">Oversubscription</a></p></li>
<li><p><a class="reference internal" href="#launcher-support" id="id14">Launcher Support</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="getting-help">
<h2><a class="toc-backref" href="#id2">Getting Help</a><a class="headerlink" href="#getting-help" title="Permalink to this headline">Â¶</a></h2>
<p>Using the <code class="docutils literal notranslate"><span class="pre">-h</span></code> or <code class="docutils literal notranslate"><span class="pre">--help</span></code> flags will print out help for the
executable.  For example:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>./myprogram --help
</pre></div>
</div>
</div></blockquote>
<p>This flag lists all of the standard flags that can be used with a
Chapel program, as well as a list of the configuration variables
defined by the program and their types.  If the configuration variable
has been set on the command line, its value is also shown.</p>
</div>
<div class="section" id="setting-configuration-variables">
<h2><a class="toc-backref" href="#id3">Setting Configuration Variables</a><a class="headerlink" href="#setting-configuration-variables" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="command-line">
<h3><a class="toc-backref" href="#id4">Command Line</a><a class="headerlink" href="#command-line" title="Permalink to this headline">Â¶</a></h3>
<p><a class="reference internal" href="../users-guide/base/configs.html#ug-configs"><span class="std std-ref">Configuration constants and variables</span></a> defined in a Chapel
program can have their default values overridden on the command line using the
<code class="docutils literal notranslate"><span class="pre">-s</span></code> or <code class="docutils literal notranslate"><span class="pre">--</span></code> flags.  Either flag takes the name of the configuration
variable followed by an equals character (<code class="docutils literal notranslate"><span class="pre">=</span></code>) and the value to assign to it.
This value must be a legal Chapel literal for the type of the variable.
(Exception: for a string literal, the surrounding quotes are implicit.)
In our current implementation, no extra spaces may appear between
these elements.  Thus, the general form is:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>./myprogram --&lt;cfgVar&gt;<span class="o">=</span>&lt;val&gt;
</pre></div>
</div>
</div></blockquote>
<p>or:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>./myprogram -s&lt;cfgVar&gt;<span class="o">=</span>&lt;val&gt;
</pre></div>
</div>
</div></blockquote>
<p>As an example, compile the hello2-module.chpl example which prints a
user-definable message:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>chpl -o hello2-module <span class="nv">$CHPL_HOME</span>/examples/hello2-module.chpl
</pre></div>
</div>
</div></blockquote>
<p>This program defines a configuration constant, <code class="docutils literal notranslate"><span class="pre">message</span></code>, indicating
the string to print to the console, set to <code class="docutils literal notranslate"><span class="pre">&quot;Hello,</span> <span class="pre">world!&quot;</span></code> by
default.  To override the default, you can use:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>./hello2-module --message<span class="o">=</span><span class="s1">&#39;Hello, Chapel users!&#39;</span>
</pre></div>
</div>
</div></blockquote>
<p>or:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>./hello2-module -smessage<span class="o">=</span><span class="s1">&#39;Hello, Chapel users!&#39;</span>
</pre></div>
</div>
</div></blockquote>
<p>The default value of a configuration constant or variable can also be
overridden at compilation time with a <code class="docutils literal notranslate"><span class="pre">-s</span></code> option. (The surrounding
quotes must be provided for a string literal.) For example:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> <span class="nv">$CHPL_HOME</span>/examples
chpl -smessage<span class="o">=</span><span class="s1">&#39;&quot;Hello from the Chapel compiler&quot;&#39;</span> hello2-module.chpl
</pre></div>
</div>
</div></blockquote>
<p>or:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>chpl -s <span class="nv">message</span><span class="o">=</span><span class="s2">&quot;&#39;Hello from the Chapel compiler&#39;&quot;</span> hello2-module.chpl
</pre></div>
</div>
</div></blockquote>
<p>The compiler-established default can still be overridden when
executing the program, as shown above.</p>
<p>Command-line overrides of configs may also use fully qualified names.
Thus, each of the above examples could have referred to <code class="docutils literal notranslate"><span class="pre">message</span></code> as
<code class="docutils literal notranslate"><span class="pre">Hello.message</span></code> instead.  This is useful for disambiguating when
multiple modules declare configs with the same name.  In addition,
<code class="docutils literal notranslate"><span class="pre">private</span> <span class="pre">config</span></code> declarations <cite>must</cite> be set using fully-qualified
names.</p>
</div>
<div class="section" id="configuration-file">
<h3><a class="toc-backref" href="#id5">Configuration File</a><a class="headerlink" href="#configuration-file" title="Permalink to this headline">Â¶</a></h3>
<p>Configuration values can also be passed to a Chapel program through a
configuration file, specified by the execution time <code class="docutils literal notranslate"><span class="pre">-f</span></code> option.
Configuration files can contain a whitespace- or newline-delimited list of
keys and values separated by an assignment operator <code class="docutils literal notranslate"><span class="pre">=</span></code>. Comments begin
with the <code class="docutils literal notranslate"><span class="pre">#</span></code> character. The examples below demonstrate this format.</p>
<p>Consider the following program:</p>
<blockquote>
<div><div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="c1">// program.chpl</span>
<span class="kd">config</span> <span class="kd">const</span> <span class="nx">msg</span><span class="p">:</span> <span class="kt">string</span><span class="p">,</span>
             <span class="nx">val1</span><span class="p">:</span> <span class="kt">real</span><span class="p">,</span>
             <span class="nx">val2</span><span class="p">:</span> <span class="kt">real</span><span class="p">;</span>


<span class="k">proc</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">writeln</span><span class="p">(</span><span class="nx">msg</span><span class="p">);</span>
  <span class="nx">writeln</span><span class="p">(</span><span class="nx">val1</span><span class="p">);</span>
  <span class="nx">writeln</span><span class="p">(</span><span class="nx">val2</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>The above program can have its configuration variables defined by this
configuration file:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># program.input</span>

<span class="n">msg</span><span class="o">=</span><span class="s2">&quot;hello world&quot;</span>
<span class="n">val1</span><span class="o">=</span><span class="mf">1.61803</span>
<span class="n">val2</span><span class="o">=</span><span class="mf">3.14159</span>
</pre></div>
</div>
</div></blockquote>
<p>Configuration files can contain a whitespace- or newline-separated list of
configuration assignments and comments are supported with the <code class="docutils literal notranslate"><span class="pre">#</span></code> character.
The configuration file above can also be written like this:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># program.input</span>

<span class="n">val1</span><span class="o">=</span><span class="mf">1.61803</span> <span class="n">val2</span><span class="o">=</span><span class="mf">3.14159</span>
<span class="n">msg</span><span class="o">=</span><span class="s2">&quot;hello world&quot;</span> <span class="c1"># This is a comment</span>
</pre></div>
</div>
</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">program.input</span></code> is passed during execution with the <code class="docutils literal notranslate"><span class="pre">-f</span></code> flag:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># config variables are populated by program.input values</span>
./program -fprogram.input
</pre></div>
</div>
</div></blockquote>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Assignments cannot contain whitespaces outside of quotes, so the following
configuration file would result in an error:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># bad.input</span>

<span class="c1"># The additional whitespace will result in an error</span>
<span class="n">val1</span> <span class="o">=</span> <span class="mf">1.161803</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="non-configuration-variable-arguments">
<h3><a class="toc-backref" href="#id6">Non-Configuration Variable Arguments</a><a class="headerlink" href="#non-configuration-variable-arguments" title="Permalink to this headline">Â¶</a></h3>
<p>Chapel programs can also accept C-like command line arguments to their
<code class="docutils literal notranslate"><span class="pre">main()</span></code> procedure in addition to the aforementioned configuration
variables. See <a class="reference internal" href="../technotes/main.html#readme-main"><span class="std std-ref">main() Functions</span></a> for more
information.</p>
</div>
</div>
<div class="section" id="setting-the-number-of-locales">
<h2><a class="toc-backref" href="#id7">Setting the Number of Locales</a><a class="headerlink" href="#setting-the-number-of-locales" title="Permalink to this headline">Â¶</a></h2>
<p>For multi-locale Chapel executions, the number of locales on which to
execute a program is specified on the executableâs command-line.  This
can be set either using the <code class="docutils literal notranslate"><span class="pre">-nl</span></code> flag, or by assigning to the built-in
numLocales configuration constant using the normal mechanisms.  So, to
execute on four locales, one could use:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>./myprogram -nl <span class="m">4</span>
</pre></div>
</div>
</div></blockquote>
<p>or:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>./myprogram --numLocales<span class="o">=</span><span class="m">4</span>
</pre></div>
</div>
</div></blockquote>
<p>or:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>./myprogram -snumLocales<span class="o">=</span><span class="m">4</span>
</pre></div>
</div>
</div></blockquote>
<p>For users running with <code class="docutils literal notranslate"><span class="pre">CHPL_COMM=none</span></code> (the default), only one
locale can be used.  See <a class="reference internal" href="multilocale.html#readme-multilocale"><span class="std std-ref">Multilocale Chapel Execution</span></a> for more
information about executing on multiple locales.</p>
<p>Multi-locale programs often use a launcher executable to do some initial
command-line checking before spawning the real program, which is then
stored in a second binary named <code class="docutils literal notranslate"><span class="pre">&lt;original_binary_name&gt;_real</span></code>.  See
<a class="reference internal" href="launcher.html#readme-launcher"><span class="std std-ref">Chapel Launchers</span></a> for more information about the launcher executable.</p>
</div>
<div class="section" id="controlling-degree-of-data-parallelism">
<h2><a class="toc-backref" href="#id8">Controlling Degree of Data Parallelism</a><a class="headerlink" href="#controlling-degree-of-data-parallelism" title="Permalink to this headline">Â¶</a></h2>
<p>Data parallel operations over ranges, default domains, and default
arrays permit the number of tasks used to implement the data
parallelism to be specified using the following built-in configuration
constants:</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">dataParTasksPerLocale</span></code></dt><dd><p>Number of Chapel tasks to use to execute forall loops (default:
number of physical CPUs on the node, which may be reduced by
<code class="docutils literal notranslate"><span class="pre">CHPL_RT_NUM_THREADS_PER_LOCALE</span></code>.  When <code class="docutils literal notranslate"><span class="pre">CHPL_TASKS=qthreads</span></code>,
<code class="docutils literal notranslate"><span class="pre">CHPL_RT_NUM_THREADS_PER_LOCALE</span></code> can also increase this, up to the
number of logical CPUs).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dataParIgnoreRunningTasks</span></code></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">true</span></code>, always use <code class="docutils literal notranslate"><span class="pre">dataParTasksPerLocale</span></code> tasks to execute
forall loops.  If <code class="docutils literal notranslate"><span class="pre">false</span></code>, reduce the number of tasks used by the
number of tasks already running (default: <code class="docutils literal notranslate"><span class="pre">false</span></code>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dataParMinGranularity</span></code></dt><dd><p>The number of tasks used to execute forall loops should be reduced
such that the number of iterations per task is never less than the
specified value (default: <code class="docutils literal notranslate"><span class="pre">1</span></code>).</p>
</dd>
</dl>
</div></blockquote>
<p>Most Chapel standard distributions also use identically named
constructor arguments to control the degree of data parallelism within
each locale when iterating over its domains and arrays.  The default
values for these arguments are set to the corresponding global
configuration constants.</p>
</div>
<div class="section" id="environment-variable-control-over-chapel-behavior">
<h2><a class="toc-backref" href="#id9">Environment Variable Control over Chapel Behavior</a><a class="headerlink" href="#environment-variable-control-over-chapel-behavior" title="Permalink to this headline">Â¶</a></h2>
<p>Chapel uses environment variables to control the number of threads used
at execution time and the call stack size, among other things.  In many
cases third-party packages used by Chapel define their own environment
variables to provide the same or similar control.  When this is the
case, the Chapel environment variable has precedence over the
third-party package environment variable, which in turn has precedence
over the Chapel default.</p>
<p>As an example, with <code class="docutils literal notranslate"><span class="pre">CHPL_TASKS=qthreads</span></code>, Chapel and Qthreads both
have environment variables that can be used to set the task stack size.
In this case the Chapel <code class="docutils literal notranslate"><span class="pre">CHPL_RT_CALL_STACK_SIZE</span></code> environment variable
will override the Qthreads <code class="docutils literal notranslate"><span class="pre">QT_STACK_SIZE</span></code> environment variable if
both are set.  However, if only <code class="docutils literal notranslate"><span class="pre">QT_STACK_SIZE</span></code> is set it will
override the Chapel default call stack size.</p>
<p>The Chapel environment variables that control execution time behavior
are as follows:</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">CHPL_RT_CALL_STACK_SIZE</span></code></dt><dd><p>size of the call stack for a task</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">CHPL_RT_MAX_HEAP_SIZE</span></code></dt><dd><p>per-locale size of the heap used for dynamic allocation in
multilocale programs</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">CHPL_RT_NUM_THREADS_PER_LOCALE</span></code></dt><dd><p>number of threads used to execute tasks</p>
</dd>
</dl>
</div></blockquote>
<p>There is a bit more information on <code class="docutils literal notranslate"><span class="pre">CHPL_RT_CALL_STACK_SIZE</span></code> and
<code class="docutils literal notranslate"><span class="pre">CHPL_RT_NUM_THREADS_PER_LOCALE</span></code> below, and more detailed discussion
of all of these in <a class="reference internal" href="tasks.html#readme-tasks"><span class="std std-ref">Chapel Tasks</span></a> and <a class="reference internal" href="../platforms/cray.html#readme-cray"><span class="std std-ref">Using Chapel on Cray Systems</span></a>.</p>
</div>
<div class="section" id="controlling-the-call-stack-size">
<h2><a class="toc-backref" href="#id10">Controlling the Call Stack Size</a><a class="headerlink" href="#controlling-the-call-stack-size" title="Permalink to this headline">Â¶</a></h2>
<p>The main Chapel program requires space for its call stack, as does any
task created by it.  This stack space has a fixed size.  It is created
automatically when the program or task starts executing, and remains in
existence until it completes.  The default call stack size is ~8 MiB on
Linux-based systems, since this is a common value for the process stack
limit on such systems.  On Cygwin systems the default call stack size is
~2 MiB. Note that up to 4 system pages of each stack may be reserved for
use by the tasking layer. Up to 2 pages for runtime data structures and
up to 2 additional pages if guard pages (âstack-checks) are enabled.</p>
<p>The default call stack size may not be appropriate in all cases.  For
programs in which some tasks have large stack frames or deep call trees
it may be too small, leading to stack overflow.  For programs which use
tasks only for data parallelism it may be unnecessarily large.  Stacks
that are unnecessarily large are typically only a problem for programs
in which many tasks (thus their stacks) exist at once, when using a comm
layer that has to pre-register memory.  For the particular case of using
the native runtime communication and tasking layers on Cray X* systems,
further discussion about this can be found in <a class="reference internal" href="../platforms/cray.html#readme-cray"><span class="std std-ref">Using Chapel on Cray Systems</span></a>.</p>
<p>The following environment variable can be used to change the task call
stack size.</p>
<blockquote>
<div><dl>
<dt><code class="docutils literal notranslate"><span class="pre">CHPL_RT_CALL_STACK_SIZE</span></code></dt><dd><p>Size of the call stack for a task.  A plain numeric value indicates
bytes.  A suffix can be appended to indicate larger units:</p>
<blockquote>
<div><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">k</span></code>, <code class="docutils literal notranslate"><span class="pre">K</span></code>: KiB (2**10 bytes)</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">m</span></code>, <code class="docutils literal notranslate"><span class="pre">M</span></code>: MiB (2**20 bytes)</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">G</span></code>: GiB (2**30 bytes)</div>
</div>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="controlling-the-number-of-threads">
<h2><a class="toc-backref" href="#id11">Controlling the Number of Threads</a><a class="headerlink" href="#controlling-the-number-of-threads" title="Permalink to this headline">Â¶</a></h2>
<p>The following environment variable can be used to change the number of
system threads used by a program.</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">CHPL_RT_NUM_THREADS_PER_LOCALE</span></code></dt><dd><p>Controls the number of threads used on each locale when running the
program.</p>
</dd>
</dl>
</div></blockquote>
<p>See <a class="reference internal" href="tasks.html#readme-tasks"><span class="std std-ref">Chapel Tasks</span></a> for more information on the role of
this variable in creating threads and executing tasks for the various
tasking layers.</p>
</div>
<div class="section" id="controlling-the-amount-of-non-user-output">
<h2><a class="toc-backref" href="#id12">Controlling the Amount of Non-User Output</a><a class="headerlink" href="#controlling-the-amount-of-non-user-output" title="Permalink to this headline">Â¶</a></h2>
<p>The compiler-generated executable supports <em>verbose</em> and <em>quiet</em> modes
that control the amount of Chapel-generated information printed by the
executable.</p>
<blockquote>
<div><dl class="option-list">
<dt><kbd><span class="option">-v</span>, <span class="option">--verbose</span></kbd></dt>
<dd><p>Print more information. For example, print the
launcher commands used to start the program (if any)
and print a message from each locale when the program
starts executing there.</p>
</dd>
<dt><kbd><span class="option">-q</span>, <span class="option">--quiet</span></kbd></dt>
<dd><p>Print less information. For example, suppress run-time
warnings that are printed by default.</p>
</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="oversubscription">
<span id="oversubscribed-execution"></span><h2><a class="toc-backref" href="#id13">Oversubscription</a><a class="headerlink" href="#oversubscription" title="Permalink to this headline">Â¶</a></h2>
<p>In multi-locale Chapel executions programs can run âoversubscribedâ,
with more than one Chapel locale per system compute node.  Both the
<code class="docutils literal notranslate"><span class="pre">gasnet</span></code> and <code class="docutils literal notranslate"><span class="pre">ofi</span></code> communication layers support this.  However,
oversubscription can cause serious performance degradation due to
resource contention, when multiple Chapel locales (program instances)
all proceed as if the resources of the entire compute node are theirs
to use.  As a result, on a single system node, a program will almost
always run faster with just a single locale than it will with multiple
locales.  Nevertheless, sometimes oversubscription is useful, such as
for testing multilocale Chapel functionality when multiple system
nodes are not actually available.</p>
<p>As a partial workaround for the resource contention problem, setting
the following environment variable often improves performance when
running oversubscribed:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">CHPL_RT_OVERSUBSCRIBED</span><span class="o">=</span>yes
</pre></div>
</div>
</div></blockquote>
<p>This causes various software components, from launchers to the
runtime, to be more considerate in how they use node resources.</p>
</div>
<div class="section" id="launcher-support">
<h2><a class="toc-backref" href="#id14">Launcher Support</a><a class="headerlink" href="#launcher-support" title="Permalink to this headline">Â¶</a></h2>
<p>For multilocale execution (see <a class="reference internal" href="multilocale.html#readme-multilocale"><span class="std std-ref">Multilocale Chapel Execution</span></a>),
Chapel programs are executed indirectly by a launcher.  This section
covers command line options that assist launchers in doing their job.
These options are not supported for general use.  We document them here
so that their presence in, say, the verbose output produced by <code class="docutils literal notranslate"><span class="pre">-v</span></code>
can be understood.</p>
<p>At present there is only one launcher support option:</p>
<blockquote>
<div><dl class="option-list">
<dt><kbd><span class="option">-E <var>&lt;envVar=val&gt;</var></span></kbd></dt>
<dd><p>set the given environment variable <em>envVar</em> to <em>val</em>.</p>
</dd>
</dl>
</div></blockquote>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="multilocale.html" class="btn btn-neutral float-right" title="Multilocale Chapel Execution" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="man.html" class="btn btn-neutral float-left" title="chpl" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Hewlett Packard Enterprise Development LP

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 



</body>
</html>