

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Partial Instantiations &mdash; Chapel Documentation 1.24</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/style.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Domain Map Standard Interface" href="dsi.html" />
    <link rel="prev" title="Invoking Initializers with a Generic Instantiation" href="initTypeAlias.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

<a href="../index.html" class="icon icon-home"> Chapel Documentation

<!-- display version if button won't be rendered -->
<?php if (false) { ?>
<br>1.24
<?php } ?>

</a>

<?php
// Variables given by sphinx
$chplTitle = "1.24";
$pagename = "technotes/partialInstantiations";
include "..//versionButton.php";
?>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Compiling and Running Chapel</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../usingchapel/QUICKSTART.html">Quickstart Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usingchapel/index.html">Using Chapel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../platforms/index.html">Platform-Specific Notes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Technical Notes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#base-language-features">Base Language Features</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#initializers-and-generic-programming">Initializers and Generic Programming</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="forwarding.html">Forwarding Methods Calls</a></li>
<li class="toctree-l3"><a class="reference internal" href="initequals.html">The ‘init=’ Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="initTypeAlias.html">Invoking Initializers with a Generic Instantiation</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Partial Instantiations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-partial-instantiations">Creating Partial Instantiations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#detecting-partial-instantiations">Detecting Partial Instantiations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#passing-and-returning-generic-types">Passing and Returning Generic Types</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#parallel-language-features">Parallel Language Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#interoperability">Interoperability</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#compiler-features">Compiler Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#tool-details">Tool Details</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Tools</a></li>
</ul>
<p class="caption"><span class="caption-text">Writing Chapel Programs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../language/reference.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Hello World Variants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../primers/index.html">Primers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language/spec/index.html">Language Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../builtins/index.html">Built-in Types and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/standard.html">Standard Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/packages.html">Package Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/layoutdist.html">Standard Layouts and Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mason-packages.html">Mason Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users-guide/index.html">Chapel Users Guide (WIP)</a></li>
</ul>
<p class="caption"><span class="caption-text">Language History</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../language/evolution.html">Chapel Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language/archivedSpecs.html">Documentation Archives</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Chapel Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Technical Notes</a> &raquo;</li>
        
      <li>Partial Instantiations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/technotes/partialInstantiations.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="partial-instantiations">
<span id="readme-partial-instantiations"></span><h1>Partial Instantiations<a class="headerlink" href="#partial-instantiations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>A generic class or record can be fully instantiated, fully generic, or
partially instantiated. A fully instantiated type expression has concrete types
for all generic fields. A fully generic type expression is one in which none of
the generic fields have been instantiated. A partially instantiated type
expression has concrete types for one or more, but not all, generic fields.
Partial instantiations can be used to more finely constrain a procedure’s
arguments, constrain valid types when initializing variables, or for
conveniently creating other instantiations through incremental instantiation.</p>
</div>
<div class="section" id="creating-partial-instantiations">
<h2>Creating Partial Instantiations<a class="headerlink" href="#creating-partial-instantiations" title="Permalink to this headline">¶</a></h2>
<p>A generic type is instantiated by a call to the type constructor, which accepts
an argument for each generic field in the type in field declaration order.
These arguments can be passed positionally or by using named expressions and
the names of fields. In order to support partial instantiations of generic
types the language allows for arguments to be omitted from the type constructor
call. The resulting instantiation will have its own type constructor that
accepts arguments for the remaining generic fields. For example:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">record</span> <span class="nc">R</span> <span class="p">{</span>
  <span class="kd">type</span> <span class="nx">X</span><span class="p">;</span>
  <span class="kd">type</span> <span class="nx">Y</span><span class="p">;</span>
  <span class="kd">param</span> <span class="nx">p</span> <span class="p">:</span> <span class="kt">int</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">A</span> <span class="o">=</span> <span class="nx">R</span><span class="p">;</span> <span class="c1">// &#39;A&#39; is simply an alias for the generic type &#39;R&#39;</span>

<span class="c1">// B&#39;s type constructor accepts two arguments for fields &#39;Y&#39; and &#39;p&#39;</span>
<span class="kd">type</span> <span class="nx">B</span> <span class="o">=</span> <span class="nx">R</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span> <span class="c1">// instantiate field &#39;X&#39;</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">B</span><span class="p">:</span><span class="kt">string</span><span class="p">);</span> <span class="c1">// &quot;R(int(64))&quot;</span>

<span class="c1">// C&#39;s type constructor accepts one argument for field &#39;Y&#39;</span>
<span class="kd">type</span> <span class="nx">C</span> <span class="o">=</span> <span class="nx">B</span><span class="p">(</span><span class="nx">p</span><span class="o">=</span><span class="mi">5</span><span class="p">);</span> <span class="c1">// instantiate field &#39;p&#39;</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">C</span><span class="p">:</span><span class="kt">string</span><span class="p">);</span> <span class="c1">// &quot;R(int(64),p=5)&quot;</span>

<span class="c1">// D is a fully instantiated type and has no type constructor</span>
<span class="kd">type</span> <span class="nx">D</span> <span class="o">=</span> <span class="nx">C</span><span class="p">(</span><span class="kt">real</span><span class="p">);</span> <span class="c1">// instantiate field &#39;Y&#39;</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">D</span><span class="p">:</span><span class="kt">string</span><span class="p">);</span> <span class="c1">// &quot;R(int(64),real(64),p=5)&quot;</span>
</pre></div>
</div>
<p>A generic field might depend on a previously declared field to describe its
type. In such cases the later generic field may not be instantiated before
the earlier generic field:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="c1">// dependent.chpl</span>
<span class="k">record</span> <span class="nc">R</span> <span class="p">{</span>
  <span class="kd">type</span> <span class="nx">T</span><span class="p">;</span>
  <span class="kd">param</span> <span class="nx">p</span> <span class="p">:</span> <span class="nx">T</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">A</span> <span class="o">=</span> <span class="nx">R</span><span class="p">(</span><span class="nx">p</span><span class="o">=</span><span class="mi">5</span><span class="p">);</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>dependent.chpl:7: error: Unable to resolve partial instantiation &#39;R(p=5)&#39;
dependent.chpl:7: note: Instantiation of field &#39;p&#39; depends on uninstantiated fields: &#39;type T&#39;
</pre></div>
</div>
<p>Generic fields may have default values that are used to instantiate the field
when the user does not explicitly provide an argument in the type constructor.
In order to allow these fields to remain generic the user can pass <code class="docutils literal notranslate"><span class="pre">?</span></code> as an
argument to the type constructor. This argument indicates that generic fields
with default values should not be automatically instantiated.</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">record</span> <span class="nc">MyRange</span> <span class="p">{</span>
  <span class="kd">type</span> <span class="nx">idxType</span> <span class="o">=</span> <span class="kt">int</span><span class="p">;</span>
  <span class="kd">param</span> <span class="nx">stridable</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// all arguments must be of type ``MyRange(int,false)``</span>
<span class="k">proc</span> <span class="nf">foo</span><span class="p">(</span><span class="nx">arg</span> <span class="p">:</span> <span class="nx">MyRange</span><span class="p">)</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>

<span class="c1">// Any instantiation of ``MyRange`` is accepted</span>
<span class="k">proc</span> <span class="nf">bar</span><span class="p">(</span><span class="nx">arg</span> <span class="p">:</span> <span class="nx">MyRange</span><span class="p">(?))</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>

<span class="c1">// Any ``MyRange`` accepted provided the first field is ``uint``</span>
<span class="k">proc</span> <span class="nf">baz</span><span class="p">(</span><span class="nx">arg</span> <span class="p">:</span> <span class="nx">MyRange</span><span class="p">(</span><span class="kt">uint</span><span class="p">,</span> <span class="p">?))</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>
</pre></div>
</div>
<p>There are some restrictions that accompany the <code class="docutils literal notranslate"><span class="pre">?</span></code> argument. First is that
<code class="docutils literal notranslate"><span class="pre">?</span></code> may only appear once in a type constructor call. A user might be
tempted to use <code class="docutils literal notranslate"><span class="pre">?</span></code> as a positional argument in order to more easily pass
an argument to a specific field, e.g. <code class="docutils literal notranslate"><span class="pre">R(?,</span> <span class="pre">?,</span> <span class="pre">int)</span></code>. In order to reduce
confusion and support <code class="docutils literal notranslate"><span class="pre">?</span></code> as a convenient catch-all argument, <code class="docutils literal notranslate"><span class="pre">?</span></code> may not
be used multiple times in a type constructor call. For example:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">record</span> <span class="nc">R</span> <span class="p">{</span>
  <span class="kd">type</span> <span class="nx">X</span> <span class="o">=</span> <span class="kt">int</span><span class="p">;</span>
  <span class="kd">type</span> <span class="nx">Y</span> <span class="o">=</span> <span class="kt">real</span><span class="p">;</span>
  <span class="kd">type</span> <span class="nx">Z</span> <span class="o">=</span> <span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Error! &#39;?&#39; may not be used multiple times in a type constructor call</span>
<span class="c1">// proc foo(arg : R(?, ?, uint)) { ... }</span>
<span class="c1">// instead, use named-expressions:</span>
<span class="k">proc</span> <span class="nf">foo</span><span class="p">(</span><span class="nx">arg</span> <span class="p">:</span> <span class="nx">R</span><span class="p">(?,</span> <span class="nx">Z</span><span class="o">=</span><span class="kt">uint</span><span class="p">))</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>

<span class="c1">// alternatively, use the named-expression first:</span>
<span class="k">proc</span> <span class="nf">bar</span><span class="p">(</span><span class="nx">arg</span> <span class="p">:</span> <span class="nx">R</span><span class="p">(</span><span class="nx">Z</span><span class="o">=</span><span class="kt">uint</span><span class="p">,</span> <span class="p">?))</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>
</pre></div>
</div>
<p>Furthermore, once <code class="docutils literal notranslate"><span class="pre">?</span></code> appears in a type constructor call all later arguments
in the same call must used named expressions. This restriction emphasizes that
<code class="docutils literal notranslate"><span class="pre">?</span></code> may not be used as a positional argument. For example:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">record</span> <span class="nc">R</span> <span class="p">{</span>
  <span class="kd">type</span> <span class="nx">A</span> <span class="o">=</span> <span class="kt">int</span><span class="p">;</span>
  <span class="kd">type</span> <span class="nx">B</span> <span class="o">=</span> <span class="kt">real</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Error! second argument must use a named expression</span>
<span class="c1">// proc foo(arg : R(?, string)) { ... }</span>
<span class="c1">// instead...</span>
<span class="k">proc</span> <span class="nf">foo</span><span class="p">(</span><span class="nx">arg</span> <span class="p">:</span> <span class="nx">R</span><span class="p">(?,</span> <span class="nx">B</span><span class="o">=</span><span class="kt">string</span><span class="p">))</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="detecting-partial-instantiations">
<h2>Detecting Partial Instantiations<a class="headerlink" href="#detecting-partial-instantiations" title="Permalink to this headline">¶</a></h2>
<p>There are a few features that allow for the detection of partial
instantiations.</p>
<p>The first feature is a standard library function named <a class="reference internal" href="../modules/standard/Types.html#Types.isGeneric" title="Types.isGeneric"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">isGeneric</span></code></a>
that will simply return <code class="docutils literal notranslate"><span class="pre">true</span></code> if its argument is a partial instantiation or
a fully-generic type:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">record</span> <span class="nc">R</span> <span class="p">{</span>
  <span class="kd">type</span> <span class="nx">T</span><span class="p">;</span>
  <span class="kd">param</span> <span class="nx">p</span> <span class="p">:</span> <span class="kt">int</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">writeln</span><span class="p">(</span><span class="nx">isGeneric</span><span class="p">(</span><span class="nx">R</span><span class="p">));</span>            <span class="c1">// true</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">isGeneric</span><span class="p">(</span><span class="nx">R</span><span class="p">(</span><span class="kt">int</span><span class="p">)));</span>       <span class="c1">// true</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">isGeneric</span><span class="p">(</span><span class="nx">R</span><span class="p">(</span><span class="nx">p</span><span class="o">=</span><span class="mi">42</span><span class="p">)));</span>      <span class="c1">// true</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">isGeneric</span><span class="p">(</span><span class="nx">R</span><span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="mi">5</span><span class="p">)));</span> <span class="c1">// false</span>
</pre></div>
</div>
<p>Users may also query individual fields to determine whether the field has
been instantiated by comparing the field against <code class="docutils literal notranslate"><span class="pre">?</span></code>:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">record</span> <span class="nc">R</span> <span class="p">{</span>
  <span class="kd">type</span> <span class="nx">T</span><span class="p">;</span>
  <span class="kd">param</span> <span class="nx">p</span> <span class="p">:</span> <span class="kt">int</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">A</span> <span class="o">=</span> <span class="nx">R</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span>

<span class="c1">// &#39;?&#39; can be used to compare against either type or param fields</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">T</span> <span class="o">==</span> <span class="p">?);</span> <span class="c1">// false</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">p</span> <span class="o">==</span> <span class="p">?);</span> <span class="c1">// true</span>
</pre></div>
</div>
<p>Finally, a Reflection function named <a class="reference internal" href="../modules/standard/Reflection.html#Reflection.isFieldBound" title="Reflection.isFieldBound"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">isFieldBound</span></code></a> will
return true if the given name of the field in the provided type has been
instantiated:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Reflection</span><span class="p">;</span>

<span class="k">record</span> <span class="nc">R</span> <span class="p">{</span>
  <span class="kd">type</span> <span class="nx">T</span><span class="p">;</span>
  <span class="kd">type</span> <span class="nx">U</span><span class="p">;</span>
  <span class="kd">param</span> <span class="nx">p</span> <span class="p">:</span> <span class="kt">int</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">proc</span> <span class="nf">printInstantiated</span><span class="p">(</span><span class="kd">type</span> <span class="nx">T</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">writeln</span><span class="p">(</span><span class="s">&quot;type = &quot;</span><span class="p">,</span> <span class="nx">T</span><span class="p">:</span><span class="kt">string</span><span class="p">);</span>
  <span class="k">for</span> <span class="kd">param</span> <span class="nx">i</span> <span class="kd">in</span> <span class="mi">1</span><span class="o">..</span><span class="nx">numFields</span><span class="p">(</span><span class="nx">T</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">param</span> <span class="nx">name</span> <span class="p">:</span> <span class="kt">string</span> <span class="o">=</span> <span class="nx">getFieldName</span><span class="p">(</span><span class="nx">T</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>
    <span class="nx">writeln</span><span class="p">(</span><span class="s">&quot;  field &quot;</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="s">&quot; = &quot;</span><span class="p">,</span> <span class="nx">isFieldBound</span><span class="p">(</span><span class="nx">T</span><span class="p">,</span> <span class="nx">name</span><span class="p">));</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">printInstantiated</span><span class="p">(</span><span class="nx">R</span><span class="p">);</span>
<span class="nx">printInstantiated</span><span class="p">(</span><span class="nx">R</span><span class="p">(</span><span class="nx">U</span><span class="o">=</span><span class="kt">real</span><span class="p">));</span>
</pre></div>
</div>
<p>This program outputs:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>type = R
  field T = false
  field U = false
  field p = false
type = R(U=real(64))
  field T = false
  field U = true
  field p = false
</pre></div>
</div>
</div>
<div class="section" id="passing-and-returning-generic-types">
<h2>Passing and Returning Generic Types<a class="headerlink" href="#passing-and-returning-generic-types" title="Permalink to this headline">¶</a></h2>
<p>As of the 1.20 release generic type expressions may be passed to and returned
from functions. This change supports not only partial instantiations, but also
generic management of class types.</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">C</span> <span class="p">{</span>
  <span class="kd">type</span> <span class="nx">T</span><span class="p">;</span>
  <span class="kd">param</span> <span class="nx">p</span> <span class="p">:</span> <span class="kt">int</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">proc</span> <span class="nf">defaultC</span><span class="p">()</span> <span class="kd">type</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">C</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="mi">5</span><span class="p">)?;</span>
<span class="p">}</span>

<span class="k">proc</span> <span class="nf">intC</span> <span class="kd">type</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">C</span><span class="p">(</span><span class="kt">int</span><span class="p">)?;</span>
<span class="p">}</span>

<span class="c1">// Declare two variables with the same instantiation of &#39;C&#39; but with different management</span>
<span class="kd">var</span> <span class="nx">x</span> <span class="p">:</span> <span class="k">unmanaged</span> <span class="nx">defaultC</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">y</span> <span class="p">:</span> <span class="k">owned</span> <span class="nx">defaultC</span><span class="p">();</span>

<span class="c1">// Declare two variables with different instantiations of &#39;C&#39;, based on a</span>
<span class="c1">// common instantiation returned by &#39;intC&#39;, and with different management</span>
<span class="kd">var</span> <span class="nx">a</span> <span class="p">:</span> <span class="k">owned</span> <span class="nx">intC</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">b</span> <span class="p">:</span> <span class="k">shared</span> <span class="nx">intC</span><span class="p">(</span><span class="mi">123</span><span class="p">);</span>

<span class="c1">// An factory function that accepts any kind of type and creates a new</span>
<span class="c1">// instance with param &#39;p&#39;</span>
<span class="k">proc</span> <span class="nf">make</span><span class="p">(</span><span class="kd">type</span> <span class="nx">T</span><span class="p">,</span> <span class="kd">param</span> <span class="nx">p</span> <span class="p">:</span> <span class="kt">int</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nx">T</span><span class="p">(</span><span class="nx">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// For these calls, &#39;T&#39; will be a partial instantiation</span>
<span class="kd">var</span> <span class="nx">q</span> <span class="o">=</span> <span class="nx">make</span><span class="p">(</span><span class="nx">C</span><span class="p">(</span><span class="kt">int</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="nx">make</span><span class="p">(</span><span class="nx">C</span><span class="p">(</span><span class="kt">real</span><span class="p">),</span> <span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dsi.html" class="btn btn-neutral float-right" title="Domain Map Standard Interface" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="initTypeAlias.html" class="btn btn-neutral float-left" title="Invoking Initializers with a Generic Instantiation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Hewlett Packard Enterprise Development LP

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 



</body>
</html>