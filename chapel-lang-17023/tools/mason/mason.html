

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Mason &mdash; Chapel Documentation 1.24</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Protocol Buffers Support in Chapel" href="../protoc-gen-chpl/protoc-gen-chpl.html" />
    <link rel="prev" title="chplvis" href="../chplvis/chplvis.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

<a href="../../index.html" class="icon icon-home"> Chapel Documentation

<!-- display version if button won't be rendered -->
<?php if (false) { ?>
<br>1.24
<?php } ?>

</a>

<?php
// Variables given by sphinx
$chplTitle = "1.24";
$pagename = "tools/mason/mason";
include "../..//versionButton.php";
?>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Compiling and Running Chapel</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../usingchapel/QUICKSTART.html">Quickstart Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usingchapel/index.html">Using Chapel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../platforms/index.html">Platform-Specific Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../technotes/index.html">Technical Notes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Tools</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../c2chapel/c2chapel.html">c2chapel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chpldoc/chpldoc.html">chpldoc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chplvis/chplvis.html">chplvis</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Mason</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installation-instructions">Installation Instructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#basic-usage">Basic Usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#starting-a-new-package">Starting a New Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="#building-and-running">Building and Running</a></li>
<li class="toctree-l4"><a class="reference internal" href="#building-larger-packages">Building Larger Packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="#runtime-compilation-arguments">Runtime/Compilation Arguments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#testing-your-package">Testing your Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-and-running-examples">Creating and Running Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#documenting-a-package">Documenting a Package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#using-chapel-dependencies">Using Chapel Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-non-chapel-dependencies">Using Non-Chapel Dependencies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#using-system-dependencies">Using System Dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-spack-dependencies">Using Spack Dependencies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mason-registry">Mason-Registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="#submit-a-package">Submit a Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="#local-registries">Local Registries</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-manifest-file">The Manifest File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#environment-variables">Environment Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#toml">TOML</a></li>
<li class="toctree-l3"><a class="reference internal" href="#namespacing">Namespacing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#semantic-versioning">Semantic Versioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="#incompatible-version-resolution-strategy">Incompatible Version Resolution Strategy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-lock-file">The Lock File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dependency-code">Dependency Code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../protoc-gen-chpl/protoc-gen-chpl.html">Protocol Buffers Support in Chapel</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Writing Chapel Programs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../language/reference.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Hello World Variants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../primers/index.html">Primers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../language/spec/index.html">Language Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../builtins/index.html">Built-in Types and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/standard.html">Standard Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/packages.html">Package Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/layoutdist.html">Standard Layouts and Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mason-packages.html">Mason Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users-guide/index.html">Chapel Users Guide (WIP)</a></li>
</ul>
<p class="caption"><span class="caption-text">Language History</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../language/evolution.html">Chapel Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../language/archivedSpecs.html">Documentation Archives</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Chapel Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Tools</a> &raquo;</li>
        
      <li>Mason</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/tools/mason/mason.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="mason">
<span id="readme-mason"></span><h1><a class="toc-backref" href="#id3">Mason</a><a class="headerlink" href="#mason" title="Permalink to this headline">¶</a></h1>
<p>Mason is Chapel’s package manager</p>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#mason" id="id3">Mason</a></p>
<ul>
<li><p><a class="reference internal" href="#installation-instructions" id="id4">Installation Instructions</a></p></li>
<li><p><a class="reference internal" href="#basic-usage" id="id5">Basic Usage</a></p>
<ul>
<li><p><a class="reference internal" href="#starting-a-new-package" id="id6">Starting a New Package</a></p></li>
<li><p><a class="reference internal" href="#building-and-running" id="id7">Building and Running</a></p></li>
<li><p><a class="reference internal" href="#building-larger-packages" id="id8">Building Larger Packages</a></p></li>
<li><p><a class="reference internal" href="#runtime-compilation-arguments" id="id9">Runtime/Compilation Arguments</a></p></li>
<li><p><a class="reference internal" href="#testing-your-package" id="id10">Testing your Package</a></p></li>
<li><p><a class="reference internal" href="#creating-and-running-examples" id="id11">Creating and Running Examples</a></p></li>
<li><p><a class="reference internal" href="#documenting-a-package" id="id12">Documenting a Package</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#using-chapel-dependencies" id="id13">Using Chapel Dependencies</a></p></li>
<li><p><a class="reference internal" href="#using-non-chapel-dependencies" id="id14">Using Non-Chapel Dependencies</a></p>
<ul>
<li><p><a class="reference internal" href="#using-system-dependencies" id="id15">Using System Dependencies</a></p></li>
<li><p><a class="reference internal" href="#using-spack-dependencies" id="id16">Using Spack Dependencies</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#mason-registry" id="id17">Mason-Registry</a></p></li>
<li><p><a class="reference internal" href="#submit-a-package" id="id18">Submit a Package</a></p></li>
<li><p><a class="reference internal" href="#local-registries" id="id19">Local Registries</a></p></li>
<li><p><a class="reference internal" href="#the-manifest-file" id="id20">The Manifest File</a></p></li>
<li><p><a class="reference internal" href="#environment-variables" id="id21">Environment Variables</a></p></li>
<li><p><a class="reference internal" href="#toml" id="id22">TOML</a></p></li>
<li><p><a class="reference internal" href="#namespacing" id="id23">Namespacing</a></p></li>
<li><p><a class="reference internal" href="#semantic-versioning" id="id24">Semantic Versioning</a></p></li>
<li><p><a class="reference internal" href="#incompatible-version-resolution-strategy" id="id25">Incompatible Version Resolution Strategy</a></p></li>
<li><p><a class="reference internal" href="#the-lock-file" id="id26">The Lock File</a></p></li>
<li><p><a class="reference internal" href="#dependency-code" id="id27">Dependency Code</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="installation-instructions">
<h2><a class="toc-backref" href="#id4">Installation Instructions</a><a class="headerlink" href="#installation-instructions" title="Permalink to this headline">¶</a></h2>
<p>In <code class="docutils literal notranslate"><span class="pre">$CHPL_HOME</span></code> run the following:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>make mason
</pre></div>
</div>
<p>It builds the mason binary so that the command line interface can be used.
This installs mason in the same place as the chapel compiler (<code class="docutils literal notranslate"><span class="pre">chpl</span></code>) so that
mason can be used anywhere in the user’s file system.</p>
<p>To remove mason, change directory to <code class="docutils literal notranslate"><span class="pre">$CHPL_HOME/tools/mason</span></code> and run:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>make clean
</pre></div>
</div>
</div>
<div class="section" id="basic-usage">
<h2><a class="toc-backref" href="#id5">Basic Usage</a><a class="headerlink" href="#basic-usage" title="Permalink to this headline">¶</a></h2>
<div class="section" id="starting-a-new-package">
<h3><a class="toc-backref" href="#id6">Starting a New Package</a><a class="headerlink" href="#starting-a-new-package" title="Permalink to this headline">¶</a></h3>
<p>To initialize a new mason package, run <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">new</span></code>. The same can also be done using <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">init</span></code> as follows:</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>mkdir newPackage
<span class="nb">cd</span> newPackage
mason init
</pre></div>
</div>
</div></blockquote>
<p>This starts an interactive session which walks an user through the process of creating a project using Mason. This is highly recommended for new users.</p>
<p>A more advanced user may use the <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">new</span> <span class="pre">[</span> <span class="pre">options</span> <span class="pre">]</span> <span class="pre">&lt;project</span> <span class="pre">name&gt;</span></code> command, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mason</span> <span class="n">new</span> <span class="n">MyPackage</span>
</pre></div>
</div>
<p>This creates a git repository by default, unless <code class="docutils literal notranslate"><span class="pre">--no-vcs</span></code> is included.</p>
<p>Mason packages can also be initialized using the <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">init</span> <span class="pre">[options]</span> <span class="pre">[directory</span> <span class="pre">path]</span></code>.
To avoid the interactive session while initializing the project, run <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">init</span> <span class="pre">-d</span> <span class="pre">|</span> <span class="pre">--default</span></code>.</p>
<p>For example, for an existing directory named MyPackage,</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>mason init MyPackage

<span class="c1"># OR</span>

<span class="nb">cd</span> MyPackage
mason init -d
</pre></div>
</div>
</div></blockquote>
<p>The package will have the following hierarchy:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>MyPackage/
 │
 ├── Mason.toml
 ├── example/
 ├── src/
 │   └── MyPackage.chpl
 └── test/
</pre></div>
</div>
<p>The first file listed is the <code class="docutils literal notranslate"><span class="pre">Mason.toml</span></code>. This is the manifest file
for the package. All dependencies for the package are listed in this file
as well as additional metadata about the package.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">src/</span></code> folder is where the source code of the package should reside.
As you might expect, the <code class="docutils literal notranslate"><span class="pre">test/</span></code> folder and the <code class="docutils literal notranslate"><span class="pre">example</span></code> folder hold
tests and examples for your package, respectively. We will get to the
additional functionality that comes with these folders later.</p>
<p>Mason enforces that the main file be named after the package to enforce namespacing.
<code class="docutils literal notranslate"><span class="pre">MyPackage.chpl</span></code> will be the first file listed in <code class="docutils literal notranslate"><span class="pre">src/</span></code>.</p>
<p>You can create a package in a directory that differs from the mason
package name with the <cite>mason {new,init} –name</cite> flag.
This may be useful when creating a package in a directory that
is an illegal Mason package name, such as names with dashes. For example,</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>mason new illegal-module-name --name LegalModuleName

<span class="c1"># OR</span>

mkdir illegal-module-name
mason init illegal-module-name --name LegalModuleName
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="building-and-running">
<h3><a class="toc-backref" href="#id7">Building and Running</a><a class="headerlink" href="#building-and-running" title="Permalink to this headline">¶</a></h3>
<p>When invoked, <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">build</span> <span class="pre">[</span> <span class="pre">options</span> <span class="pre">]</span></code> will do the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>Run update to make sure any manual manifest edits are reflected in the dependency code.</p></li>
<li><p>Build <code class="docutils literal notranslate"><span class="pre">MyPackage.chpl</span></code> in the <code class="docutils literal notranslate"><span class="pre">src/</span></code> directory.</p></li>
<li><p>All packages are compiled into binaries and placed into <code class="docutils literal notranslate"><span class="pre">target/</span></code></p></li>
<li><p>All options not recognized by <code class="docutils literal notranslate"><span class="pre">mason</span></code> will be forwarded to the chapel compiler(<code class="docutils literal notranslate"><span class="pre">chpl</span></code>)</p></li>
</ul>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">run</span> <span class="pre">[</span> <span class="pre">options</span> <span class="pre">]</span></code> will, in turn:</p>
<blockquote>
<div><ul class="simple">
<li><p>Run the executable built above out of <code class="docutils literal notranslate"><span class="pre">target/</span></code>, if it exists.</p></li>
<li><p>All options not recognized by <code class="docutils literal notranslate"><span class="pre">mason</span></code> will be forwarded to the executable.</p></li>
</ul>
</div></blockquote>
<p>For example, after <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">run</span> <span class="pre">--build</span> <span class="pre">[</span> <span class="pre">options</span> <span class="pre">]</span></code>, the package directory appears as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>MyPackage/
 │
 ├── Mason.lock
 ├── Mason.toml
 ├── example/
 ├── src/
 │   └── myPackage.chpl
 ├── target/
 │   ├── debug/
 │   │   └── myPackage
 │   ├── example/
 │   └── test/
 └── test/
</pre></div>
</div>
<p>As you can see, new files have been added to the package, the first of which
is the <code class="docutils literal notranslate"><span class="pre">Mason.lock</span></code>. You can think of this file as a snapshot of a single
run of the program. This file “locks” in the settings in which the program
ran upon invocation of <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">run</span></code>. This file can be generated manually
with the <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">update</span></code> command. <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">update</span></code> will read the <code class="docutils literal notranslate"><span class="pre">Mason.toml</span></code>,
resolve dependencies, and generate the <code class="docutils literal notranslate"><span class="pre">Mason.lock</span></code> based on it’s contents.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">target/</span></code> directory is where Mason stores all the binaries related to your package.
These could be binaries for the main source code as well as examples and tests. There are two types of
targets for building. The default location of a package binary is <code class="docutils literal notranslate"><span class="pre">target/debug/</span></code>, as shown in the
example above. However, if a final version of an application or library is
being produced, the <code class="docutils literal notranslate"><span class="pre">--release</span></code> flag can be thrown as follows:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>mason run --build --release --force
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">--release</span></code> option adds the <code class="docutils literal notranslate"><span class="pre">--fast</span></code> argument to the compilation step.</p>
<p>The argument <code class="docutils literal notranslate"><span class="pre">--force</span></code> is included as Mason will only build the package if
the package has been modified. Throwing the <code class="docutils literal notranslate"><span class="pre">--release</span></code> flag will result in
the following package structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>MyPackage/
 │
 ├── Mason.lock
 ├── Mason.toml
 ├── example/
 ├── src/
 │   └── myPackage.chpl
 ├── target/
 │   ├── debug/
 │   │   └── myPackage
 │   ├── example/
 │   ├── release/
 │   │   └── myPackage
 │   └── test/
 └── test/
</pre></div>
</div>
<p>As you can see there are now two binaries of <code class="docutils literal notranslate"><span class="pre">MyPackage</span></code>, one under <code class="docutils literal notranslate"><span class="pre">debug/</span></code> and
one under <code class="docutils literal notranslate"><span class="pre">release</span></code>.  To remove the <code class="docutils literal notranslate"><span class="pre">target/</span></code> directory along with all of the binaries
for your package, use the <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">clean</span></code> command.</p>
</div>
<div class="section" id="building-larger-packages">
<h3><a class="toc-backref" href="#id8">Building Larger Packages</a><a class="headerlink" href="#building-larger-packages" title="Permalink to this headline">¶</a></h3>
<p>For packages that span multiple files, the main module is designated by the module that
shares the name with the package directory and the name field in the <code class="docutils literal notranslate"><span class="pre">Mason.toml</span></code>.</p>
<p>For packages that span multiple sub-directories within <code class="docutils literal notranslate"><span class="pre">src</span></code>, sub-directories must be passed
to Mason with the <code class="docutils literal notranslate"><span class="pre">-M</span>&#160; <span class="pre">&lt;src/subdirectory&gt;</span></code> flag which is forwarded to the chapel compiler. For example, lets say
MyPackage’s structure is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>MyPackage/
 │
 ├── Mason.lock
 ├── Mason.toml
 ├── example/
 ├── src/
 │   ├── myPackage.chpl
 │   └── util/
 │       └── myPackageUtils.chpl
 ├── target/
 │   ├── debug/
 │   │   └── myPackage
 │   ├── example/
 │   └── test/
 └── test/
</pre></div>
</div>
<p>If MyPackage needs multiple files in different directories like the example above,
then call <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">build</span></code> with the <code class="docutils literal notranslate"><span class="pre">-M</span></code> flag followed by the local dependencies.
A full command of this example would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mason</span> <span class="n">build</span> <span class="o">-</span><span class="n">M</span> <span class="n">src</span><span class="o">/</span><span class="n">util</span><span class="o">/</span><span class="n">MyPackageUtils</span><span class="o">.</span><span class="n">chpl</span>
</pre></div>
</div>
</div>
<div class="section" id="runtime-compilation-arguments">
<h3><a class="toc-backref" href="#id9">Runtime/Compilation Arguments</a><a class="headerlink" href="#runtime-compilation-arguments" title="Permalink to this headline">¶</a></h3>
<p>For an example of forwarding arguments in a call to <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">run</span></code>, a chapel program built in
mason might have a <code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">const</span> <span class="pre">number</span></code> that corresponds to a value used in <code class="docutils literal notranslate"><span class="pre">MyPackage.chpl</span></code>.
To try out different values at runtime, pass the values for <code class="docutils literal notranslate"><span class="pre">number</span></code> to <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">run</span></code> as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mason</span> <span class="n">run</span> <span class="o">--</span><span class="n">number</span><span class="o">=</span><span class="mi">100</span>
<span class="n">mason</span> <span class="n">run</span> <span class="o">--</span><span class="n">number</span><span class="o">=</span><span class="mi">1000</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the case when a flag intended for the <code class="docutils literal notranslate"><span class="pre">chpl</span></code> compiler or executable is recognized by
<code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">build</span></code> or <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">run</span></code>, respectively, the flag can be thrown after <code class="docutils literal notranslate"><span class="pre">--</span></code>
to override this conflict. For example, <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">run</span> <span class="pre">--</span> <span class="pre">-nl</span> <span class="pre">4</span></code>. Instead of mason recognizing
this argument, this command will run the executable over 4 locales.</p>
</div>
</div>
<div class="section" id="testing-your-package">
<h3><a class="toc-backref" href="#id10">Testing your Package</a><a class="headerlink" href="#testing-your-package" title="Permalink to this headline">¶</a></h3>
<p>Mason provides the functionality to test packages through the <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">test</span></code>
subcommand. There are two styles of writing mason tests:</p>
<ol class="arabic simple">
<li><p>Tests that utilize the <cite>UnitTest`</cite> module to determine pass/fail status</p></li>
<li><p>Tests that rely on the exit code to determine pass/fail status</p></li>
</ol>
<p>Here is an example of a <code class="docutils literal notranslate"><span class="pre">UnitTest</span></code>-based tests:</p>
<div class="highlight-chpl notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">UnitTest</span><span class="p">;</span>

<span class="kd">config</span> <span class="kd">const</span> <span class="nx">testParam</span><span class="p">:</span> <span class="kt">bool</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

<span class="k">proc</span> <span class="nf">myTest</span><span class="p">(</span><span class="nx">test</span><span class="p">:</span> <span class="k">borrowed</span> <span class="nx">Test</span><span class="p">)</span> <span class="k">throws</span><span class="p">{</span>
  <span class="nx">test</span><span class="p">.</span><span class="nx">assertTrue</span><span class="p">(</span><span class="nx">testParam</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">UnitTest</span><span class="p">.</span><span class="nx">main</span><span class="p">();</span>
</pre></div>
</div>
<p>Mason testing that uses <code class="docutils literal notranslate"><span class="pre">UnitTest</span></code> will treat each individual function as a
test, and the test will be considered successful if no assertions failed and no
halts were reached within the function body.</p>
<p>See the <a class="reference internal" href="../../modules/packages/UnitTest.html#module-UnitTest" title="UnitTest: The UnitTest module provides support for automated testing in Chapel."><code class="xref chpl chpl-mod docutils literal notranslate"><span class="pre">UnitTest</span></code></a> documentation to learn more about writing unit tests in
Chapel.</p>
<p>Here is an example of an exit-code-based tests:</p>
<div class="highlight-chpl notranslate"><div class="highlight"><pre><span></span><span class="kd">config</span> <span class="kd">const</span> <span class="nx">testParam</span><span class="p">:</span> <span class="kt">bool</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

<span class="k">if</span> <span class="nx">testParam</span> <span class="p">{</span>
  <span class="nx">writeln</span><span class="p">(</span><span class="s">&quot;Test Passed!&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">else</span> <span class="p">{</span>
  <span class="nx">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Mason testing that relies on exit code tests each file as a test, and the test
will be considered successful if the program compiled and exited with an exit
code of 0.</p>
<p>These tests should be configured such that a failure produces an exit code other than 0.
Returning a non-zero exit code can be accomplished by calling <code class="docutils literal notranslate"><span class="pre">exit()</span></code> or
throwing an uncaught error.</p>
<p>Both exit-code and <code class="docutils literal notranslate"><span class="pre">UnitTest</span></code> style tests can be used within a single mason
package.</p>
<p>After adding our test, the package structure will be as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>MyPackage/
 │
 ├── Mason.lock
 ├── Mason.toml
 ├── example/
 ├── src/
 │   └── myPackage.chpl
 ├── target/
 │   ├── debug/
 │   │   └── myPackage/
 │   ├── example/
 │   ├── release/
 │   │   └── myPackage
 │   └── test/
 └── test/
      └── myPackageTest.chpl
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">test</span></code> to run the test(s). If tests are not explicitly
specified in <code class="docutils literal notranslate"><span class="pre">Mason.toml</span></code>, Mason will gather all the tests found in <code class="docutils literal notranslate"><span class="pre">test/</span></code>,
compile them with the dependencies listed in your <code class="docutils literal notranslate"><span class="pre">Mason.toml</span></code> and run them
producing the following output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span> <span class="n">Results</span> <span class="o">---</span>
<span class="n">Test</span><span class="p">:</span> <span class="n">myPackageTest</span> <span class="n">Passed</span>

<span class="o">---</span> <span class="n">Summary</span><span class="p">:</span>  <span class="mi">1</span> <span class="n">tests</span> <span class="n">run</span> <span class="o">---</span>
<span class="o">-----&gt;</span> <span class="mi">1</span> <span class="n">Passed</span>
<span class="o">-----&gt;</span> <span class="mi">0</span> <span class="n">Failed</span>
</pre></div>
</div>
<p>Specific tests can be run by listing their names or substrings of their names as command line arguments:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run these specific tests:</span>
mason <span class="nb">test</span> test/test1.chpl test/test2.chpl
<span class="c1"># Run any test file with &#39;test1&#39; or &#39;test2&#39; in the name</span>
mason <span class="nb">test</span> test1 test2
<span class="c1"># Run any test file with the &#39;1&#39; in the name</span>
mason <span class="nb">test</span> <span class="m">1</span>
</pre></div>
</div>
<p>Specifying tests to run in the command line ignores the list of tests in <cite>Mason.toml</cite>, and searches all files in <cite>test/</cite>.</p>
<p>Additional output can be displayed by throwing the <code class="docutils literal notranslate"><span class="pre">--show</span> <span class="pre">flag</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">test</span></code> can also be used outside of a mason package as a
<code class="docutils literal notranslate"><span class="pre">UnitTest</span></code> test runner. See <a class="reference internal" href="../../modules/packages/UnitTest.html#module-UnitTest" title="UnitTest: The UnitTest module provides support for automated testing in Chapel."><code class="xref chpl chpl-mod docutils literal notranslate"><span class="pre">UnitTest</span></code></a> for more information.</p>
</div>
<p>Tests can be listed in the <code class="docutils literal notranslate"><span class="pre">Mason.toml</span></code> as a TOML array of strings for the
<code class="docutils literal notranslate"><span class="pre">tests</span></code> field:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[brick]
name = &quot;myPackage&quot;
version = &quot;0.1.0&quot;
chplVersion = &quot;1.18.0&quot;
license = &quot;None&quot;
tests = [&quot;test1.chpl&quot;,
         &quot;test2.chpl&quot;,
         &quot;test3.chpl&quot;]
</pre></div>
</div>
<p>An user may also set the <code class="docutils literal notranslate"><span class="pre">CHPL_COMM</span></code> value for running the tests, e.g. <code class="docutils literal notranslate"><span class="pre">none</span></code>, <code class="docutils literal notranslate"><span class="pre">gasnet</span></code>, <code class="docutils literal notranslate"><span class="pre">ugni</span></code> using <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">test</span> <span class="pre">--setComm</span></code>.</p>
</div>
<div class="section" id="creating-and-running-examples">
<h3><a class="toc-backref" href="#id11">Creating and Running Examples</a><a class="headerlink" href="#creating-and-running-examples" title="Permalink to this headline">¶</a></h3>
<p>Mason supports examples as a way to demonstrate typical usage of a package.
The following example adds an example to <code class="docutils literal notranslate"><span class="pre">MyPackage</span></code> and runs it.
The example below prints a message a number of times based on the <code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">const</span> <span class="pre">count</span></code>:</p>
<div class="highlight-chpl notranslate"><div class="highlight"><pre><span></span><span class="kd">config</span> <span class="kd">const</span> <span class="nx">count</span><span class="p">:</span> <span class="kt">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

<span class="k">for</span> <span class="nx">i</span> <span class="kd">in</span> <span class="mi">1</span><span class="o">..</span><span class="nx">count</span> <span class="p">{</span>
  <span class="nx">writeln</span><span class="p">(</span><span class="s">&quot;This is an example!!&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To build the example without running it, use the command <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">build</span> <span class="pre">--example</span></code>.
This command will build ALL examples found either in the <code class="docutils literal notranslate"><span class="pre">example/</span></code> directory or
listed in the <code class="docutils literal notranslate"><span class="pre">Mason.toml</span></code></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If examples or tests are listed in the Mason.toml, Mason will not search
for any examples or tests not listed.</p>
</div>
<p>To view what examples are available, enter <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">run</span> <span class="pre">--example</span></code> without any other
arguments. This will produce the names of all examples that are currently available
to Mason:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span> <span class="n">available</span> <span class="n">examples</span> <span class="o">---</span>
<span class="o">---</span> <span class="n">myPackageExample</span><span class="o">.</span><span class="n">chpl</span>
<span class="o">--------------------------</span>
</pre></div>
</div>
<p>To run the example, use the command <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">run</span> <span class="pre">--example</span> <span class="pre">myPackageExample.chpl</span></code>.</p>
<p>After the program is run via the command above, the package structure will look as
follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>MyPackage/
 │
 ├── Mason.lock
 ├── Mason.toml
 ├── example/
 │   └── myPackageExample.chpl
 ├── src/
 │   └── myPackage.chpl
 ├── target/
 │   ├── debug/
 │   │   └── myPackage
 │   ├── example/
 │   │   └── myPackageExample
 │   ├── release/
 │   │   └── myPackage
 │   └── test/
 └── test/
      └── myPackageTest.chpl
</pre></div>
</div>
<p>Examples can either be specified in the Mason.toml, or found automatically by Mason. However,
to include compile time or runtime arguments for examples, users must explicitly declare them
in their <code class="docutils literal notranslate"><span class="pre">Mason.toml</span></code> as follows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[brick]
name = &quot;myPackage&quot;
version = &quot;0.1.0&quot;
chplVersion = &quot;1.18.0&quot;
license = &quot;None&quot;

[dependencies]

[examples]
examples = [&quot;myPackageExample.chpl&quot;]

[examples.myPackageExample]
execopts = &quot;--count=20&quot;
compopts = &quot;--savec tmp&quot;
</pre></div>
</div>
</div>
<div class="section" id="documenting-a-package">
<h3><a class="toc-backref" href="#id12">Documenting a Package</a><a class="headerlink" href="#documenting-a-package" title="Permalink to this headline">¶</a></h3>
<p>Creating a website for package documentation is a breeze with Mason. Mason uses <code class="docutils literal notranslate"><span class="pre">chpldoc</span></code> which turns any <code class="docutils literal notranslate"><span class="pre">.chpl</span></code> file
into <code class="docutils literal notranslate"><span class="pre">Sphinx</span></code> documentation. To document a package, run the command <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">doc</span></code> while inside of a package. The
documentation will be automatically generated as long as <code class="docutils literal notranslate"><span class="pre">chpldoc</span></code> has been set up. For instructions on how to set up
<code class="docutils literal notranslate"><span class="pre">chpldoc</span></code>, view its documentation. Documentation will be built into the <code class="docutils literal notranslate"><span class="pre">doc/</span></code> folder that will be created upon
the first call of <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">doc</span></code>.</p>
</div>
</div>
<div class="section" id="using-chapel-dependencies">
<h2><a class="toc-backref" href="#id13">Using Chapel Dependencies</a><a class="headerlink" href="#using-chapel-dependencies" title="Permalink to this headline">¶</a></h2>
<p>There are multiple types of dependencies in Mason. Chapel or “Mason” dependencies are other
Mason packages that you want to use in your Mason package.</p>
<p>To search through all the current available Mason packages, use <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">search</span></code>.</p>
<p>Chapel Dependencies are listed under the <code class="docutils literal notranslate"><span class="pre">[dependencies]</span></code> table in the <code class="docutils literal notranslate"><span class="pre">Mason.toml</span></code>
file of the package as follows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[brick]
name = &quot;myPackage&quot;
version = &quot;0.1.0&quot;
chplVersion = &quot;1.18.0&quot;
license = &quot;None&quot;

[dependencies]
MatrixMarket = 0.1.0
</pre></div>
</div>
<p>To add a Chapel dependency without editing the <code class="docutils literal notranslate"><span class="pre">Mason.toml</span></code> manually, use the <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">add</span></code>
command as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mason</span> <span class="n">add</span> <span class="n">MatrixMarket</span><span class="o">@</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="section" id="using-non-chapel-dependencies">
<h2><a class="toc-backref" href="#id14">Using Non-Chapel Dependencies</a><a class="headerlink" href="#using-non-chapel-dependencies" title="Permalink to this headline">¶</a></h2>
<p>Mason allows for specification of external, non-Chapel dependencies through two
mediums, <code class="docutils literal notranslate"><span class="pre">Spack</span></code> and <code class="docutils literal notranslate"><span class="pre">pkg-config</span></code>. The following two sections document how to
use <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">external</span></code> and <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">system</span></code> to interface with <code class="docutils literal notranslate"><span class="pre">Spack</span></code> and <code class="docutils literal notranslate"><span class="pre">pkg-config</span></code>
packages respectively.</p>
<div class="section" id="using-system-dependencies">
<h3><a class="toc-backref" href="#id15">Using System Dependencies</a><a class="headerlink" href="#using-system-dependencies" title="Permalink to this headline">¶</a></h3>
<p>System dependencies are packages that are found on your system through <code class="docutils literal notranslate"><span class="pre">pkg-config</span></code>. To use
this functionality of Mason, users must have <code class="docutils literal notranslate"><span class="pre">pkg-config</span></code> installed.</p>
<p>Mason interfaces with <code class="docutils literal notranslate"><span class="pre">pkg-config</span></code> through the <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">system</span></code> command.</p>
<p><code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">system</span> <span class="pre">search</span></code> will print all the current packages installed and available for use in a Mason package. To examine
the <code class="docutils literal notranslate"><span class="pre">.pc</span></code> file of a particular package, use <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">system</span> <span class="pre">pc</span> <span class="pre">&lt;package&gt;</span></code> where <code class="docutils literal notranslate"><span class="pre">&lt;package&gt;</span></code>
is replaced with the particular package you are looking for. Here is an example of a workflow
for creating a Mason package with <code class="docutils literal notranslate"><span class="pre">openssl</span></code> which has already been installed.</p>
<p>First, search to see that it is installed with <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">system</span> <span class="pre">search</span> <span class="pre">openSSl</span></code> which outputs:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ mason system search openssl
openssl               OpenSSL - Secure Sockets Layer and cryptography libraries and tools
</pre></div>
</div>
<p>To find out more about the package, since it is in fact installed on my system, use the
<code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">system</span> <span class="pre">pc</span></code> command as follows</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ mason system pc openssl

------- openSSL.pc -------

<span class="nv">prefix</span><span class="o">=</span>/usr
<span class="nv">exec_prefix</span><span class="o">=</span><span class="si">${</span><span class="nv">prefix</span><span class="si">}</span>
<span class="nv">libdir</span><span class="o">=</span><span class="si">${</span><span class="nv">exec_prefix</span><span class="si">}</span>/lib
<span class="nv">includedir</span><span class="o">=</span><span class="si">${</span><span class="nv">prefix</span><span class="si">}</span>/include

Name: OpenSSL
Description: Secure Sockets Layer and cryptography libraries and tools
Version: <span class="m">0</span>.9.8zh
Requires:
Libs: -L<span class="si">${</span><span class="nv">libdir</span><span class="si">}</span> -lssl -lcrypto -lz
Cflags: -I<span class="si">${</span><span class="nv">includedir</span><span class="si">}</span>

-------------------
</pre></div>
</div>
<p>Use the <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">add</span> <span class="pre">--system</span></code> command to add the dependency to the Mason.toml of the package.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ mason add --system openSSL@0.9.8zh
Adding system dependency openSSL version <span class="m">0</span>.9.8zh
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Mason.toml</span></code> now looks like:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[brick]
name = &quot;myPackage&quot;
version = &quot;0.1.0&quot;
chplVersion = &quot;1.18.0&quot;
license = &quot;None&quot;

[system]
openSSL = &quot;0.9.8zh&quot;
</pre></div>
</div>
<p>Now, upon calling <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">build</span></code> or <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">run</span> <span class="pre">--build</span></code>, Mason will go get <code class="docutils literal notranslate"><span class="pre">openssl</span></code> and include it
in the package so that it can be used as a dependency.</p>
</div>
<div class="section" id="using-spack-dependencies">
<h3><a class="toc-backref" href="#id16">Using Spack Dependencies</a><a class="headerlink" href="#using-spack-dependencies" title="Permalink to this headline">¶</a></h3>
<p>Mason users can interface with <code class="docutils literal notranslate"><span class="pre">Spack</span></code>, a package manager geared towards high performance
computing. Through this integration, Mason user’s now have
access to a large ecosystem of <a class="reference external" href="https://spack.readthedocs.io/en/latest/package_list.html#package-list">packages</a>.
Non-destructive installs, custom version and configurations, and simple package installation
and uninstallation are a few of the features Mason gains through this integration.</p>
<p>Mason users can access Spack through the <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">external</span></code> command. Spack provides Mason users with the ability
to install and use any package in the <a class="reference external" href="https://spack.readthedocs.io/en/latest/package_list.html#package-list">Spack registry</a>.
This interface is analogous to the previous example except when a package is missing, user’s can download that package
through the Spack integration. The following is a workflow of finding, installing, and adding a Spack dependency to a Mason Package.</p>
<p><strong>Setting up Spack backend</strong></p>
<p>First, the Spack backend must be installed. Users can have mason install Spack
or point mason to an existing spack installation.</p>
<p>This command will install Spack into <code class="docutils literal notranslate"><span class="pre">$MASON_HOME/spack</span></code> and set it up so that it
can be used by Mason. It should be noted that this command pulls from the <cite>master</cite> branch of spack
for setting up the spack registry at <code class="docutils literal notranslate"><span class="pre">$MASON_HOME/spack-registry</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mason</span> <span class="n">external</span> <span class="o">--</span><span class="n">setup</span>
</pre></div>
</div>
<p>Alternatively, users can set <code class="docutils literal notranslate"><span class="pre">$SPACK_ROOT</span></code> to their own spack installation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">SPACK_ROOT</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">spack</span>
</pre></div>
</div>
<p><strong>Searching Spack packages</strong></p>
<p>Let’s use <code class="docutils literal notranslate"><span class="pre">openSSL</span></code> as an example since we used it in the system example. <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">external</span> <span class="pre">search</span> <span class="pre">openSSL</span></code>
will search for the package and produce the following output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ mason external search openSSL
==&gt; 2 packages.
openssl  r-openssl
</pre></div>
</div>
<p>Obviously there are two types of the package listed, so we need to figure out which one to use.
To find out more about a package, use <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">external</span> <span class="pre">info</span> <span class="pre">&lt;package&gt;</span></code> as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ mason external info openssl
Package:   openssl

Description:
OpenSSL is an open source package that provides a robust, commercial-
grade, and full-featured toolkit for the Transport Layer Security (TLS)
and Secure Sockets Layer (SSL) protocols. It is also a general-purpose
cryptography library.

Homepage: http://www.openssl.org

Tags:
  None

Preferred version:
  1.0.2k    http://www.openssl.org/source/openssl-1.0.2k.tar.gz

Safe versions:
  1.1.0e    http://www.openssl.org/source/openssl-1.1.0e.tar.gz
  1.1.0d    http://www.openssl.org/source/openssl-1.1.0d.tar.gz
  1.1.0c    http://www.openssl.org/source/openssl-1.1.0c.tar.gz
  1.0.2k    http://www.openssl.org/source/openssl-1.0.2k.tar.gz
  1.0.2j    http://www.openssl.org/source/openssl-1.0.2j.tar.gz

Variants:
 None

Installation Phases:
 install

Build Dependencies:
 zlib

Link Dependencies:
 zlib

Run Dependencies:
 None

Virtual Packages:
 None
</pre></div>
</div>
<p><strong>Installing Spack packages</strong></p>
<p>The correct package has been found, but not yet installed. Let’s fix that.
We know that we want the preferred version which is <code class="docutils literal notranslate"><span class="pre">1.0.2k</span></code>.
The command to install <code class="docutils literal notranslate"><span class="pre">openssl</span></code> version <code class="docutils literal notranslate"><span class="pre">1.0.2k</span></code> would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mason</span> <span class="n">external</span> <span class="n">install</span> <span class="n">openssl</span>
</pre></div>
</div>
<p>Since the version was left out, version <code class="docutils literal notranslate"><span class="pre">1.0.2k</span></code> is used because Mason
will always take the preferred version. This is a case where Spack’s
spec expression syntax can be used to specify exactly which package is desired.
For example, other ways to install openSSL would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mason</span> <span class="n">external</span> <span class="n">install</span> <span class="n">openssl</span><span class="o">@</span><span class="mf">1.0</span><span class="o">.</span><span class="mi">2</span><span class="n">k</span>
</pre></div>
</div>
<p>which simply specifies the exact version that we want.
If we wanted to specify which compiler the package was built with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mason</span> <span class="n">external</span> <span class="n">install</span> <span class="n">openssl</span><span class="o">@</span><span class="mf">1.0</span><span class="o">.</span><span class="mi">2</span><span class="n">k</span><span class="o">%</span><span class="n">gcc</span>
</pre></div>
</div>
<p>Mason will infer which compiler, in the case that the compiler is left out of the spec,
by looking at the environment variable <code class="docutils literal notranslate"><span class="pre">CHPL_TARGET_COMPILER</span></code>. For more information on
how to use spec expressions, use the command <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">external</span> <span class="pre">--spec</span></code> which would output the following:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span> spec expression syntax:

package [constraints] [^dependency [constraints] ...]

package                           any package from &#39;spack list&#39;

constraints:
  versions:
    @version                      single version
    @min:max                      version range (inclusive)
    @min:                         version &lt;min&gt; or higher
    @:max                         up to version &lt;max&gt; (inclusive)

  compilers:
    %compiler                     build with &lt;compiler&gt;
    %compiler@version             build with specific compiler version
    %compiler@min:max             specific version range (see above)

  variants:
    +variant                      enable &lt;variant&gt;
    -variant or ~variant          disable &lt;variant&gt;
    variant=value                 set non-boolean &lt;variant&gt; to &lt;value&gt;
    variant=value1,value2,value3  set multi-value &lt;variant&gt; values

  architecture variants:
    target=target                 specific &lt;target&gt; processor
    os=operating_system           specific &lt;operating_system&gt;
    platform=platform             linux, darwin, cray, bgq, etc.
    arch=platform-os-target       shortcut for all three above

  cross-compiling:
    os=backend or os=be           build for compute node (backend)
    os=frontend or os=fe          build for login node (frontend)

  dependencies:
    ^dependency [constraints]     specify constraints on dependencies

examples:
    hdf5                          any hdf5 configuration
    hdf5 @1.10.1                  hdf5 version 1.10.1
    hdf5 @1.8:                    hdf5 1.8 or higher
    hdf5 @1.8: %gcc               hdf5 1.8 or higher built with gcc
    hdf5 +mpi                     hdf5 with mpi enabled
    hdf5 ~mpi                     hdf5 with mpi disabled
    hdf5 +mpi ^mpich              hdf5 with mpi, using mpich
    hdf5 +mpi ^openmpi@1.7        hdf5 with mpi, using openmpi 1.7
    boxlib dim=2                  boxlib built for 2 dimensions
    libdwarf %intel ^libelf%gcc
        libdwarf, built with intel compiler, linked to libelf built with gcc
    mvapich2 %pgi fabrics=psm,mrail,sock
        mvapich2, built with pgi compiler, with support for multiple fabrics
</pre></div>
</div>
<p>Resuming the example, the result of the install given <code class="docutils literal notranslate"><span class="pre">openssl</span></code> as the sole argument would output the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ mason external install openssl
==&gt; Installing zlib
==&gt; Fetching http://zlib.net/fossils/zlib-1.2.11.tar.gz
==&gt; Staging archive: /$HOME/.mason/spack/var/spack/stage/zlib-1.2.11-cpdvq4e7otjepbwdtxmgk5bzszze27fj/zlib-1.2.11.tar.gz
==&gt; Created stage in /$HOME/.mason/spack/var/spack/stage/zlib-1.2.11-cpdvq4e7otjepbwdtxmgk5bzszze27fj
==&gt; No patches needed for zlib
==&gt; Building zlib [Package]
==&gt; Executing phase: &#39;install&#39;
==&gt; Successfully installed zlib
Fetch: 4.84s.  Build: 4.24s.  Total: 9.08s.

==&gt; Installing openssl
==&gt; Fetching http://www.openssl.org/source/openssl-1.0.2k.tar.gz
==&gt; Staging archive: /$HOME/.mason/spack/var/spack/stage/openssl-1.0.2k-fwnsee6qcvbbgvmgp3f5hio6dwg6nh2d/openssl-1.0.2k.tar.gz
==&gt; Created stage in /$HOME/.mason/spack/var/spack/stage/openssl-1.0.2k-fwnsee6qcvbbgvmgp3f5hio6dwg6nh2d
==&gt; No patches needed for openssl
==&gt; Building openssl [Package]
==&gt; Executing phase: &#39;install&#39;
==&gt; Successfully installed openssl
Fetch: 3.37s.  Build: 3m 11.76s.  Total: 3m 15.13s.
######################################################################## 100.0%
######################################################################## 100.0%
</pre></div>
</div>
<p>As shown, Mason not only goes and gets the package specified, but also all of the dependencies
of the package specified. Packages are installed into unique directories such that it is impossible for package namespaces to collide.
Each dependency is downloaded distinctly for a package so no previous installs will be broken by installing new packages.
This way, multiple versions and builds of a package can be installed on a system and used without breaking anything.</p>
<p><strong>Specifying Spack packages in the manifest file</strong></p>
<p>Now that the correct package is installed, add it to the <code class="docutils literal notranslate"><span class="pre">Mason.toml</span></code> as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ mason add --external openssl@1.0.2k
Adding external dependency with spec openssl@1.0.2k
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Mason.toml</span></code> now looks like:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[brick]
name = &quot;myPackage&quot;
version = &quot;0.1.0&quot;
chplVersion = &quot;1.18.0&quot;
license = &quot;None&quot;

[external]
openSSL = &quot;1.0.2k&quot;
</pre></div>
</div>
<p>To ensure the package is installed on the system, run <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">external</span> <span class="pre">find</span></code>
which will list all of the current Spack packages installed on system. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">==&gt;</span> <span class="mi">2</span> <span class="n">installed</span> <span class="n">packages</span><span class="o">.</span>
<span class="o">--</span> <span class="n">darwin</span><span class="o">-</span><span class="n">sierra</span><span class="o">-</span><span class="n">x86_64</span> <span class="o">/</span> <span class="n">clang</span><span class="o">@</span><span class="mf">9.0</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">apple</span> <span class="o">---------------------</span>
<span class="n">openssl</span><span class="o">@</span><span class="mf">1.0</span><span class="o">.</span><span class="mi">2</span><span class="n">k</span>  <span class="n">zlib</span><span class="o">@</span><span class="mf">1.2</span><span class="o">.</span><span class="mi">11</span>
</pre></div>
</div>
<p>Now, everything necessary to use <code class="docutils literal notranslate"><span class="pre">openssl</span></code> in a Mason package has been done.
Upon building, Mason will retrieve the necessary files and file locations
for building <code class="docutils literal notranslate"><span class="pre">myPackage</span></code> with <code class="docutils literal notranslate"><span class="pre">openssl</span></code>.</p>
</div>
</div>
<div class="section" id="mason-registry">
<h2><a class="toc-backref" href="#id17">Mason-Registry</a><a class="headerlink" href="#mason-registry" title="Permalink to this headline">¶</a></h2>
<p>The default mason registry is a GitHub repository containing a list of versioned manifest files.</p>
<p><a class="reference external" href="https://github.com/chapel-lang/mason-registry">Mason-Registry</a>.</p>
<p>A registry will be downloaded to <code class="docutils literal notranslate"><span class="pre">$MASON_HOME/&lt;name&gt;</span></code> by <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">update</span></code>
for each registry named in <code class="docutils literal notranslate"><span class="pre">$MASON_REGISTRY</span></code> if a registry at that location
does not already exist.</p>
<p>The registry consists of a hierarchy like the following:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>mason-registry/
   Bricks/
      Curl/
         1.0.0.toml
         2.0.0.toml
      RecordParser/
         1.0.0.toml
         1.1.0.toml
         1.2.0.toml
      VisualDebug/
         2.2.0.toml
         2.2.1.toml
</pre></div>
</div>
<p>Each versioned manifest file is identical to the manifest file in the top-level directory
of the package repository, with the exception of a file path or URL pointing to the repository and revision
in which the version is located.</p>
<p>Continuing the example from before, the ‘registry’ <code class="docutils literal notranslate"><span class="pre">0.1.0.toml</span></code> would include the additional source field:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[brick]
name = &quot;MyPackage&quot;
version = &quot;0.1.0&quot;
chplVersion = &quot;1.16.0&quot;
license = &quot;None&quot;
authors = [&quot;Sam Partee &lt;Sam@Partee.com&gt;&quot;]
source = &quot;https://github.com/Spartee/MyPackage&quot;

[dependencies]
curl = &#39;1.0.0&#39;
</pre></div>
</div>
<p>Search the registry with <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">search</span> <span class="pre">&lt;query&gt;</span></code>, which will list all packages
(and their latest version) that contain <code class="docutils literal notranslate"><span class="pre">&lt;query&gt;</span></code> in their names (case-insensitive).
If no query is provided, all packages in the registry will be listed.</p>
<p>Searching with the <code class="docutils literal notranslate"><span class="pre">--show</span></code> flag will output the toml file of a package if the search
returns a single package. If the package has multiple versions it will return the most
recent.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Packages will be listed regardless of their <code class="docutils literal notranslate"><span class="pre">chplVersion</span></code> compatibility.</p>
</div>
</div>
<div class="section" id="submit-a-package">
<span id="id2"></span><h2><a class="toc-backref" href="#id18">Submit a Package</a><a class="headerlink" href="#submit-a-package" title="Permalink to this headline">¶</a></h2>
<p>The mason registry will hold the manifest files for packages submitted by developers.
To contribute a package to the mason-registry a chapel developer will need to host their
package and submit a pull request to the mason-registry with the toml file pointing
to their package. For a more detailed description follow the steps below. Publishing
can be done with <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">publish</span></code> or manually.</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">publish</span></code> Steps:</dt><dd><ol class="arabic simple">
<li><p>Write a library or binary package in chapel using mason</p></li>
<li><p>Host the package in a git repository. (e.g. GitHub)</p></li>
<li><p>Fork the mason-registry on GitHub</p></li>
<li><p>Ensure your package has a remote origin.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">publish</span></code> in your package</p></li>
<li><p>Go to the link provided to open a pull request to the mason registry.</p></li>
<li><p>Wait for mason-registry gatekeepers to approve PR.</p></li>
</ol>
</dd>
<dt>Manual Steps:</dt><dd><ol class="arabic simple">
<li><p>Write a library or binary package in chapel using mason</p></li>
<li><p>Host that package in a git repository. (e.g. GitHub)</p></li>
<li><p>Create a tag of your package that corresponds to the version number prefixed with a ‘v’. (e.g. v0.1.0)</p></li>
<li><p>Fork the mason-registry on GitHub</p></li>
<li><p>Create a branch of the mason-registry and add your package’s <code class="docutils literal notranslate"><span class="pre">Mason.toml</span></code> under <code class="docutils literal notranslate"><span class="pre">Bricks/&lt;package_name&gt;/&lt;version&gt;.toml</span></code></p></li>
<li><p>Add a source field to your <code class="docutils literal notranslate"><span class="pre">&lt;version&gt;.toml</span></code> pointing to your package’s repository.</p></li>
<li><p>Open a PR in the mason-registry for your newly created branch containing just your &lt;version&gt;.toml.</p></li>
<li><p>Wait for mason-registry gatekeepers to approve the PR.</p></li>
</ol>
</dd>
</dl>
<p>Once your package is uploaded, maintain the integrity of your package, and please notify the
chapel team if your package should be taken down.</p>
<p>If you have a personal remote registry, <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">publish</span> <span class="pre">&lt;path-to-registry&gt;</span></code>  also accepts
a remote path to a git repository. This will create a branch to your registry that adds
your package, and you can approve the PR to merge your new package into your registry.
Must ensure your package has a remote origin in order to publish remotely.</p>
<p>Publishing to a personal remote registry</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> PackageA
mason publish &lt;remote-path-to-registry&gt;
</pre></div>
</div>
<p>To assess the ability of your package to be published to the mason-registry or
a personal registry, run <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">publish</span> <span class="pre">--dry-run</span> <span class="pre">&lt;path-to-registry&gt;</span></code> for a
series of quick checks or <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">publish</span> <span class="pre">--check</span> <span class="pre">&lt;path-to-registry</span></code> for a more
in depth check that will build your packages and run the full test suite.</p>
</div>
<div class="section" id="local-registries">
<h2><a class="toc-backref" href="#id19">Local Registries</a><a class="headerlink" href="#local-registries" title="Permalink to this headline">¶</a></h2>
<p>It is sometimes desirable to use a local registry, for example with libraries
you don’t intend to distribute. The following steps create a local registry
starting with Bricks for <code class="docutils literal notranslate"><span class="pre">PackageA</span></code> which was created with <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">new</span> <span class="pre">PackageA</span></code>.
Once you have successfully created a local registry, <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">publish</span> <span class="pre">&lt;path-to-local-registry&gt;</span></code>
can be used to publish automatically.</p>
<p>First create, commit, and tag the packages that will be in the registry:</p>
<p>Create a local registry:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the local registry</span>
mkdir /path/to/local/registry
<span class="nb">cd</span> /path/to/local/registry
<span class="c1"># Create /Bricks/DummyPackage/0.1.0.toml</span>
touch README.md

<span class="c1"># Initialize and check everything in to the git repository</span>
git init
git add README.md /Bricks/DummyPackage/0.1.0.toml
git commit -m <span class="s1">&#39;First Commit&#39;</span>
</pre></div>
</div>
<p>Alternatively, you may automatically create a local registry by running <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">publish</span> <span class="pre">--create-registry</span> <span class="pre">path/to/local/registry</span></code>.
Now <code class="docutils literal notranslate"><span class="pre">MASON_REGISTRY</span></code> can be set to point at both the local registry and the
default registry.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">MASON_REGISTRY</span><span class="o">=</span><span class="s2">&quot;local-registry|/path/to/local/registry,mason-registry|https://github.com/chapel-lang/mason-registry&quot;</span>
</pre></div>
</div>
<p>Adding a local package to the local registry</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>mason new PackageA
<span class="nb">cd</span> PackageA
git add .
git commit -m <span class="s2">&quot;First Commit&quot;</span>
mason publish &lt;path-to-local-registry&gt;
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">MyPackage</span></code> package is now free to include <code class="docutils literal notranslate"><span class="pre">PackageA</span></code> as dependency by adding
the it as a dependency with <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">add</span> <span class="pre">package&#64;version</span></code></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> MyPackage
mason add PackageA@0.1.0
</pre></div>
</div>
</div>
<div class="section" id="the-manifest-file">
<h2><a class="toc-backref" href="#id20">The Manifest File</a><a class="headerlink" href="#the-manifest-file" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Mason.toml</span></code> manifest file is written in TOML(for more information see TOML section below).
Each time a new package is created in Mason a standard TOML file is included in the top-level
directory of the package.</p>
<p>For example, <code class="docutils literal notranslate"><span class="pre">Mason.toml</span></code>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[brick]
name = &quot;MyPackage&quot;
version = &quot;0.1.0&quot;
chplVersion = &quot;1.16.0&quot;
license = &quot;None&quot;
authors = [&quot;Sam Partee &lt;Sam@Partee.com&gt;&quot;]

[dependencies]
curl = &#39;1.0.0&#39;
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">chplVersion</span></code> field indicates Chapel releases compatible with this
package. There are a number of accepted formats:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&quot;1.16.0&quot;         # 1.16.0 or later
&quot;1.16&quot;           # 1.16.0 or later
&quot;1.16.0..1.19.0&quot; # 1.16 through 1.19, inclusive
</pre></div>
</div>
<p>By default, <code class="docutils literal notranslate"><span class="pre">chplVersion</span></code> is set to represent the current Chapel release or
later. For example, if you are using the 1.16 release, chplVersion will be
<code class="docutils literal notranslate"><span class="pre">1.16.0</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">license</span></code> field indicates the software license under which the package is distributed.
Any of the licenses available at the <a class="reference external" href="https://spdx.org/licenses/">SPDX License List</a> can be used for Mason packages.
The license field defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</div>
<div class="section" id="environment-variables">
<h2><a class="toc-backref" href="#id21">Environment Variables</a><a class="headerlink" href="#environment-variables" title="Permalink to this headline">¶</a></h2>
<p>Mason can be configured by setting the following environment variables:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MASON_HOME</span></code> : Path to a directory where mason will store cached registry
and package data. Defaults to <code class="docutils literal notranslate"><span class="pre">$HOME/.mason</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MASON_REGISTRY</span></code> : A comma separated list of <code class="docutils literal notranslate"><span class="pre">name|location</span></code> pairs, where
<code class="docutils literal notranslate"><span class="pre">name</span></code> is a local name for the registry at <code class="docutils literal notranslate"><span class="pre">location</span></code>. Defaults to
<code class="docutils literal notranslate"><span class="pre">mason-registry|https://github.com/chapel-lang/mason-registry</span></code>. If the
<code class="docutils literal notranslate"><span class="pre">name|</span></code> part of a pair is omitted it is inferred to be the word following
the final slash in <code class="docutils literal notranslate"><span class="pre">location</span></code> with any <code class="docutils literal notranslate"><span class="pre">.git</span></code> suffix removed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MASON_OFFLINE</span></code> : A boolean value that prevents mason from making calls that
require internet access when set to <code class="docutils literal notranslate"><span class="pre">true</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>. Mason command
that support a <code class="docutils literal notranslate"><span class="pre">--[no-]update</span></code> flag can override the <code class="docutils literal notranslate"><span class="pre">MASON_OFFLINE</span></code> setting
when <code class="docutils literal notranslate"><span class="pre">--update</span></code> is explicitly passed.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">env</span></code> command will print the inferred or set values of these
environment variables. If a variable was set by the user, an asterisk will be
printed at the end of the line. For example, if <code class="docutils literal notranslate"><span class="pre">$MASON_HOME</span></code> was set:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&gt; mason env
MASON_HOME: /path/to/something *
MASON_REGISTRY: mason-registry|https://github.com/chapel-lang/mason-registry
MASON_OFFLINE: false
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If <code class="docutils literal notranslate"><span class="pre">MASON_REGISTRY</span></code> changes after invoking a mason command that updates the
local copy of the registry (e.g. <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">update</span></code>), the local copies of the
registry and dependency sources will be removed.</p>
</div>
</div>
<div class="section" id="toml">
<h2><a class="toc-backref" href="#id22">TOML</a><a class="headerlink" href="#toml" title="Permalink to this headline">¶</a></h2>
<p>TOML is the configuration language chosen by the chapel team for
configuring programs written in chapel. A TOML file contains the
necessary information to build a chapel program using mason.
<a class="reference external" href="https://github.com/toml-lang/toml">TOML Spec</a>.</p>
</div>
<div class="section" id="namespacing">
<h2><a class="toc-backref" href="#id23">Namespacing</a><a class="headerlink" href="#namespacing" title="Permalink to this headline">¶</a></h2>
<p>All packages will exist in a single common namespace with a first-come, first-served policy.
It is easier to go to separate namespaces than to roll them back, so this position affords
flexibility.</p>
</div>
<div class="section" id="semantic-versioning">
<h2><a class="toc-backref" href="#id24">Semantic Versioning</a><a class="headerlink" href="#semantic-versioning" title="Permalink to this headline">¶</a></h2>
<p>To assist version resolution, the mason registry will enforce the following conventions:</p>
<dl class="simple">
<dt>The format for all versions will be a.b.c.</dt><dd><p>Major versions are denoted by a.
Minor versions are denoted by b.
Bug fixes are denoted by c.</p>
</dd>
</dl>
<ul class="simple">
<li><p>If the major version is 0, no further conventions will be enforced.</p></li>
<li><p>The major version must be advanced if and only if the update causes breaking API changes,
such as updated data structures or removed methods and procedures. The minor and bug fix
versions will be zeroed out. (ex. 1.13.1 -&gt; 2.0.0)</p></li>
<li><p>The minor version must be advanced if and only if the update adds functionality to the API
while maintaining backward compatibility with the current major version. The bug fix
version will be zeroed out. (ex. 1.13.1 -&gt; 1.14.0)</p></li>
<li><p>The bug fix must be advanced for any update correcting functionality within a minor revision.
(ex. 1.13.1 -&gt; 1.13.2)</p></li>
</ul>
</div>
<div class="section" id="incompatible-version-resolution-strategy">
<h2><a class="toc-backref" href="#id25">Incompatible Version Resolution Strategy</a><a class="headerlink" href="#incompatible-version-resolution-strategy" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>The current resolution strategy for Mason 0.1.0 is the IVRS as described below:</dt><dd><ol class="arabic simple">
<li><p>If multiple bug fixes of a package are present in the package,
mason will use the latest bug fix. (ex. 1.1.0, 1.1.1 –&gt; 1.1.1)</p></li>
<li><p>If multiple minor versions of a package are present in the package,
mason will use the latest minor version within the common major version.
(ex. 1.4.3, 1.7.0 –&gt; 1.7)</p></li>
<li><p>If multiple major versions are present, mason will print an error.
(ex. 1.13.0, 2.1.0 –&gt; incompatible)</p></li>
</ol>
</dd>
</dl>
</div>
<div class="section" id="the-lock-file">
<h2><a class="toc-backref" href="#id26">The Lock File</a><a class="headerlink" href="#the-lock-file" title="Permalink to this headline">¶</a></h2>
<p>The lock file <code class="docutils literal notranslate"><span class="pre">Mason.lock</span></code> is generated after running a <code class="docutils literal notranslate"><span class="pre">mason</span> <span class="pre">update</span></code> command. The user should
never manually edit the lock file as it is intended to “lock” in the settings of a certain
package build iteration. <code class="docutils literal notranslate"><span class="pre">Mason.lock</span></code> is added by default to the .gitignore when a new package
is created. If your intention is to create a binary application package that does not need to
be re-compiled by mason then take the <code class="docutils literal notranslate"><span class="pre">Mason.lock</span></code> out of your .gitignore. An example of
a lock file is written below as if generated from the earlier example of a <code class="docutils literal notranslate"><span class="pre">Mason.toml</span></code>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[curl]
name = &#39;curl&#39;
version = &#39;1.0.0&#39;
chplVersion = &quot;1.16.0..1.16.0&quot;
license = &quot;None&quot;
source = &#39;https://github.com/username/curl&#39;


[root]
name = &quot;MyPackage&quot;
version = &quot;0.1.0&quot;
chplVersion = &quot;1.16.0..1.16.0&quot;
license = &quot;None&quot;
authors = [&quot;Sam Partee &lt;Sam@Partee.com&gt;&quot;]
source = &quot;https://github.com/Spartee/MyPackage&quot;
dependencies = [&#39;curl 1.0.0 https://github.com/username/curl&#39;]
</pre></div>
</div>
</div>
<div class="section" id="dependency-code">
<h2><a class="toc-backref" href="#id27">Dependency Code</a><a class="headerlink" href="#dependency-code" title="Permalink to this headline">¶</a></h2>
<p>The source code for every package will be downloaded to <code class="docutils literal notranslate"><span class="pre">$MASON_HOME/src</span></code>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../protoc-gen-chpl/protoc-gen-chpl.html" class="btn btn-neutral float-right" title="Protocol Buffers Support in Chapel" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../chplvis/chplvis.html" class="btn btn-neutral float-left" title="chplvis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Hewlett Packard Enterprise Development LP

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 



</body>
</html>