

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>c2chapel &mdash; Chapel Documentation 1.24</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="chpldoc" href="../chpldoc/chpldoc.html" />
    <link rel="prev" title="Tools" href="../index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

<a href="../../index.html" class="icon icon-home"> Chapel Documentation

<!-- display version if button won't be rendered -->
<?php if (false) { ?>
<br>1.24
<?php } ?>

</a>

<?php
// Variables given by sphinx
$chplTitle = "1.24";
$pagename = "tools/c2chapel/c2chapel";
include "../..//versionButton.php";
?>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Compiling and Running Chapel</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../usingchapel/QUICKSTART.html">Quickstart Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usingchapel/index.html">Using Chapel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../platforms/index.html">Platform-Specific Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../technotes/index.html">Technical Notes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Tools</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">c2chapel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#a-tool-to-generate-c-bindings-for-chapel">A tool to generate C bindings for Chapel</a></li>
<li class="toctree-l3"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building">Building</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#future-work">Future Work</a></li>
<li class="toctree-l3"><a class="reference internal" href="#contributors">Contributors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../chpldoc/chpldoc.html">chpldoc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chplvis/chplvis.html">chplvis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mason/mason.html">Mason</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protoc-gen-chpl/protoc-gen-chpl.html">Protocol Buffers Support in Chapel</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Writing Chapel Programs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../language/reference.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Hello World Variants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../primers/index.html">Primers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../language/spec/index.html">Language Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../builtins/index.html">Built-in Types and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/standard.html">Standard Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/packages.html">Package Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/layoutdist.html">Standard Layouts and Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mason-packages.html">Mason Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users-guide/index.html">Chapel Users Guide (WIP)</a></li>
</ul>
<p class="caption"><span class="caption-text">Language History</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../language/evolution.html">Chapel Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../language/archivedSpecs.html">Documentation Archives</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Chapel Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Tools</a> &raquo;</li>
        
      <li>c2chapel</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/tools/c2chapel/c2chapel.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="c2chapel">
<span id="id1"></span><h1>c2chapel<a class="headerlink" href="#c2chapel" title="Permalink to this headline">¶</a></h1>
<div class="section" id="a-tool-to-generate-c-bindings-for-chapel">
<h2>A tool to generate C bindings for Chapel<a class="headerlink" href="#a-tool-to-generate-c-bindings-for-chapel" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">c2chapel</span></code> is a tool to help the Chapel programmer generate extern types,
records, and procedures when given a C99 file. For example, given the following
function declaration in a header file:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">foo</span><span class="p">(</span><span class="kt">char</span><span class="o">*</span> <span class="n">str</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">c2chapel</span></code> will generate Chapel code similar to:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">extern</span> <span class="k">proc</span> <span class="nf">foo</span><span class="p">(</span><span class="nx">str</span><span class="p">:</span> <span class="nx">c_string</span><span class="p">,</span> <span class="nx">n</span> <span class="p">:</span> <span class="nx">c_int</span><span class="p">)</span> <span class="p">:</span> <span class="kt">void</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>This tool has the following prerequisites:</p>
<ul class="simple">
<li><p>A Unix-like environment (something with commands like cd, mkdir, rm, etc.)</p></li>
<li><p>A GNU-compatible version of ‘make’</p></li>
<li><p>A C preprocessor</p></li>
<li><p>Python 2.7 or Python 3.5</p></li>
</ul>
<p>Other versions of Python may work, but only 2.7 and 3.5 have been tested as of
version 0.1.0.</p>
</div>
<div class="section" id="building">
<h2>Building<a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">c2chapel</span></code> is built on top of <a class="reference external" href="https://github.com/eliben/pycparser">pycparser</a>.
Building <code class="docutils literal notranslate"><span class="pre">c2chapel</span></code> will install pycparser into a local virtualenv, leaving
the user’s python environment untouched. A symbolic link will be created in the
appropriate directory under <code class="docutils literal notranslate"><span class="pre">$CHPL_HOME/bin</span></code>.</p>
<p>To build, run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">c2chapel</span></code> from <code class="docutils literal notranslate"><span class="pre">$CHPL_HOME</span></code>.</p>
<p>If virtualenv is not installed, this build process will attempt to use a local
virtualenv installation generated by other Chapel make targets if one is
available. For example, <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">test-venv</span></code> from <code class="docutils literal notranslate"><span class="pre">$CHPL_HOME</span></code> will create a
local virtualenv installation that can be used by the <code class="docutils literal notranslate"><span class="pre">c2chapel</span></code> build
process.</p>
<p>Once installed, <code class="docutils literal notranslate"><span class="pre">c2chapel</span></code> should be visible in your <code class="docutils literal notranslate"><span class="pre">$PATH</span></code> provided you
have sourced a script like <code class="docutils literal notranslate"><span class="pre">$CHPL_HOME/util/setchplenv.bash</span></code> (also used to
make the <code class="docutils literal notranslate"><span class="pre">chpl</span></code> compiler available to your path). To test the <code class="docutils literal notranslate"><span class="pre">c2chapel</span></code>
installation, you can run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">check</span></code> from tools/c2chapel/.</p>
<p>To remove <code class="docutils literal notranslate"><span class="pre">c2chapel</span></code> and files generated during the build process, execute
one of the following commands from tools/c2chapel/:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>make clean
make cleanall
make clobber
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">clobber</span></code> from <code class="docutils literal notranslate"><span class="pre">$CHPL_HOME</span></code> will also remove <code class="docutils literal notranslate"><span class="pre">c2chapel</span></code>.</p>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">c2chapel</span></code> requires the name of a C99-compliant file, and emits the generated
Chapel code to stdout. For example, once installed you can run the following
command from within tools/c2chapel/:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>c2chapel test/fnints.h
</pre></div>
</div>
<p>The resulting output should be identical to <code class="docutils literal notranslate"><span class="pre">tools/c2chapel/test/fnints.chpl</span></code>.
Run <code class="docutils literal notranslate"><span class="pre">c2chapel</span></code> with the <code class="docutils literal notranslate"><span class="pre">--help</span></code> flag to show more options:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>usage: c2chapel [-h] [--no-typedefs] [--debug] [--no-fake-headers]
                [--no-comments] [-V]
                file [cppFlags [cppFlags ...]]

Generate C bindings for Chapel

positional arguments:
  file               C99 file for which to generate bindings
  cppFlags           flags forwarded to the C preprocessor (invoked with cc
                     -E)

optional arguments:
  -h, --help         show this help message and exit
  --no-typedefs      do not generate extern types for C typedefs
  --debug            enable debugging output
  --no-fake-headers  do not use fake headers included with c2chapel
  --no-comments      instruct c2chapel to not generate comments
  -V, --version      show program&#39;s version number and exit
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">c2chapel</span></code> by default uses the fake standard headers included with pycparser.
These are headers used to work around compiler-specific macros or attributes
often found in C standard headers. Without these fake headers, pycparser will
probably not be able to parse the given C99 file. Usage of these fake headers
can be disabled with the <code class="docutils literal notranslate"><span class="pre">--no-fake-headers</span></code> flag. You can extend the fake
headers by modifying <code class="docutils literal notranslate"><span class="pre">tools/c2chapel/utils/custom.h</span></code>.</p>
</div>
<div class="section" id="future-work">
<h2>Future Work<a class="headerlink" href="#future-work" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">c2chapel</span></code> does not currently handle the entirety of C99, so some human
intervention may be required (e.g. commenting out unhandled portions of the
file). There are also some limitations based on Chapel’s extern capability.
See <a class="reference external" href="https://chapel-lang.org/bugs.html">https://chapel-lang.org/bugs.html</a> for instructions on reporting bugs.</p>
<p>Known issues:</p>
<ul class="simple">
<li><p>fake standard headers are incomplete</p></li>
<li><p>choice between <code class="docutils literal notranslate"><span class="pre">ref</span></code>/<code class="docutils literal notranslate"><span class="pre">c_ptr</span></code> for formals is not intuitive or easily controlled</p></li>
</ul>
</div>
<div class="section" id="contributors">
<h2>Contributors<a class="headerlink" href="#contributors" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">Ben Harshbarger [HPE]</div>
<div class="line">Nikhil Padmanabhan [Yale University]</div>
<div class="line"><br /></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../chpldoc/chpldoc.html" class="btn btn-neutral float-right" title="chpldoc" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral float-left" title="Tools" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Hewlett Packard Enterprise Development LP

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 



</body>
</html>