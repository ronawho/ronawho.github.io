

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Crypto &mdash; Chapel Documentation 1.23</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="C_OpenSSL" href="Crypto/C_OpenSSL.html" />
    <link rel="prev" title="Collection" href="Collection.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

<a href="../../index.html" class="icon icon-home"> Chapel Documentation

<!-- display version if button won't be rendered -->
<?php if (false) { ?>
<br>1.23
<?php } ?>

</a>

<?php
// Variables given by sphinx
$chplTitle = "1.23";
$pagename = "modules/packages/Crypto";
include "../..//versionButton.php";
?>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Compiling and Running Chapel</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../usingchapel/QUICKSTART.html">Quickstart Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usingchapel/index.html">Using Chapel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../platforms/index.html">Platform-Specific Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../technotes/index.html">Technical Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">Tools</a></li>
</ul>
<p class="caption"><span class="caption-text">Writing Chapel Programs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../language/reference.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Hello World Variants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../primers/index.html">Primers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../language/spec/index.html">Language Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../builtins/index.html">Built-in Types and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../standard.html">Standard Modules</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../packages.html">Package Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="AllLocalesBarriers.html">AllLocalesBarriers</a></li>
<li class="toctree-l2"><a class="reference internal" href="AtomicObjects.html">AtomicObjects</a></li>
<li class="toctree-l2"><a class="reference internal" href="BLAS.html">BLAS</a></li>
<li class="toctree-l2"><a class="reference internal" href="Buffers.html">Buffers</a></li>
<li class="toctree-l2"><a class="reference internal" href="Collection.html">Collection</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Crypto</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Crypto/C_OpenSSL.html">C_OpenSSL</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compiling-with-crypto">Compiling with Crypto</a></li>
<li class="toctree-l3"><a class="reference internal" href="#chapel-crypto-api">Chapel Crypto API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Curl.html">Curl</a></li>
<li class="toctree-l2"><a class="reference internal" href="DistributedBag.html">DistributedBag</a></li>
<li class="toctree-l2"><a class="reference internal" href="DistributedDeque.html">DistributedDeque</a></li>
<li class="toctree-l2"><a class="reference internal" href="DistributedIters.html">DistributedIters</a></li>
<li class="toctree-l2"><a class="reference internal" href="EpochManager.html">EpochManager</a></li>
<li class="toctree-l2"><a class="reference internal" href="FFTW.html">FFTW</a></li>
<li class="toctree-l2"><a class="reference internal" href="FunctionalOperations.html">FunctionalOperations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Futures.html">Futures</a></li>
<li class="toctree-l2"><a class="reference internal" href="HDF5.html">HDF5</a></li>
<li class="toctree-l2"><a class="reference internal" href="HDFS.html">HDFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="LAPACK.html">LAPACK</a></li>
<li class="toctree-l2"><a class="reference internal" href="LinearAlgebra.html">LinearAlgebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="LockFreeQueue.html">LockFreeQueue</a></li>
<li class="toctree-l2"><a class="reference internal" href="LockFreeStack.html">LockFreeStack</a></li>
<li class="toctree-l2"><a class="reference internal" href="MPI.html">MPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="NetCDF.html">NetCDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="Norm.html">Norm</a></li>
<li class="toctree-l2"><a class="reference internal" href="OrderedSet.html">OrderedSet</a></li>
<li class="toctree-l2"><a class="reference internal" href="PeekPoke.html">PeekPoke</a></li>
<li class="toctree-l2"><a class="reference internal" href="RangeChunk.html">RangeChunk</a></li>
<li class="toctree-l2"><a class="reference internal" href="RecordParser.html">RecordParser</a></li>
<li class="toctree-l2"><a class="reference internal" href="ReplicatedVar.html">ReplicatedVar</a></li>
<li class="toctree-l2"><a class="reference internal" href="Search.html">Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="Sort.html">Sort</a></li>
<li class="toctree-l2"><a class="reference internal" href="TOML.html">TOML</a></li>
<li class="toctree-l2"><a class="reference internal" href="URL.html">URL</a></li>
<li class="toctree-l2"><a class="reference internal" href="UnitTest.html">UnitTest</a></li>
<li class="toctree-l2"><a class="reference internal" href="UnorderedAtomics.html">UnorderedAtomics</a></li>
<li class="toctree-l2"><a class="reference internal" href="UnorderedCopy.html">UnorderedCopy</a></li>
<li class="toctree-l2"><a class="reference internal" href="VisualDebug.html">VisualDebug</a></li>
<li class="toctree-l2"><a class="reference internal" href="ZMQ.html">ZMQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../packages.html#index">Index</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../layoutdist.html">Standard Layouts and Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users-guide/index.html">Chapel Users Guide (WIP)</a></li>
</ul>
<p class="caption"><span class="caption-text">Language History</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../language/evolution.html">Chapel Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../language/archivedSpecs.html">Documentation Archives</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Chapel Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../packages.html">Package Modules</a> &raquo;</li>
        
      <li>Crypto</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/modules/packages/Crypto.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="module-Crypto"></span><div class="section" id="crypto">
<h1>Crypto<a class="headerlink" href="#crypto" title="Permalink to this headline">¶</a></h1>
<p><strong>Usage</strong></p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Crypto</span><span class="p">;</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">import</span> <span class="nx">Crypto</span><span class="p">;</span>
</pre></div>
</div>
<p><strong>Submodules</strong></p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="Crypto/C_OpenSSL.html">C_OpenSSL</a></li>
</ul>
</div>
<p>A cryptographic library based on <a class="reference external" href="https://www.openssl.org/">OpenSSL</a>, targeted at
flexible encryption purposes.</p>
<p>The Crypto module focuses on providing various cryptographic utilities such as</p>
<ul class="simple">
<li>Symmetric Ciphers<ul>
<li><a class="reference internal" href="#Crypto.AES" title="Crypto.AES"><code class="xref chpl chpl-class docutils literal notranslate"><span class="pre">AES</span></code></a></li>
<li><a class="reference internal" href="#Crypto.Blowfish" title="Crypto.Blowfish"><code class="xref chpl chpl-class docutils literal notranslate"><span class="pre">Blowfish</span></code></a></li>
</ul>
</li>
<li>Asymmetric Ciphers<ul>
<li><a class="reference internal" href="#Crypto.RSA" title="Crypto.RSA"><code class="xref chpl chpl-class docutils literal notranslate"><span class="pre">RSA</span></code></a></li>
</ul>
</li>
<li>Hashing Functions<ul>
<li><a class="reference internal" href="#Crypto.Hash" title="Crypto.Hash"><code class="xref chpl chpl-class docutils literal notranslate"><span class="pre">Hash</span></code></a></li>
</ul>
</li>
<li>Key Derivation Functions<ul>
<li><a class="reference internal" href="#Crypto.KDF" title="Crypto.KDF"><code class="xref chpl chpl-class docutils literal notranslate"><span class="pre">KDF</span></code></a></li>
</ul>
</li>
<li>Cryptographically-Secure Pseudo-Random Number Generators<ul>
<li><a class="reference internal" href="#Crypto.CryptoRandom" title="Crypto.CryptoRandom"><code class="xref chpl chpl-class docutils literal notranslate"><span class="pre">CryptoRandom</span></code></a></li>
</ul>
</li>
<li>Miscellaneous Utilities.<ul>
<li><a class="reference internal" href="#Crypto.CryptoBuffer" title="Crypto.CryptoBuffer"><code class="xref chpl chpl-class docutils literal notranslate"><span class="pre">CryptoBuffer</span></code></a></li>
<li><a class="reference internal" href="#Crypto.RSAKey" title="Crypto.RSAKey"><code class="xref chpl chpl-class docutils literal notranslate"><span class="pre">RSAKey</span></code></a></li>
<li><a class="reference internal" href="#Crypto.Envelope" title="Crypto.Envelope"><code class="xref chpl chpl-class docutils literal notranslate"><span class="pre">Envelope</span></code></a></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This module is currently under development and will expand significantly
in upcoming releases.</p>
</div>
<div class="section" id="compiling-with-crypto">
<h2>Compiling with Crypto<a class="headerlink" href="#compiling-with-crypto" title="Permalink to this headline">¶</a></h2>
<p>In order to compile a Chapel program that uses this module, the
Crypto and C_OpenSSL (C wrappers to OpenSSL) libraries must be installed on the system.
The paths to both the <code class="docutils literal notranslate"><span class="pre">openssl/&lt;module&gt;.h</span></code> header files and OpenSSL library
must be passed to the <code class="docutils literal notranslate"><span class="pre">-I</span></code> and <code class="docutils literal notranslate"><span class="pre">-L</span></code> compiler arguments. The library name,
typically <code class="docutils literal notranslate"><span class="pre">crypto</span></code>, must be passed to the <code class="docutils literal notranslate"><span class="pre">-l</span></code> argument as well.</p>
<p>The compilation command should look something like this:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>chpl -I<span class="nv">$PATH_TO_OPENSSL_DIR</span> <span class="se">\</span>
     -L<span class="nv">$PATH_TO_OPENSSL_LIBS</span> -lcrypto source.chpl
</pre></div>
</div>
<p>This would also work by setting the <code class="docutils literal notranslate"><span class="pre">LDFLAGS</span></code> and <code class="docutils literal notranslate"><span class="pre">CPPFLAGS</span></code> environment
variables to the expected paths on certain systems.</p>
</div>
<div class="section" id="chapel-crypto-api">
<h2>Chapel Crypto API<a class="headerlink" href="#chapel-crypto-api" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="Crypto.CryptoBuffer">
<em class="property">class </em><code class="descname">CryptoBuffer</code><a class="headerlink" href="#Crypto.CryptoBuffer" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>CryptoBuffer</cite> class is a wrapper around the internal representation
of how the values in this library are stored. Every sequence of bytes going
into a Crypto utility or coming out of it, is a <cite>CryptoBuffer</cite>.</p>
<p>A <cite>CryptoBuffer</cite> can enclose a <cite>string</cite> or a <cite>[] uint(8)</cite> passed to its
initializer and provides helper functions to access those values.</p>
<dl class="method">
<dt id="Crypto.CryptoBuffer.init">
<em class="property">proc </em><code class="descname">init</code><span class="sig-paren">(</span><em>s: string</em><span class="sig-paren">)</span><a class="headerlink" href="#Crypto.CryptoBuffer.init" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>CryptoBuffer</cite> class initializer that initializes the buffer
when a <cite>string</cite> is supplied to it.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><strong>s</strong> : <cite>string</cite> – <cite>string</cite> input for buffer conversion.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An object of class <cite>CryptoBuffer</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><cite>CryptoBuffer</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<em class="property">proc </em><code class="descname">init</code><span class="sig-paren">(</span><em>s: [] uint(8)</em><span class="sig-paren">)</span></dt>
<dd><p>The <cite>CryptoBuffer</cite> class initializer that initializes the buffer
when a <cite>[] uint(8)</cite> is supplied to it.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><strong>s</strong> : <cite>[] uint(8)</cite> – <cite>[] uint(8)</cite> input for buffer conversion.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An object of class <cite>CryptoBuffer</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><cite>CryptoBuffer</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Crypto.CryptoBuffer.getBuffData">
<em class="property">proc </em><code class="descname">getBuffData</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Crypto.CryptoBuffer.getBuffData" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the entire internal buffer with each byte in ASCII.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the internal buffer representation.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><cite>[] uint(8)</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Crypto.CryptoBuffer.getBuffPtr">
<em class="property">proc </em><code class="descname">getBuffPtr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Crypto.CryptoBuffer.getBuffPtr" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the pointer to the entire internal buffer with
each byte in ASCII.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">pointer to the internal buffer representation.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><cite>c_ptr([] uint(8))</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Crypto.CryptoBuffer.getBuffSize">
<em class="property">proc </em><code class="descname">getBuffSize</code><span class="sig-paren">(</span><span class="sig-paren">)</span>: int<a class="headerlink" href="#Crypto.CryptoBuffer.getBuffSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the length of the entire internal buffer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">length of the internal buffer representation.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><cite>int</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Crypto.CryptoBuffer.toHex">
<em class="property">proc </em><code class="descname">toHex</code><span class="sig-paren">(</span><span class="sig-paren">)</span> throws<a class="headerlink" href="#Crypto.CryptoBuffer.toHex" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the hexadecimal array representation of the entire internal buffer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">hex array representation of the internal buffer.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><cite>[] string</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Crypto.CryptoBuffer.toHexString">
<em class="property">proc </em><code class="descname">toHexString</code><span class="sig-paren">(</span><span class="sig-paren">)</span> throws<a class="headerlink" href="#Crypto.CryptoBuffer.toHexString" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the hexadecimal string representation of the entire internal buffer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">hex string representation of the internal buffer.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><cite>string</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="Crypto.RSAKey">
<em class="property">class </em><code class="descname">RSAKey</code><a class="headerlink" href="#Crypto.RSAKey" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>RSAKey</cite> class encloses the <cite>EVP_PKEY</cite> object provided by the
OpenSSL primitives. The <cite>EVP_PKEY</cite> object can contain the public key,
private key or both of them. Hence, the contents of an object of the
class <cite>RSAKey</cite> may be decided by the user.</p>
<p>Calling the <cite>RSAKey</cite> initializer without using any key import or export
functions may result in generation of a single object that contains both the
keys (public and private).</p>
<p>In order to separate out the key objects, keys can be imported
from a <cite>.pem</cite> file. (TODO)</p>
<dl class="method">
<dt id="Crypto.RSAKey.init">
<em class="property">proc </em><code class="descname">init</code><span class="sig-paren">(</span><em>keyLen: int</em><span class="sig-paren">)</span><a class="headerlink" href="#Crypto.RSAKey.init" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>RSAKey</cite> class initializer that initializes the <cite>EVP_PKEY</cite> object
of OpenSSL and basically, initializes a set of public and private keys.</p>
<p>It checks for valid RSA key lengths and generates a public key and private
key pair accordingly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><strong>keyLen</strong> : <cite>int</cite> – RSA Key length in bits.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An object of class <cite>RSAKey</cite> representing the key pair.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><cite>RSAKey</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="Crypto.Envelope">
<em class="property">class </em><code class="descname">Envelope</code><a class="headerlink" href="#Crypto.Envelope" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>Envelope</cite> class wraps all the data returned by the encrypt function
of the <cite>RSA</cite> class along with some utility data. An <cite>RSA</cite> encrypt function
returns an array of <cite>RSA</cite> encrypted symmetric keys and a single <cite>AES</cite>
encrypted message. The <cite>Envelope</cite> also encloses the initialization vector
used during encryption such that it can be utilized during the decryption
phase as well.</p>
<dl class="method">
<dt id="Crypto.Envelope.init">
<em class="property">proc </em><code class="descname">init</code><span class="sig-paren">(</span><em>iv: owned CryptoBuffer</em>, <em>encSymmKey: [] owned CryptoBuffer</em>, <em>encSymmValue: owned CryptoBuffer</em><span class="sig-paren">)</span><a class="headerlink" href="#Crypto.Envelope.init" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>Envelope</cite> class initializer that encapsulates the IV, AES encrypted
ciphertext buffer and an array of encrypted key buffers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>iv</strong> : <cite>owned CryptoBuffer</cite> – Initialization Vector.</li>
<li><strong>encSymmKey</strong> : <cite>[] owned CryptoBuffer</cite> – Array of encrypted symmetric (AES) keys.</li>
<li><strong>encSymmValue</strong> : <cite>owned CryptoBuffer</cite> – AES-encrypted ciphertext buffer.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An object of class <cite>Envelope</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><cite>Envelope</cite></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Crypto.Envelope.getEncMessage">
<em class="property">proc </em><code class="descname">getEncMessage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Crypto.Envelope.getEncMessage" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns the encrypted version of the plaintext
supplied by the user.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A ‘CryptoBuffer’ representing the ciphertext.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><cite>CryptoBuffer</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Crypto.Envelope.getIV">
<em class="property">proc </em><code class="descname">getIV</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Crypto.Envelope.getIV" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns the IV generated by the <cite>encrypt</cite> routine and
encapsulated in the <cite>Envelope</cite>. This is used for both encryption and
decryption.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Initialization Vector.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><cite>CryptoBuffer</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Crypto.Envelope.getEncKeyByIndex">
<em class="property">proc </em><code class="descname">getEncKeyByIndex</code><span class="sig-paren">(</span><em>i: int</em><span class="sig-paren">)</span><a class="headerlink" href="#Crypto.Envelope.getEncKeyByIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns a particular symmetric key buffer based
on the index supplied as the argument.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The supplied index should be in the domain of the RSA-encrypted keys array.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><strong>i</strong> : <cite>int</cite> – An index of the symmetric key buffer array.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A specific key buffer based on the index.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><cite>CryptoBuffer</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Crypto.Envelope.getEncKeys">
<em class="property">proc </em><code class="descname">getEncKeys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Crypto.Envelope.getEncKeys" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns the entire array of symmetric key buffers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Entire array of key buffers.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><cite>[] CryptoBuffer</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="enum">
<dt id="Crypto.Digest">
<em class="property">enum </em><code class="descname">Digest</code> { MD5, SHA1, SHA224, SHA256, SHA384, SHA512, RIPEMD160 }<a class="headerlink" href="#Crypto.Digest" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>Digest</cite> enum represents all the hashing functions provided by the
OpenSSL primitives. Value from this enum is passed to the <cite>Hash</cite> class
initializer in order to select the type of hashing function to be used.</p>
</dd></dl>

<dl class="class">
<dt id="Crypto.Hash">
<em class="property">class </em><code class="descname">Hash</code><a class="headerlink" href="#Crypto.Hash" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>Hash</cite> class represents all the hashing functions provided by the
OpenSSL primitives. It supports all the prominent and most commonly used
deterministic hashing functions.</p>
<dl class="method">
<dt id="Crypto.Hash.init">
<em class="property">proc </em><code class="descname">init</code><span class="sig-paren">(</span><em>digestName: Digest</em><span class="sig-paren">)</span><a class="headerlink" href="#Crypto.Hash.init" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>Hash</cite> class initializer that initializes the hashing function
to be used. This initializer sets the byte length of the
respective hash and allocates a domain for memory allocation
for hashing. It currently supports the following hashing functions -
<code class="docutils literal notranslate"><span class="pre">MD5</span></code>, <code class="docutils literal notranslate"><span class="pre">SHA1</span></code>, <code class="docutils literal notranslate"><span class="pre">SHA224</span></code>, <code class="docutils literal notranslate"><span class="pre">SHA256</span></code>, <code class="docutils literal notranslate"><span class="pre">SHA384</span></code>, <code class="docutils literal notranslate"><span class="pre">SHA512</span></code> and
<code class="docutils literal notranslate"><span class="pre">RIPEMD160</span></code> consumed via an enum, <cite>Digest</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><strong>digestName</strong> : <cite>Digest</cite> – Hashing function to be used.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An object of class <cite>Hash</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><cite>Hash</cite></td>
</tr>
</tbody>
</table>
<p>Initialization example,</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">h</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Hash</span><span class="p">(</span><span class="nx">Digest</span><span class="p">.</span><span class="nx">SHA256</span><span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Crypto.Hash.getDigestName">
<em class="property">proc </em><code class="descname">getDigestName</code><span class="sig-paren">(</span><span class="sig-paren">)</span>: string<a class="headerlink" href="#Crypto.Hash.getDigestName" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of the hashing function used. For instance,
instantiating an object with <code class="docutils literal notranslate"><span class="pre">var</span> <span class="pre">hash</span> <span class="pre">=</span> <span class="pre">new</span> <span class="pre">Hash(&quot;SHA256&quot;)</span></code>,
would make this function return the string <cite>SHA256</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Name of the hashing function.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><cite>string</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Crypto.Hash.getDigest">
<em class="property">proc </em><code class="descname">getDigest</code><span class="sig-paren">(</span><em>inputBuffer: CryptoBuffer</em><span class="sig-paren">)</span>: owned CryptoBuffer<a class="headerlink" href="#Crypto.Hash.getDigest" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a CryptoBuffer (buffer) as input, this function returns it’s
hash digest. The returned hash digest is also a buffer that can be
accessed by using buffer utility functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><strong>inputBuffer</strong> : <cite>CryptoBuffer</cite> – A <cite>CryptoBuffer</cite> representing the input to be hashed.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An <cite>owned CryptoBuffer</cite> representing the hash digest.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><cite>owned CryptoBuffer</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="enum">
<dt id="Crypto.CryptoChainMode">
<em class="property">enum </em><code class="descname">CryptoChainMode</code> { cbc, ecb, cfb, ofb }<a class="headerlink" href="#Crypto.CryptoChainMode" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>CryptoChainMode</cite> enum represents all cipher chaining modes
that can be used by a symmetric cipher. It is used by the <cite>AES</cite> and
<cite>Blowfish</cite> class initializers to select a chaining mode.</p>
</dd></dl>

<dl class="class">
<dt id="Crypto.AES">
<em class="property">class </em><code class="descname">AES</code><a class="headerlink" href="#Crypto.AES" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>AES</cite> class represents the symmetric encryption algorithm, AES.
The Advanced Encryption Standard (AES), also known by its original name Rijndael
is a specification for the encryption of electronic data established by the
U.S. National Institute of Standards and Technology (NIST) in 2001.</p>
<p>It is the most widely used symmetric cipher and is also used to encrypt
messages in public-key cryptography such as within <cite>RSA</cite>.</p>
<p>Currently, the <cite>AES</cite> class allows symmetric encryption using only the CBC or
Cipher Block Chaining mode in 128, 192, and 256 key size variants.</p>
<p>After thorough testing, ECB, OCB and other chaining mode variants will also
be added to this library(TODO).</p>
<dl class="method">
<dt id="Crypto.AES.init">
<em class="property">proc </em><code class="descname">init</code><span class="sig-paren">(</span><em>bits: int</em>, <em>mode: CryptoChainMode</em><span class="sig-paren">)</span><a class="headerlink" href="#Crypto.AES.init" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>AES</cite> class initializer that initializes the AES encryption
algorithm with the right key length and chaining mode.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>bits</strong> : <cite>int</cite> – Number of bits representing the variant of AES based on
key-size. (128, 192 or 256)</li>
<li><strong>mode</strong> : <cite>CryptoChainMode</cite> – Chaining mode to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An object of class <cite>AES</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><cite>AES</cite></p>
</td>
</tr>
</tbody>
</table>
<p>Initialization example,</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">aes</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AES</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="nx">CryptoChainMode</span><span class="p">.</span><span class="nx">cbc</span><span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Crypto.AES.getByteSize">
<em class="property">proc </em><code class="descname">getByteSize</code><span class="sig-paren">(</span><span class="sig-paren">)</span>: int<a class="headerlink" href="#Crypto.AES.getByteSize" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns the size in bytes of the key-length/variant of
AES which is to be used. For instance,</p>
<ul class="simple">
<li>AES128 returns 16</li>
<li>AES192 returns 24</li>
<li>AES256 returns 32</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Key length of AES in bytes.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><cite>int</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Crypto.AES.encrypt">
<em class="property">proc </em><code class="descname">encrypt</code><span class="sig-paren">(</span><em>plaintext: CryptoBuffer</em>, <em>key: CryptoBuffer</em>, <em>IV: CryptoBuffer</em><span class="sig-paren">)</span>: owned CryptoBuffer<a class="headerlink" href="#Crypto.AES.encrypt" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the ‘AES’ encrypt routine that encrypts the user supplied message buffer
using the key and IV.</p>
<p>The <cite>encrypt</cite> takes in the plaintext buffer, key buffer and IV buffer as the
arguments and returns a buffer of the ciphertext.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>plaintext</strong> : <cite>CryptoBuffer</cite> – A <cite>CryptoBuffer</cite> representing the plaintext to be encrypted.</li>
<li><strong>key</strong> : <cite>CryptoBuffer</cite> – A <cite>CryptoBuffer</cite> representing the key to be used for encryption.</li>
<li><strong>IV</strong> : <cite>CryptoBuffer</cite> – A <cite>CryptoBuffer</cite> representing the initialization vector to be used
for encryption.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An <cite>owned CryptoBuffer</cite> representing the ciphertext.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><cite>owned CryptoBuffer</cite></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Crypto.AES.decrypt">
<em class="property">proc </em><code class="descname">decrypt</code><span class="sig-paren">(</span><em>ciphertext: CryptoBuffer</em>, <em>key: CryptoBuffer</em>, <em>IV: CryptoBuffer</em><span class="sig-paren">)</span>: owned CryptoBuffer<a class="headerlink" href="#Crypto.AES.decrypt" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the ‘AES’ decrypt routine that decrypts the user supplied ciphertext
buffer using the same key and IV used for encryption.</p>
<p>The <cite>decrypt</cite> takes in the ciphertext buffer, key buffer and IV buffer as the
arguments and returns a buffer of the decrypted plaintext.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>ciphertext</strong> : <cite>CryptoBuffer</cite> – A <cite>CryptoBuffer</cite> representing the ciphertext to be decrypted.</li>
<li><strong>key</strong> : <cite>CryptoBuffer</cite> – A <cite>CryptoBuffer</cite> representing the key to be used for decryption
(same as the one used in encryption).</li>
<li><strong>IV</strong> : <cite>CryptoBuffer</cite> – A <cite>CryptoBuffer</cite> representing the initialization vector to be used
for decryption (same as the one used in encryption).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An <cite>owned CryptoBuffer</cite> representing the obtained plaintext.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><cite>owned CryptoBuffer</cite></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="Crypto.Blowfish">
<em class="property">class </em><code class="descname">Blowfish</code><a class="headerlink" href="#Crypto.Blowfish" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>Blowfish</cite> class represents a symmetric-key block cipher called Blowfish, designed
in 1993 by Bruce Schneier. Considering current scenario, the Advanced Encryption
Standard(AES) cipher is used more in practice. Since, Blowfish is unpatented and placed
in the public domain, it receives a decent amount of attention from the community.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since the key in Blowfish can be of various sizes, use a <a class="reference internal" href="#Crypto.KDF" title="Crypto.KDF"><code class="xref chpl chpl-class docutils literal notranslate"><span class="pre">KDF</span></code></a> routine
to generate a secure-key with the recommended byte-size as 16 bytes. Also, the
initialization vector in Blowfish cipher should strictly be 8 bytes long.</p>
</div>
<p>The <cite>Blowfish</cite> class supports 4 <a class="reference external" href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">chaining modes</a>:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">cbc</span></code> or <cite>Cipher Block Chaining</cite></li>
<li><code class="docutils literal notranslate"><span class="pre">ecb</span></code> or <cite>Electronic Codebook</cite></li>
<li><code class="docutils literal notranslate"><span class="pre">cfb</span></code> or <cite>Cipher Feedback</cite></li>
<li><code class="docutils literal notranslate"><span class="pre">ofb</span></code> or <cite>Output Feedback</cite></li>
</ul>
<dl class="method">
<dt id="Crypto.Blowfish.init">
<em class="property">proc </em><code class="descname">init</code><span class="sig-paren">(</span><em>mode: CryptoChainMode</em><span class="sig-paren">)</span><a class="headerlink" href="#Crypto.Blowfish.init" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>Blowfish</cite> class initializer that initializes the Blowfish encryption
algorithm with the right key length and chaining mode.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><strong>mode</strong> : <cite>CryptoChainMode</cite> – Name of the chaining mode to be used.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An object of class <cite>Blowfish</cite>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><cite>Blowfish</cite></td>
</tr>
</tbody>
</table>
<p>Initialization example,</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">bf</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Blowfish</span><span class="p">(</span><span class="nx">CryptoChainMode</span><span class="p">.</span><span class="nx">cbc</span><span class="p">);</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Crypto.Blowfish.encrypt">
<em class="property">proc </em><code class="descname">encrypt</code><span class="sig-paren">(</span><em>plaintext: CryptoBuffer</em>, <em>key: CryptoBuffer</em>, <em>IV: CryptoBuffer</em><span class="sig-paren">)</span>: owned CryptoBuffer throws<a class="headerlink" href="#Crypto.Blowfish.encrypt" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the ‘Blowfish’ encrypt routine that encrypts the user supplied message buffer
using the key and IV.</p>
<p>The <cite>encrypt</cite> takes in the plaintext buffer, key buffer and IV buffer as the
arguments and returns a buffer of the ciphertext.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>plaintext</strong> : <cite>CryptoBuffer</cite> – A <cite>CryptoBuffer</cite> representing the plaintext to be encrypted.</li>
<li><strong>key</strong> : <cite>CryptoBuffer</cite> – A <cite>CryptoBuffer</cite> representing the key to be used for encryption.</li>
<li><strong>IV</strong> : <cite>CryptoBuffer</cite> – A <cite>CryptoBuffer</cite> representing the initialization vector to be used
for encryption.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An <cite>owned CryptoBuffer</cite> representing the ciphertext.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><cite>owned CryptoBuffer</cite></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Crypto.Blowfish.decrypt">
<em class="property">proc </em><code class="descname">decrypt</code><span class="sig-paren">(</span><em>ciphertext: CryptoBuffer</em>, <em>key: CryptoBuffer</em>, <em>IV: CryptoBuffer</em><span class="sig-paren">)</span>: owned CryptoBuffer<a class="headerlink" href="#Crypto.Blowfish.decrypt" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the ‘Blowfish’ decrypt routine that decrypts the user supplied ciphertext
buffer using the same key and IV used for encryption.</p>
<p>The <cite>decrypt</cite> takes in the ciphertext buffer, key buffer and IV buffer as the
arguments and returns a buffer of the decrypted plaintext.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>ciphertext</strong> : <cite>CryptoBuffer</cite> – A <cite>CryptoBuffer</cite> representing the ciphertext to be decrypted.</li>
<li><strong>key</strong> : <cite>CryptoBuffer</cite> – A <cite>CryptoBuffer</cite> representing the key to be used for decryption
(same as the one used in encryption).</li>
<li><strong>IV</strong> : <cite>CryptoBuffer</cite> – A <cite>CryptoBuffer</cite> representing the initialization vector to be used
for decryption (same as the one used in encryption).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An <cite>owned CryptoBuffer</cite> representing the obtained plaintext.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><cite>owned CryptoBuffer</cite></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="Crypto.CryptoRandom">
<em class="property">class </em><code class="descname">CryptoRandom</code><a class="headerlink" href="#Crypto.CryptoRandom" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>CryptoRandom</cite> class represents a CSPRNG provided by OpenSSL that
automatically does the seeding part before returning a random sequence
of bytes of the type <cite>CryptoBuffer</cite>.</p>
<p>Given the length of the buffer required by the user, it generates a random
buffer of the same size.</p>
<dl class="method">
<dt id="Crypto.CryptoRandom.getRandomBuffer">
<em class="property">proc </em><code class="descname">getRandomBuffer</code><span class="sig-paren">(</span><em>buffLen: int</em><span class="sig-paren">)</span>: owned CryptoBuffer throws<a class="headerlink" href="#Crypto.CryptoRandom.getRandomBuffer" title="Permalink to this definition">¶</a></dt>
<dd><p>This function represents a CSPRNG that generates and allocates the desired
number of random values as specified by the argument. Halts for number of
bytes less than 1 (invalid). For instance,</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="p">(</span><span class="k">new</span> <span class="nx">CryptoRandom</span><span class="p">()).</span><span class="nx">getRandomBuffer</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>would give us a <cite>CryptoBuffer</cite> of size <cite>5</cite> and pre-initialized with values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><strong>buffLen</strong> : <cite>int</cite> – Number of random values to be generated in the buffer.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">An <cite>owned CryptoBuffer</cite> representing the generated values.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><cite>owned CryptoBuffer</cite></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="Crypto.KDF">
<em class="property">class </em><code class="descname">KDF</code><a class="headerlink" href="#Crypto.KDF" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>KDF</cite> class contains the most widely used key derivation functions.
Currently it supports a single password based key derivation function which
is the most secure one as of writing this library. More KDFs will be added
to this in the future.</p>
<dl class="method">
<dt id="Crypto.KDF.init">
<em class="property">proc </em><code class="descname">init</code><span class="sig-paren">(</span><em>byteLen: int</em>, <em>iterCount: int</em>, <em>digest: Hash</em><span class="sig-paren">)</span><a class="headerlink" href="#Crypto.KDF.init" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>KDF</cite> class initializer that initializes the common data used by most
of the Key Derivation Functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>byteLen</strong> : <cite>int</cite> – Size of the expected key in bytes / key length.</li>
<li><strong>iterCount</strong> : <cite>int</cite> – The iteration count used by OpenSSL to repeat the <cite>Update</cite>
primitive. Min. recommended value = 1000. Greater the
<cite>iterCount</cite>, greater the security of the key.</li>
<li><strong>digest</strong> : <cite>Hash</cite> – An object of class ‘Hash’. This decides the Hashing function
to be used for HMAC based KDFs.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An object of class <cite>KDF</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><cite>KDF</cite></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Crypto.KDF.passKDF">
<em class="property">proc </em><code class="descname">passKDF</code><span class="sig-paren">(</span><em>userKey: string</em>, <em>saltBuff: CryptoBuffer</em><span class="sig-paren">)</span>: owned CryptoBuffer<a class="headerlink" href="#Crypto.KDF.passKDF" title="Permalink to this definition">¶</a></dt>
<dd><p>This function represents Password-Based KDF 2. It generates a secure-key
buffer based on the salt and also on the metadata provided in the <cite>KDF</cite>
initializer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>userKey</strong> : <cite>string</cite> – User-specified <cite>string</cite> representation of the key.</li>
<li><strong>saltBuff</strong> : <cite>CryptoBuffer</cite> – A <cite>CryptoBuffer</cite> representing the user generated salt.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An <cite>owned CryptoBuffer</cite> representing the generated key.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><cite>owned CryptoBuffer</cite></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="Crypto.RSA">
<em class="property">class </em><code class="descname">RSA</code><a class="headerlink" href="#Crypto.RSA" title="Permalink to this definition">¶</a></dt>
<dd><p>RSA is one of the first practical public-key cryptosystems and is widely
used for secure data transmission. A user of the <cite>RSA</cite> first generates the
public and private keys using the <cite>RSAKey</cite> class. The <cite>RSAKey</cite> object is
then passed to the <cite>RSA</cite> functions for further encryption and decryption
purposes.</p>
<p>The <cite>encrypt</cite> function of this class takes in an array of <cite>RSAKey</cite> objects
and uses all of them to perform the encryption.</p>
<p>Similarly, decryption can be done individually performed (without passing an array
as an argument) by passing a single <cite>RSAKey</cite> object every time the decryption takes place.</p>
<dl class="method">
<dt id="Crypto.RSA.encrypt">
<em class="property">proc </em><code class="descname">encrypt</code><span class="sig-paren">(</span><em>plaintext: CryptoBuffer</em>, <em>keys: [] RSAKey</em><span class="sig-paren">)</span>: owned Envelope<a class="headerlink" href="#Crypto.RSA.encrypt" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the ‘RSA’ encrypt routine that encrypts the plaintext buffer. This
uses the <cite>AES</cite> encryption algorithm to encrypt the plaintext and auto-generates
a secure IV and key. Furthermore, the key is encrypted using <cite>RSA</cite> based on the
‘RSAKey’ objects supplied in the arguments.</p>
<p>The function returns an <cite>Envelope</cite> object that encloses the auto-generated
IV, AES encrypted ciphertext and an array of <cite>RSA</cite> encrypted key buffers.
The number of encrypted keys is equal to the number of <cite>RSAKey</cite> objects
in the array. This kind of use case is useful specifically in developing
one-to-many systems such as GPG.</p>
<p>For instance, consider a server-client model where the server performs
encryption using the public keys of all the clients and returns an <cite>Envelope</cite>
to each client. Now, the decryption can only be performed by each client
using only their own private key.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>plaintext</strong> : <cite>CryptoBuffer</cite> – A <cite>CryptoBuffer</cite> representing the plaintext to be
encrypted.</li>
<li><strong>keys</strong> : <cite>[] RSAKey</cite> – An array of <cite>RSAKey</cite> objects. This depends on the number of
different RSA encryptions that are to be performed on the same
plaintext.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An <cite>owned Envelope</cite> object which comprises of the IV buffer,
array of RSA encrypted keys and AES encrypted ciphertext.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><cite>owned Envelope</cite></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Crypto.RSA.decrypt">
<em class="property">proc </em><code class="descname">decrypt</code><span class="sig-paren">(</span><em>envp: Envelope</em>, <em>key: RSAKey</em><span class="sig-paren">)</span>: owned CryptoBuffer throws<a class="headerlink" href="#Crypto.RSA.decrypt" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the ‘RSA’ decrypt routine that decrypts the ciphertext buffer. This
uses <cite>AES</cite> decryption to decrypt the ciphertext.</p>
<p>It accepts the entire <cite>Envelope</cite> object but only a single <cite>RSAKey</cite> object
for unilateral decryption.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first simple">
<li><strong>envp</strong> : <cite>Envelope</cite> – A <cite>CryptoBuffer</cite> representing the plaintext to be
encrypted.</li>
<li><strong>key</strong> : <cite>RSAKey</cite> – An array of <cite>RSAKey</cite> objects. This depends on the number of
different RSA encryptions that are to be performed on the same
plaintext.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An <cite>owned CryptoBuffer</cite> representing the obtained plaintext.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><cite>owned CryptoBuffer</cite></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Crypto/C_OpenSSL.html" class="btn btn-neutral float-right" title="C_OpenSSL" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Collection.html" class="btn btn-neutral float-left" title="Collection" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Hewlett Packard Enterprise Development LP

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 



</body>
</html>