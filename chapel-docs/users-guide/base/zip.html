

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Zippered Iteration &mdash; Chapel Documentation 1.23</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Task Parallelism Overview" href="../taskpar/taskParallelismOverview.html" />
    <link rel="prev" title="for-loops: structured serial iteration" href="forloops.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

<a href="../../index.html" class="icon icon-home"> Chapel Documentation

<!-- display version if button won't be rendered -->
<?php if (false) { ?>
<br>1.23
<?php } ?>

</a>

<?php
// Variables given by sphinx
$chplTitle = "1.23";
$pagename = "users-guide/base/zip";
include "../..//versionButton.php";
?>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Compiling and Running Chapel</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../usingchapel/QUICKSTART.html">Quickstart Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usingchapel/index.html">Using Chapel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../platforms/index.html">Platform-Specific Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../technotes/index.html">Technical Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">Tools</a></li>
</ul>
<p class="caption"><span class="caption-text">Writing Chapel Programs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../language/reference.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Hello World Variants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../primers/index.html">Primers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../language/spec/index.html">Language Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../builtins/index.html">Built-in Types and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/standard.html">Standard Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/packages.html">Package Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/layoutdist.html">Standard Layouts and Distributions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Chapel Users Guide (WIP)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#overview">Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#base-language">Base Language</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="hello.html">Hello world: simple console output</a></li>
<li class="toctree-l3"><a class="reference internal" href="vars.html">Variable Declarations</a></li>
<li class="toctree-l3"><a class="reference internal" href="basicTypes.html">Basic Types: booleans, numbers, and strings</a></li>
<li class="toctree-l3"><a class="reference internal" href="basicValues.html">Literal Values for Basic Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="constParam.html">Constant Declarations</a></li>
<li class="toctree-l3"><a class="reference internal" href="typeAliases.html">Type Aliases</a></li>
<li class="toctree-l3"><a class="reference internal" href="configs.html"><strong>config</strong> Declarations: command-line overrides</a></li>
<li class="toctree-l3"><a class="reference internal" href="casts.html">Casts: explicit type conversions</a></li>
<li class="toctree-l3"><a class="reference internal" href="forloops.html"><strong>for</strong>-loops: structured serial iteration</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Zippered Iteration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#index-variables-for-zippered-iteration">Index Variables for Zippered Iteration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#zippered-iterand-size-matching">Zippered Iterand Size Matching</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#task-parallelism">Task Parallelism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#data-parallelism">Data Parallelism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#locality">Locality</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Language History</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../language/evolution.html">Chapel Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../language/archivedSpecs.html">Documentation Archives</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Chapel Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Chapel Users Guide (WIP)</a> &raquo;</li>
        
      <li>Zippered Iteration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/users-guide/base/zip.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="zippered-iteration">
<span id="ug-zip"></span><h1>Zippered Iteration<a class="headerlink" href="#zippered-iteration" title="Permalink to this headline">¶</a></h1>
<p>Chapel’s <a class="reference internal" href="forloops.html#ug-forloops"><span class="std std-ref">for-loops</span></a> (and their parallel
counterparts, <a class="reference internal" href="../taskpar/coforall.html#ug-coforall"><span class="std std-ref">coforall</span></a> and <a class="reference internal" href="../datapar/forall.html#ug-forall"><span class="std std-ref">forall</span></a>) can be driven by multiple iterands in a coordinated
manner known as <em>zippered iteration</em>.  This is expressed using the
<code class="docutils literal notranslate"><span class="pre">zip</span></code> keyword, followed by a parenthesized list of the iterands.</p>
<p>As a simple example, the following loop iterates over an array and a
range simultaneously, referring to the values yielded by each using
distinct index variables, <em>a</em> and <em>i</em>:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">examples/users-guide/base/zip.chpl</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">A</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="o">..</span><span class="mi">5</span><span class="p">]</span> <span class="kt">real</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="kd">in</span> <span class="k">zip</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span> <span class="mi">1</span><span class="o">..</span><span class="mi">5</span><span class="p">)</span> <span class="k">do</span>
  <span class="nx">a</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
</pre></div>
</div>
</div>
<p>As the name suggests, zippered iteration causes the loop body to be
executed once per corresponding set of values yielded by the iterands.
Thus, in the first iteration of the loop above, <em>a</em> will refer to the
first element of <em>A</em> and <em>i</em> to 1; in the second, <em>a</em> refers to <em>A</em>’s
second element and <em>i</em> to 2; etc.  For this reason, zippered iterands
must typically have the same size (<em>i.e.,</em> yield the same number of
things), though we’ll discuss exceptional cases below.</p>
<p>As a result of this behavior, printing the array after this loop has
executed will result in:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>1.0 2.0 3.0 4.0 5.0
</pre></div>
</div>
<p>Naturally, zippering may involve more than two iterands:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">)</span> <span class="kd">in</span> <span class="k">zip</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span> <span class="mi">1</span><span class="o">..</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span> <span class="k">do</span>
  <span class="nx">a</span> <span class="o">=</span> <span class="nx">i</span><span class="o">**</span><span class="nx">j</span><span class="p">;</span>
</pre></div>
</div>
<p>Here, the array ends up as:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>1.0 1.0 3.0 16.0 625.0
</pre></div>
</div>
<div class="section" id="index-variables-for-zippered-iteration">
<h2>Index Variables for Zippered Iteration<a class="headerlink" href="#index-variables-for-zippered-iteration" title="Permalink to this headline">¶</a></h2>
<p>In the example above, we captured the results of the zippering using
an index variable per iterand.  Zippered iterations can also be
written using a single index variable which will store a tuple of the
iterands’ values:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="nx">tpl</span> <span class="kd">in</span> <span class="k">zip</span><span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span> <span class="k">do</span>
  <span class="nx">writeln</span><span class="p">(</span><span class="nx">tpl</span><span class="p">);</span>
</pre></div>
</div>
<p>The output of this loop is:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(1, 3)
(2, 0)
(3, 1)
(4, 2)
(5, 4)
</pre></div>
</div>
<p>In fact, the original case can be thought of as de-tupling the
zippered index variable in-place, as is permitted in other declaration
contexts.  Taking this notion further, the following loops show three
ways of decomposing the index variable for a zippered iteration over a
range and an array of 2-tuples:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="nx">ind</span> <span class="kd">in</span> <span class="k">zip</span><span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">3</span><span class="p">,</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">)])</span> <span class="k">do</span>
  <span class="nx">writeln</span><span class="p">(</span><span class="s">&quot;ind is &quot;</span><span class="p">,</span> <span class="nx">ind</span><span class="p">);</span>

<span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">)</span> <span class="kd">in</span> <span class="k">zip</span><span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">3</span><span class="p">,</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">)])</span> <span class="k">do</span>
  <span class="nx">writeln</span><span class="p">(</span><span class="s">&quot;i is &quot;</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="s">&quot;, j is &quot;</span><span class="p">,</span> <span class="nx">j</span><span class="p">);</span>

<span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="p">(</span><span class="nx">j</span><span class="p">,</span><span class="nx">k</span><span class="p">))</span> <span class="kd">in</span> <span class="k">zip</span><span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">3</span><span class="p">,</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">)])</span> <span class="k">do</span>
  <span class="nx">writeln</span><span class="p">(</span><span class="s">&quot;i is &quot;</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="s">&quot;, j is &quot;</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="s">&quot;, k is &quot;</span><span class="p">,</span> <span class="nx">k</span><span class="p">);</span>
</pre></div>
</div>
<p>The output of these loops is as follows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ind is (1, (0, 2))
ind is (2, (3, 7))
ind is (3, (5, 9))

i is 1, j is (0, 2)
i is 2, j is (3, 7)
i is 3, j is (5, 9)

i is 1, j is 0, k is 2
i is 2, j is 3, k is 7
i is 3, j is 5, k is 9
</pre></div>
</div>
<p>As in other de-tupling contexts, this also means that if an iterand’s
results are not needed, an underscore can be used to drop its values
on the floor:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="nx">_</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="kd">in</span> <span class="k">zip</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span> <span class="mi">1</span><span class="o">..</span><span class="p">)</span> <span class="k">do</span>
  <span class="nx">writeln</span><span class="p">(</span><span class="s">&quot;A has at least &quot;</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="s">&quot; element(s)!&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>As with non-zippered for-loops, if none of the iterands’ results are
needed, the entire <code class="docutils literal notranslate"><span class="pre">in</span></code> clause that declares the index variables can
be omitted:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">writeln</span><span class="p">(</span><span class="s">&quot;This should iterate five times:&quot;</span><span class="p">);</span>
<span class="k">for</span> <span class="k">zip</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span> <span class="mi">1</span><span class="o">..</span><span class="mi">5</span><span class="p">)</span> <span class="k">do</span>
  <span class="nx">writeln</span><span class="p">(</span><span class="s">&quot;Hi!&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="zippered-iterand-size-matching">
<h2>Zippered Iterand Size Matching<a class="headerlink" href="#zippered-iterand-size-matching" title="Permalink to this headline">¶</a></h2>
<p>As mentioned above, zippered iterands must typically have the same
size, which is to say they should yield the same number of things.
One important exception to this rule, seen above, is that unbounded
ranges can be zipped with fixed-size iterands in spite of being
conceptually infinite.  In such cases, the unbounded range will yield
the same number of elements as the bounded iterand(s) with which it is
zipped.</p>
<p>As an example, the following loop assigns an array’s elements their
ordinal values without needing to know the array’s size <em>a priori</em>:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="kd">in</span> <span class="k">zip</span><span class="p">(</span><span class="nx">A</span><span class="p">,</span> <span class="mi">1</span><span class="o">..</span><span class="p">)</span> <span class="k">do</span>
  <span class="nx">a</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
</pre></div>
</div>
<p>Unfortunately, there is currently no way for users to define an
iterator that is flexible with respect to size in a zippered context
like unbounded ranges are.  Such a capability is planned for the
future to support idioms like iterators that yield an appropriate
number of values from an unbounded random sequence or data stream.  In
the meantime, a typical workaround is to pass such iterators a size
argument indicating the number of items to generate.</p>
<p>Note that today, unbounded ranges can occur anywhere in a zippered
iterand list.  However, in anticipating future support for zippering
unbounded user iterators, programmers are encouraged to have any
unbounded ranges follow a fixed-size iterand in zippered contexts (as
<code class="docutils literal notranslate"><span class="pre">1..</span></code> follows <em>A</em> in the examples above).</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../taskpar/taskParallelismOverview.html" class="btn btn-neutral float-right" title="Task Parallelism Overview" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="forloops.html" class="btn btn-neutral float-left" title="for-loops: structured serial iteration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Hewlett Packard Enterprise Development LP

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 



</body>
</html>