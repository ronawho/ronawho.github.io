

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>config Declarations: command-line overrides &mdash; Chapel Documentation 1.23</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Casts: explicit type conversions" href="casts.html" />
    <link rel="prev" title="Type Aliases" href="typeAliases.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

<a href="../../index.html" class="icon icon-home"> Chapel Documentation

<!-- display version if button won't be rendered -->
<?php if (false) { ?>
<br>1.23
<?php } ?>

</a>

<?php
// Variables given by sphinx
$chplTitle = "1.23";
$pagename = "users-guide/base/configs";
include "../..//versionButton.php";
?>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Compiling and Running Chapel</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../usingchapel/QUICKSTART.html">Quickstart Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usingchapel/index.html">Using Chapel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../platforms/index.html">Platform-Specific Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../technotes/index.html">Technical Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">Tools</a></li>
</ul>
<p class="caption"><span class="caption-text">Writing Chapel Programs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../language/reference.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Hello World Variants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../primers/index.html">Primers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../language/spec/index.html">Language Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../builtins/index.html">Built-in Types and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/standard.html">Standard Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/packages.html">Package Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/layoutdist.html">Standard Layouts and Distributions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Chapel Users Guide (WIP)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#overview">Overview</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#base-language">Base Language</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="hello.html">Hello world: simple console output</a></li>
<li class="toctree-l3"><a class="reference internal" href="vars.html">Variable Declarations</a></li>
<li class="toctree-l3"><a class="reference internal" href="basicTypes.html">Basic Types: booleans, numbers, and strings</a></li>
<li class="toctree-l3"><a class="reference internal" href="basicValues.html">Literal Values for Basic Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="constParam.html">Constant Declarations</a></li>
<li class="toctree-l3"><a class="reference internal" href="typeAliases.html">Type Aliases</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#"><strong>config</strong> Declarations: command-line overrides</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#config-var-and-config-const"><code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">var</span></code> and <code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">const</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#config-param-and-config-type"><code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">param</span></code> and <code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#compile-time-overrides-for-config-var-and-config-const">Compile-time overrides for <code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">var</span></code> and <code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">const</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#scope-of-config-declarations">Scope of <code class="docutils literal notranslate"><span class="pre">config</span></code> declarations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="casts.html">Casts: explicit type conversions</a></li>
<li class="toctree-l3"><a class="reference internal" href="forloops.html"><strong>for</strong>-loops: structured serial iteration</a></li>
<li class="toctree-l3"><a class="reference internal" href="zip.html">Zippered Iteration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#task-parallelism">Task Parallelism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#data-parallelism">Data Parallelism</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#locality">Locality</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Language History</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../language/evolution.html">Chapel Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../language/archivedSpecs.html">Documentation Archives</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Chapel Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Chapel Users Guide (WIP)</a> &raquo;</li>
        
      <li><strong>config</strong> Declarations: command-line overrides</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/users-guide/base/configs.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="config-declarations-command-line-overrides">
<span id="ug-configs"></span><h1><strong>config</strong> Declarations: command-line overrides<a class="headerlink" href="#config-declarations-command-line-overrides" title="Permalink to this headline">¶</a></h1>
<p>The four main declaration keywords that have been introduced so far —
<code class="docutils literal notranslate"><span class="pre">var</span></code>, <code class="docutils literal notranslate"><span class="pre">const</span></code>, <code class="docutils literal notranslate"><span class="pre">param</span></code>, and <code class="docutils literal notranslate"><span class="pre">type</span></code> — support a mode in which
their initializing expressions in the source code can be overridden on
the command-line.  This is achieved by prefixing the declaration with
the keyword <code class="docutils literal notranslate"><span class="pre">config</span></code>.  Chapel’s <code class="docutils literal notranslate"><span class="pre">config</span></code> feature provides a simple
means of specifying and overriding default values.</p>
<div class="section" id="config-var-and-config-const">
<h2><code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">var</span></code> and <code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">const</span></code><a class="headerlink" href="#config-var-and-config-const" title="Permalink to this headline">¶</a></h2>
<p><em>Configuration variables</em> are variables whose default values can be
overridden on the executable’s command-line.  Here’s a simple example:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">examples/users-guide/base/configs.chpl</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">config</span> <span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</pre></div>
</div>
</div>
<p>Like a traditional <code class="docutils literal notranslate"><span class="pre">var</span></code> declaration, this creates a variable named
<em>n</em> of type <code class="docutils literal notranslate"><span class="pre">int</span></code>, initialized to the value 10.  However, the
<code class="docutils literal notranslate"><span class="pre">config</span></code> prefix causes the compiler to add a command-line flag to
the generated executable that supports overriding that default value.
For example, if we run the program as follows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>./configs --n 1000
</pre></div>
</div>
<p>then <em>n</em> will be initialized to the value 1000 for that execution of
the program.  The arguments for these flags can also be specified
using <code class="docutils literal notranslate"><span class="pre">=</span></code> (with no spaces) as the separator between the argument
name and its value, as follows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>./configs --n=1000
</pre></div>
</div>
<p>There is no difference between these two forms—it’s simply a matter of
taste.</p>
<p>As with normal variables, a <code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">var</span></code> can be re-assigned
throughout its lifetime.  In contrast, <code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">const</span></code> declarations
cannot be changed once they are initialized, whether that initial
value comes from the source code or the command-line.  The following
statement declares a pair of configurable constants:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">config</span> <span class="kd">const</span> <span class="nx">epsilon</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
             <span class="nx">debug</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</pre></div>
</div>
<p>As with the previous case, we can override their default values on the
executable’s command-line.  For instance the following switches to a
smaller value of <em>epsilon</em> and flips <em>debug</em> to <code class="docutils literal notranslate"><span class="pre">true</span></code>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>./configs --epsilon=0.000001 --debug=true
</pre></div>
</div>
<p>Boolean <code class="docutils literal notranslate"><span class="pre">config</span></code> declarations, like <em>debug</em> above, also support a
mode in which they can be set to <code class="docutils literal notranslate"><span class="pre">true</span></code> simply by using the flag
without a supporting value.  Thus, the previous command-line could
also have been written:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>./configs --epsilon=0.000001 --debug
</pre></div>
</div>
</div>
<div class="section" id="config-param-and-config-type">
<h2><code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">param</span></code> and <code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">type</span></code><a class="headerlink" href="#config-param-and-config-type" title="Permalink to this headline">¶</a></h2>
<p>Chapel also supports configurable <code class="docutils literal notranslate"><span class="pre">param</span></code> and <code class="docutils literal notranslate"><span class="pre">type</span></code> declarations
via command-line flags.  However, since <code class="docutils literal notranslate"><span class="pre">param</span></code> values and types
must be known to the compiler, the default values are overridden using
flags on the compiler rather than the generated executable.</p>
<p>As an example, the following statements declare a series of
configurable <code class="docutils literal notranslate"><span class="pre">param</span></code> and <code class="docutils literal notranslate"><span class="pre">type</span></code> symbols:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">config</span> <span class="kd">param</span> <span class="nx">verbose</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
             <span class="nx">bitMask</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">,</span>
             <span class="nx">size</span> <span class="o">=</span> <span class="nx">numBits</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span>

<span class="kd">config</span> <span class="kd">type</span> <span class="nx">age</span> <span class="o">=</span> <span class="kt">uint</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
</pre></div>
</div>
<p>When overriding <code class="docutils literal notranslate"><span class="pre">config</span></code> declarations in the compiler the <code class="docutils literal notranslate"><span class="pre">-s</span></code>
flag is used to set the new value.  As an example, to set <strong>verbose</strong>
to <code class="docutils literal notranslate"><span class="pre">true</span></code>, we could compile as follows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>chpl -sverbose=true configs2.chpl
</pre></div>
</div>
<p>or:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>chpl -s verbose=true configs2.chpl
</pre></div>
</div>
<p>As with the generated executable, boolean values can also be set on
the compiler’s command line simply using the name of the flag.  Thus,
the following would be equivalent to the previous line:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>chpl -sverbose configs2.chpl
</pre></div>
</div>
<p>As you’d expect, multiple <code class="docutils literal notranslate"><span class="pre">config</span></code> declarations can be overridden at
once.  For example, this command-line overrides the default
initializers for <em>bitMask</em>, <em>size</em>, and <em>age</em>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>chpl -sbitMask=0b00001111 -ssize=16 -sage=&#39;uint(16)&#39; configs2.chpl
</pre></div>
</div>
<p>One of the nice things about setting <code class="docutils literal notranslate"><span class="pre">config</span></code> declarations on the
compiler’s command-line is that the specified value can be an
arbitrary Chapel expression, provided that the compiler can evaluate
it in place of the source-based initialization expression.  Thus, we
can use more interesting expressions when setting compile-time
<code class="docutils literal notranslate"><span class="pre">config</span></code> values.  For example, the following compiler lines specify
<em>bitMask</em>, <em>size</em>, and <em>age</em> using expressions other than simple
literals and type names:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>chpl -sbitMask=&#39;1 &lt;&lt; 10&#39; -ssize=&#39;numBits(bitMask.type)/2&#39; configs2.chpl
chpl -sage=&#39;if verbose then uint(32) else uint(16)&#39; configs2.chpl
</pre></div>
</div>
<p>Note the use of quotes in some of the examples above.  These are not
required by Chapel itself, but are used to pass nontrivial expressions
through the command-line shell (e.g., <strong>bash</strong>) such that they reach
Chapel as a single uninterpreted argument.  For example, parenthesis
have special meaning for many command-shells, so the use of quotes
above tells the shell to ignore them.  Other cases use quotes to pass
expressions containing whitespace to the Chapel compiler as a single
argument.  Details about which characters have special meaning and how
they can be preserved depend on the specific shell being used and are
beyond the scope of this article.</p>
<p>Setting <code class="docutils literal notranslate"><span class="pre">config</span></code> defaults on the compiler’s command-line also
supports more radical alterations to the code.  For example, we
could change <em>age</em> from an integral type to a floating point type:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>--n=1000 --epsilon=0.000000001
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">config</span></code> declarations are processed in the order specified
by the source code and compiler, not the order that they occur on the
command-line.  Moreover, the initializing expressions must make sense
when considered in the source code context.  Thus, the command-line
override for a given <code class="docutils literal notranslate"><span class="pre">config</span></code> can refer to other declarations that
precede it in a given module.  For instance, we can set <em>age</em> in terms
of the <code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">param</span></code> <em>size</em> since it appeared earlier in the code:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>chpl -sage=&#39;int(size)&#39;
</pre></div>
</div>
<p>However, the reverse would not be possible since <em>age</em> has not been
initialized when <em>size</em> is declared.</p>
<p>Similarly, subsequent declarations in the source code can themselves
be based on <code class="docutils literal notranslate"><span class="pre">config</span></code> declarations.  For instance, here are some
declarations that are based on the <code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">param</span></code> and <code class="docutils literal notranslate"><span class="pre">config</span>
<span class="pre">type</span></code> statements shown above and could follow them:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">type</span> <span class="nx">myInt</span> <span class="o">=</span> <span class="kt">int</span><span class="p">(</span><span class="nx">size</span><span class="p">);</span>

<span class="kd">param</span> <span class="nx">sizeOfAge</span> <span class="o">=</span> <span class="nx">numBits</span><span class="p">(</span><span class="nx">age</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="compile-time-overrides-for-config-var-and-config-const">
<h2>Compile-time overrides for <code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">var</span></code> and <code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">const</span></code><a class="headerlink" href="#compile-time-overrides-for-config-var-and-config-const" title="Permalink to this headline">¶</a></h2>
<p>Users can also specify default expressions for <code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">var</span></code> and
<code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">const</span></code> declarations on the compiler’s command-line.  As with
other compile-time overrides, complex or symbolic expressions can be
used since the compiler is involved.  As an example, let’s look at
a variation on one of our earlier declarations:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">config</span> <span class="kd">const</span> <span class="nx">n</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
             <span class="nx">epsilon</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">;</span>
</pre></div>
</div>
<p>The following compiler command can be used to override the source
code initializer for <em>epsilon</em> so that it will be a function of
<em>n</em> by default:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>-sepsilon=1.0/n
</pre></div>
</div>
<p>Such an initializer could not be specified on the executable
command-line since the compiler is out of the picture by then.  At
that point, the values for a <code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">var</span></code> or <code class="docutils literal notranslate"><span class="pre">config</span> <span class="pre">const</span></code> are
restricted to the set of strings that can legally be cast to that
type.</p>
<p>Having compiled <em>epsilon</em> to be set in this way, if we specify
a value for <em>n</em> on the executable’s command line:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>--n=1000
</pre></div>
</div>
<p>then <em>epsilon</em> will be computed in terms of it, resulting in the value:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>0.001
</pre></div>
</div>
<p>Note that the compiler’s command-line override can still be
re-overridden on the executable’s command-line as usual:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>--n=1000 --epsilon=0.000000001
</pre></div>
</div>
</div>
<div class="section" id="scope-of-config-declarations">
<h2>Scope of <code class="docutils literal notranslate"><span class="pre">config</span></code> declarations<a class="headerlink" href="#scope-of-config-declarations" title="Permalink to this headline">¶</a></h2>
<p>Because all <code class="docutils literal notranslate"><span class="pre">config</span></code> declarations are processed at program startup
time, they must appear at <em>module scope</em>.  We haven’t talked about
modules yet, so for now, think of them as needing to appear as
top-level statements in a file.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="casts.html" class="btn btn-neutral float-right" title="Casts: explicit type conversions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="typeAliases.html" class="btn btn-neutral float-left" title="Type Aliases" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Hewlett Packard Enterprise Development LP

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 



</body>
</html>