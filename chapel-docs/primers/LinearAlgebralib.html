

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>LinearAlgebra &mdash; Chapel Documentation 1.23</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="LAPACK" href="LAPACKlib.html" />
    <link rel="prev" title="Timers" href="timers.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

<a href="../index.html" class="icon icon-home"> Chapel Documentation

<!-- display version if button won't be rendered -->
<?php if (false) { ?>
<br>1.23
<?php } ?>

</a>

<?php
// Variables given by sphinx
$chplTitle = "1.23";
$pagename = "primers/LinearAlgebralib";
include "..//versionButton.php";
?>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Compiling and Running Chapel</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usingchapel/QUICKSTART.html">Quickstart Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usingchapel/index.html">Using Chapel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../platforms/index.html">Platform-Specific Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../technotes/index.html">Technical Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Tools</a></li>
</ul>
<p class="caption"><span class="caption-text">Writing Chapel Programs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../language/reference.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Hello World Variants</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Primers</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#language-basics">Language Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#iterators">Iterators</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#task-parallelism">Task Parallelism</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#locality">Locality</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#data-parallelism">Data Parallelism</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#library-utilities">Library Utilities</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#numerical-libraries">Numerical Libraries</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">LinearAlgebra</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#compiling-with-linear-algebra">Compiling with Linear Algebra</a></li>
<li class="toctree-l4"><a class="reference internal" href="#basics">Basics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#factory-functions">Factory Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#operations">Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#properties">Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#structure">Structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#linearalgebra-sparse">LinearAlgebra.Sparse</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="LAPACKlib.html">LAPACK</a></li>
<li class="toctree-l3"><a class="reference internal" href="FFTWlib.html">FFTW</a></li>
<li class="toctree-l3"><a class="reference internal" href="randomNumbers.html">Random</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#tools">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#language-overview">Language Overview</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../language/spec/index.html">Language Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../builtins/index.html">Built-in Types and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/standard.html">Standard Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/packages.html">Package Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/layoutdist.html">Standard Layouts and Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users-guide/index.html">Chapel Users Guide (WIP)</a></li>
</ul>
<p class="caption"><span class="caption-text">Language History</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../language/evolution.html">Chapel Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language/archivedSpecs.html">Documentation Archives</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Chapel Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Primers</a> &raquo;</li>
        
      <li>LinearAlgebra</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/primers/LinearAlgebralib.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="linearalgebra">
<span id="primers-linearalgebralib"></span><h1><a class="toc-backref" href="#id3">LinearAlgebra</a><a class="headerlink" href="#linearalgebra" title="Permalink to this headline">Â¶</a></h1>
<p><a class="reference external" href="https://github.com/chapel-lang/chapel/blob/master/test/release/examples/primers/LinearAlgebralib.chpl">View LinearAlgebralib.chpl on GitHub</a></p>
<p>Example usage of the <a class="reference internal" href="../modules/packages/LinearAlgebra.html#module-LinearAlgebra" title="LinearAlgebra: A high-level interface to linear algebra operations and procedures."><code class="xref chpl chpl-mod docutils literal notranslate"><span class="pre">LinearAlgebra</span></code></a> module in Chapel.</p>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#linearalgebra" id="id3">LinearAlgebra</a><ul>
<li><a class="reference internal" href="#compiling-with-linear-algebra" id="id4">Compiling with Linear Algebra</a></li>
<li><a class="reference internal" href="#basics" id="id5">Basics</a><ul>
<li><a class="reference internal" href="#linear-algebra-types" id="id6">Linear Algebra Types</a></li>
<li><a class="reference internal" href="#array-operations" id="id7">Array operations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#factory-functions" id="id8">Factory Functions</a><ul>
<li><a class="reference internal" href="#vectors" id="id9">Vectors</a></li>
<li><a class="reference internal" href="#matrices" id="id10">Matrices</a></li>
</ul>
</li>
<li><a class="reference internal" href="#operations" id="id11">Operations</a></li>
<li><a class="reference internal" href="#properties" id="id12">Properties</a></li>
<li><a class="reference internal" href="#structure" id="id13">Structure</a></li>
<li><a class="reference internal" href="#linearalgebra-sparse" id="id14">LinearAlgebra.Sparse</a><ul>
<li><a class="reference internal" href="#supported-sparse-layouts" id="id15">Supported Sparse Layouts</a></li>
<li><a class="reference internal" href="#id1" id="id16">Factory Functions</a></li>
<li><a class="reference internal" href="#id2" id="id17">Operations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">LinearAlgebra</span><span class="p">;</span>
</pre></div>
</div>
<div class="section" id="compiling-with-linear-algebra">
<h2><a class="toc-backref" href="#id4">Compiling with Linear Algebra</a><a class="headerlink" href="#compiling-with-linear-algebra" title="Permalink to this headline">Â¶</a></h2>
<p>Some of the linear algebra module procedures rely on the <a class="reference internal" href="../modules/packages/BLAS.html#module-BLAS" title="BLAS: Support for Basic Linear Algebra Subprograms (BLAS) kernel routines."><code class="xref chpl chpl-mod docutils literal notranslate"><span class="pre">BLAS</span></code></a> and
<a class="reference internal" href="../modules/packages/LAPACK.html#module-LAPACK" title="LAPACK: Chapel idiomatic wrappers for the LAPACK library."><code class="xref chpl chpl-mod docutils literal notranslate"><span class="pre">LAPACK</span></code></a> modules.  If using routines that rely on these modules,
be sure to have a BLAS and LAPACK implementation available on your system.
See the <a class="reference internal" href="../modules/packages/BLAS.html#module-BLAS" title="BLAS: Support for Basic Linear Algebra Subprograms (BLAS) kernel routines."><code class="xref chpl chpl-mod docutils literal notranslate"><span class="pre">BLAS</span></code></a> and <a class="reference internal" href="../modules/packages/LAPACK.html#module-LAPACK" title="LAPACK: Chapel idiomatic wrappers for the LAPACK library."><code class="xref chpl chpl-mod docutils literal notranslate"><span class="pre">LAPACK</span></code></a> documentation for further details.</p>
<p>To explicitly opt out of using the <a class="reference internal" href="../modules/packages/BLAS.html#module-BLAS" title="BLAS: Support for Basic Linear Algebra Subprograms (BLAS) kernel routines."><code class="xref chpl chpl-mod docutils literal notranslate"><span class="pre">BLAS</span></code></a> and <a class="reference internal" href="../modules/packages/LAPACK.html#module-LAPACK" title="LAPACK: Chapel idiomatic wrappers for the LAPACK library."><code class="xref chpl chpl-mod docutils literal notranslate"><span class="pre">LAPACK</span></code></a> procedures,
compile your Chapel program with the flags:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>chpl --set <span class="nv">blasImpl</span><span class="o">=</span>off --set <span class="nv">lapackImpl</span><span class="o">=</span>off myProgram.chpl
</pre></div>
</div>
<p>This will result in a cleaner compiler error when using a procedure that is
only available with <a class="reference internal" href="../modules/packages/BLAS.html#module-BLAS" title="BLAS: Support for Basic Linear Algebra Subprograms (BLAS) kernel routines."><code class="xref chpl chpl-mod docutils literal notranslate"><span class="pre">BLAS</span></code></a> or <a class="reference internal" href="../modules/packages/LAPACK.html#module-LAPACK" title="LAPACK: Chapel idiomatic wrappers for the LAPACK library."><code class="xref chpl chpl-mod docutils literal notranslate"><span class="pre">LAPACK</span></code></a>.</p>
</div>
<div class="section" id="basics">
<h2><a class="toc-backref" href="#id5">Basics</a><a class="headerlink" href="#basics" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="linear-algebra-types">
<h3><a class="toc-backref" href="#id6">Linear Algebra Types</a><a class="headerlink" href="#linear-algebra-types" title="Permalink to this headline">Â¶</a></h3>
<p>In Chapel, there are no <code class="docutils literal notranslate"><span class="pre">Vector</span></code> or <code class="docutils literal notranslate"><span class="pre">Matrix</span></code> types.
Instead, vectors and matrices are represented as 1D and 2D native Chapel
arrays, respectively. As a result, the terms <em>vector</em> and <em>1D array</em> are used
interchangeably, as well as <em>matrix</em> and <em>2D array</em>.</p>
<p>The following example demonstrates this:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">vector1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="o">..#</span><span class="mi">5</span><span class="p">]</span> <span class="kt">int</span><span class="p">;</span>             <span class="c1">// Using Chapel array syntax</span>
<span class="kd">var</span> <span class="nx">vector2</span> <span class="o">=</span> <span class="nx">Vector</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nx">eltType</span><span class="o">=</span><span class="kt">int</span><span class="p">);</span> <span class="c1">// Using LinearAlgebra Vector function</span>
<span class="nx">assert</span><span class="p">(</span><span class="nx">vector1</span><span class="p">.</span><span class="kd">type</span> <span class="o">==</span> <span class="nx">vector2</span><span class="p">.</span><span class="kd">type</span><span class="p">);</span> <span class="c1">// ... produces same result</span>

<span class="kd">var</span> <span class="nx">matrix1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="o">..#</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="o">..#</span><span class="mi">5</span><span class="p">]</span> <span class="kt">int</span><span class="p">;</span>         <span class="c1">// Using Chapel array syntax</span>
<span class="kd">var</span> <span class="nx">matrix2</span> <span class="o">=</span> <span class="nx">Matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nx">eltType</span><span class="o">=</span><span class="kt">int</span><span class="p">);</span> <span class="c1">// Using LinearAlgebra Matrix function</span>
<span class="nx">assert</span><span class="p">(</span><span class="nx">matrix1</span><span class="p">.</span><span class="kd">type</span> <span class="o">==</span> <span class="nx">matrix2</span><span class="p">.</span><span class="kd">type</span><span class="p">);</span>    <span class="c1">// ... produces same result</span>
</pre></div>
</div>
</div>
<div class="section" id="array-operations">
<h3><a class="toc-backref" href="#id7">Array operations</a><a class="headerlink" href="#array-operations" title="Permalink to this headline">Â¶</a></h3>
<p>This section demonstrates some of the functionality built into Chapel
arrays that can be useful in a linear algebra context. None of the operations
in this section require usage of <a class="reference internal" href="../modules/packages/LinearAlgebra.html#module-LinearAlgebra" title="LinearAlgebra: A high-level interface to linear algebra operations and procedures."><code class="xref chpl chpl-mod docutils literal notranslate"><span class="pre">LinearAlgebra</span></code></a>.
Learn more about Chapel arrays in the <a class="reference internal" href="../builtins/ChapelArray.html#module-ChapelArray" title="ChapelArray: Operations on Domains and Arrays."><code class="xref chpl chpl-mod docutils literal notranslate"><span class="pre">ChapelArray</span></code></a> documentation and
the <a class="reference internal" href="arrays.html#primers-arrays"><span class="std std-ref">Array Primer</span></a>.</p>
<p>Create a 3 x 5 matrix of reals, default-initialized to values of <code class="docutils literal notranslate"><span class="pre">0.0</span></code></p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">a</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="o">..#</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="o">..#</span><span class="mi">5</span><span class="p">]</span> <span class="kt">real</span><span class="p">;</span> <span class="c1">// Equivalent to: var a = Matrix(3, 5);</span>
</pre></div>
</div>
<p>Set all elements to <code class="docutils literal notranslate"><span class="pre">1.0</span></code></p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">a</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
</pre></div>
</div>
<p>Print matrix</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">writeln</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
  <span class="c1">// Prints:</span>
  <span class="c1">//   1.0 1.0 1.0</span>
  <span class="c1">//   1.0 1.0 1.0</span>
  <span class="c1">//   1.0 1.0 1.0</span>
  <span class="c1">//   1.0 1.0 1.0</span>
  <span class="c1">//   1.0 1.0 1.0</span>
</pre></div>
</div>
<p>Number of dimensions</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">a</span><span class="p">.</span><span class="nx">rank</span><span class="p">;</span> <span class="c1">// 2</span>
</pre></div>
</div>
<p>Size</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">a</span><span class="p">.</span><span class="nx">size</span><span class="p">;</span> <span class="c1">// 15</span>
</pre></div>
</div>
<p>Shape</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">a</span><span class="p">.</span><span class="nx">shape</span><span class="p">;</span> <span class="c1">// (3, 5)</span>
</pre></div>
</div>
<p>Element type</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">writeln</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">eltType</span><span class="p">:</span> <span class="kt">string</span><span class="p">);</span> <span class="c1">// real(64)</span>
</pre></div>
</div>
<p>Array type in format of:
<code class="docutils literal notranslate"><span class="pre">[domain(rank,</span> <span class="pre">index-type,</span> <span class="pre">stridable)]</span> <span class="pre">element-type</span></code></p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">writeln</span><span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="kd">type</span><span class="p">:</span> <span class="kt">string</span><span class="p">);</span> <span class="c1">// [domain(2,int(64),false)] real(64)</span>
</pre></div>
</div>
<p>Element-wise addition (and subtraction)</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">a</span> <span class="o">=</span> <span class="nx">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// or, a += 1</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
  <span class="c1">// Prints:</span>
  <span class="c1">//   2.0 2.0 2.0</span>
  <span class="c1">//   2.0 2.0 2.0</span>
  <span class="c1">//   2.0 2.0 2.0</span>
  <span class="c1">//   2.0 2.0 2.0</span>
  <span class="c1">//   2.0 2.0 2.0</span>
</pre></div>
</div>
<p>Element-wise multiplication</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">a</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nx">a</span><span class="p">;</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
  <span class="c1">// Prints:</span>
  <span class="c1">//   4.0 4.0 4.0</span>
  <span class="c1">//   4.0 4.0 4.0</span>
  <span class="c1">//   4.0 4.0 4.0</span>
  <span class="c1">//   4.0 4.0 4.0</span>
  <span class="c1">//   4.0 4.0 4.0</span>
</pre></div>
</div>
<p>Element-wise division</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">a</span> <span class="o">=</span> <span class="nx">a</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">;</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
  <span class="c1">// Prints:</span>
  <span class="c1">//   1.0 1.0 1.0</span>
  <span class="c1">//   1.0 1.0 1.0</span>
  <span class="c1">//   1.0 1.0 1.0</span>
  <span class="c1">//   1.0 1.0 1.0</span>
  <span class="c1">//   1.0 1.0 1.0</span>
</pre></div>
</div>
<p>Array slicing</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">..</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span> <span class="c1">// Sets first row to 0.0</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
  <span class="c1">// Prints:</span>
  <span class="c1">//   0.0 0.0 0.0</span>
  <span class="c1">//   1.0 1.0 1.0</span>
  <span class="c1">//   1.0 1.0 1.0</span>
  <span class="c1">//   1.0 1.0 1.0</span>
  <span class="c1">//   1.0 1.0 1.0</span>

<span class="nx">a</span><span class="p">[</span><span class="o">..</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">;</span> <span class="c1">// Sets second column to 3.0</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
  <span class="c1">// Prints:</span>
  <span class="c1">//   0.0 3.0 0.0</span>
  <span class="c1">//   1.0 3.0 1.0</span>
  <span class="c1">//   1.0 3.0 1.0</span>
  <span class="c1">//   1.0 3.0 1.0</span>
  <span class="c1">//   1.0 3.0 1.0</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="factory-functions">
<h2><a class="toc-backref" href="#id8">Factory Functions</a><a class="headerlink" href="#factory-functions" title="Permalink to this headline">Â¶</a></h2>
<p>The Linear Algebra module contains several factory functions for creating
1D (vector) and 2D (matrix) arrays. These functions are purely a convenience
that provides a less verbose syntax for array declarations as well as an
interface similar to other common linear algebra libraries.
Below are some examples. See the documentation starting at
<a class="reference internal" href="../modules/packages/LinearAlgebra.html#LinearAlgebra.Vector" title="LinearAlgebra.Vector"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">LinearAlgebra.Vector</span></code></a> for a comprehensive list of the available
factory functions.</p>
<div class="section" id="vectors">
<h3><a class="toc-backref" href="#id9">Vectors</a><a class="headerlink" href="#vectors" title="Permalink to this headline">Â¶</a></h3>
<p>Shown below are a variety of way to create the same 5-element array of
<code class="docutils literal notranslate"><span class="pre">real</span></code> type.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The LinearAlgebra module represents <em>row-vectors</em> the same way as
<em>column-vectors</em>. They are both 1D arrays.</p>
</div>
<p>Creating 1D arrays (vectors):</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">v0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="o">..#</span><span class="mi">5</span><span class="p">]</span> <span class="kt">real</span><span class="p">;</span>     <span class="c1">// Chapel array syntax</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">v0</span><span class="p">);</span>
  <span class="c1">// Prints:</span>
  <span class="c1">// 0.0 0.0 0.0 0.0 0.0</span>
<span class="kd">var</span> <span class="nx">v1</span> <span class="o">=</span> <span class="nx">Vector</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>       <span class="c1">// from a length</span>
<span class="kd">var</span> <span class="nx">v2</span> <span class="o">=</span> <span class="nx">Vector</span><span class="p">(</span><span class="mi">0</span><span class="o">..#</span><span class="mi">5</span><span class="p">);</span>   <span class="c1">// from a range</span>
<span class="kd">var</span> <span class="nx">v3</span> <span class="o">=</span> <span class="nx">Vector</span><span class="p">({</span><span class="mi">0</span><span class="o">..#</span><span class="mi">5</span><span class="p">});</span> <span class="c1">// from a domain</span>
<span class="kd">var</span> <span class="nx">v4</span> <span class="o">=</span> <span class="nx">Vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="nx">eltType</span><span class="o">=</span><span class="kt">real</span><span class="p">);</span> <span class="c1">// from a 1D array</span>
<span class="kd">var</span> <span class="nx">v5</span> <span class="o">=</span> <span class="nx">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">eltType</span><span class="o">=</span><span class="kt">real</span><span class="p">);</span>   <span class="c1">// from a list of values as arguments</span>
</pre></div>
</div>
<p>If the <code class="docutils literal notranslate"><span class="pre">eltType</span></code> is omitted for the argument case, it will be inferred from
the first argument. For example, this creates a vector of reals:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">v6</span> <span class="o">=</span> <span class="nx">Vector</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="nx">assert</span><span class="p">(</span><span class="nx">v6</span><span class="p">.</span><span class="nx">eltType</span> <span class="o">==</span> <span class="kt">real</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="matrices">
<h3><a class="toc-backref" href="#id10">Matrices</a><a class="headerlink" href="#matrices" title="Permalink to this headline">Â¶</a></h3>
<p>Shown below are a variety of way to create the same 3 x 3 array of <code class="docutils literal notranslate"><span class="pre">real</span></code>
type.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The base LinearAlgebra module strictly supports <code class="docutils literal notranslate"><span class="pre">DefaultRectangular</span></code>
arrays for matrix operations. Other layouts (such as <code class="docutils literal notranslate"><span class="pre">LayoutCS</span></code>) and
distributions (such as <code class="docutils literal notranslate"><span class="pre">BlockDist</span></code>) will be supported through
LinearAlgebra submodules.</p>
</div>
<p>Creating 2D arrays (matrices):</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">M0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="o">..#</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="o">..#</span><span class="mi">3</span><span class="p">]</span> <span class="kt">real</span><span class="p">;</span> <span class="c1">// Chapel array syntax</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">M0</span><span class="p">);</span>
  <span class="c1">// Prints:</span>
  <span class="c1">//   0.0 0.0 0.0</span>
  <span class="c1">//   0.0 0.0 0.0</span>
  <span class="c1">//   0.0 0.0 0.0</span>
<span class="kd">var</span> <span class="nx">M1</span> <span class="o">=</span> <span class="nx">Matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>                 <span class="c1">// from a length</span>
<span class="kd">var</span> <span class="nx">M2</span> <span class="o">=</span> <span class="nx">Matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>              <span class="c1">// from a length and width</span>
<span class="kd">var</span> <span class="nx">M3</span> <span class="o">=</span> <span class="nx">Matrix</span><span class="p">(</span><span class="mi">0</span><span class="o">..#</span><span class="mi">3</span><span class="p">);</span>             <span class="c1">// from 1 range</span>
<span class="kd">var</span> <span class="nx">M4</span> <span class="o">=</span> <span class="nx">Matrix</span><span class="p">(</span><span class="mi">0</span><span class="o">..#</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="o">..#</span><span class="mi">3</span><span class="p">);</span>      <span class="c1">// from 2 ranges</span>
<span class="kd">var</span> <span class="nx">M5</span> <span class="o">=</span> <span class="nx">Matrix</span><span class="p">({</span><span class="mi">0</span><span class="o">..#</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="o">..#</span><span class="mi">3</span><span class="p">});</span>    <span class="c1">// from a 2D domain</span>
<span class="kd">var</span> <span class="nx">M6</span> <span class="o">=</span> <span class="nx">Matrix</span><span class="p">(</span><span class="nx">M5</span><span class="p">);</span>                <span class="c1">// from a 2D array</span>
<span class="kd">var</span> <span class="nx">M7</span> <span class="o">=</span> <span class="nx">Matrix</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="nx">eltType</span><span class="o">=</span><span class="kt">real</span><span class="p">);</span> <span class="c1">// from a list of 1D arrays as arguments</span>
</pre></div>
</div>
<p>Creating identity matrices:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">I1</span> <span class="o">=</span> <span class="nx">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="c1">// From a length</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">I1</span><span class="p">);</span>
  <span class="c1">// Prints:</span>
  <span class="c1">//   1.0 0.0 0.0</span>
  <span class="c1">//   0.0 1.0 0.0</span>
  <span class="c1">//   0.0 0.0 1.0</span>
<span class="kd">var</span> <span class="nx">I2</span> <span class="o">=</span> <span class="nx">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="c1">// From a length and width</span>
<span class="kd">var</span> <span class="nx">I3</span> <span class="o">=</span> <span class="nx">eye</span><span class="p">({</span><span class="mi">0</span><span class="o">..#</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="o">..#</span><span class="mi">3</span><span class="p">});</span> <span class="c1">// from a 2D domain</span>
</pre></div>
</div>
<p>Creating diagonal matrix from a vector:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">vec</span> <span class="o">=</span> <span class="nx">Vector</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nx">eltType</span><span class="o">=</span><span class="kt">real</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">diagMatrix</span> <span class="o">=</span> <span class="nx">diag</span><span class="p">(</span><span class="nx">vec</span><span class="p">);</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">diagMatrix</span><span class="p">);</span>
  <span class="c1">// Prints:</span>
  <span class="c1">//   1.0 0.0 0.0</span>
  <span class="c1">//   0.0 2.0 0.0</span>
  <span class="c1">//   0.0 0.0 3.0</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="operations">
<h2><a class="toc-backref" href="#id11">Operations</a><a class="headerlink" href="#operations" title="Permalink to this headline">Â¶</a></h2>
<p>Setup some matrices</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="c1">// Operations scope</span>

<span class="kd">var</span> <span class="nx">A</span> <span class="o">=</span> <span class="nx">Matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span>
    <span class="nx">B</span> <span class="o">=</span> <span class="nx">Matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>

<span class="nx">A</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
<span class="nx">B</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span>
</pre></div>
</div>
<p>Element-wise addition</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">ApB</span> <span class="o">=</span> <span class="nx">A</span> <span class="o">+</span> <span class="nx">B</span><span class="p">;</span>
</pre></div>
</div>
<p>Element-wise subtraction</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">AmB</span> <span class="o">=</span> <span class="nx">A</span> <span class="o">-</span> <span class="nx">B</span><span class="p">;</span>
</pre></div>
</div>
<p>Element-wise multiplication</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">AtB</span> <span class="o">=</span> <span class="nx">A</span> <span class="o">*</span> <span class="nx">B</span><span class="p">;</span>
</pre></div>
</div>
<p>Element-wise division</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">AdB</span> <span class="o">=</span> <span class="nx">A</span> <span class="o">/</span> <span class="nx">B</span><span class="p">;</span>
</pre></div>
</div>
<p>Taking the transpose of a matrix:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">M0T</span> <span class="o">=</span> <span class="nx">transpose</span><span class="p">(</span><span class="nx">M0</span><span class="p">);</span>
<span class="nx">M0T</span> <span class="o">=</span> <span class="nx">M0</span><span class="p">.</span><span class="nx">T</span><span class="p">;</span> <span class="c1">// short-hand syntax</span>
</pre></div>
</div>
<p>Taking the transpose of a vector simply returns the vector because row and
column vectors are equivalent:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">t1</span> <span class="o">=</span> <span class="nx">v0</span><span class="p">.</span><span class="nx">T</span><span class="p">;</span>
<span class="nx">assert</span><span class="p">(</span><span class="nx">t1</span><span class="p">.</span><span class="kd">type</span> <span class="o">==</span> <span class="nx">v0</span><span class="p">.</span><span class="kd">type</span><span class="p">);</span>
<span class="nx">assert</span><span class="p">(</span><span class="nx">t1</span> <span class="o">==</span> <span class="nx">v0</span><span class="p">);</span>
</pre></div>
</div>
<p>Creating a matrix and some vectors to use:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">X</span> <span class="o">=</span> <span class="nx">Matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="nx">y</span> <span class="o">=</span> <span class="nx">Vector</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
    <span class="nx">z</span> <span class="o">=</span> <span class="nx">Vector</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>

<span class="nx">X</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="nx">X</span> <span class="o">-=</span> <span class="nx">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">X</span><span class="p">);</span>
  <span class="c1">// Prints:</span>
  <span class="c1">//   0.0 1.0 1.0</span>
  <span class="c1">//   1.0 0.0 1.0</span>
  <span class="c1">//   1.0 1.0 0.0</span>
  <span class="c1">//   1.0 1.0 1.0</span>
  <span class="c1">//   1.0 1.0 1.0</span>
<span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="nx">z</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</pre></div>
</div>
<p>Matrix-matrix multiplication is computed by <code class="docutils literal notranslate"><span class="pre">dot()</span></code>:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">MM</span> <span class="o">=</span> <span class="nx">dot</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span> <span class="nx">X</span><span class="p">.</span><span class="nx">T</span><span class="p">);</span>
</pre></div>
</div>
<p>â¦ as well as matrix-vector multiplication:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">Mv</span> <span class="o">=</span> <span class="nx">dot</span><span class="p">(</span><span class="nx">X</span><span class="p">,</span> <span class="nx">z</span><span class="p">);</span>
</pre></div>
</div>
<p>â¦ or vector-matrix multiplication:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">vM</span> <span class="o">=</span> <span class="nx">dot</span><span class="p">(</span><span class="nx">y</span><span class="p">,</span> <span class="nx">X</span><span class="p">);</span>
</pre></div>
</div>
<p>â¦ and vector-vector multiplication:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">vv</span> <span class="o">=</span> <span class="nx">dot</span><span class="p">(</span><span class="nx">y</span><span class="p">,</span> <span class="nx">y</span><span class="p">);</span>
</pre></div>
</div>
<p>Because row and column vectors are indistinguishable, an <code class="docutils literal notranslate"><span class="pre">dot()</span></code> always
computes the inner product of 2 vectors.</p>
<p>To compute an outer product, one must explicitly call <code class="docutils literal notranslate"><span class="pre">outer()</span></code>:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">yz</span> <span class="o">=</span> <span class="nx">outer</span><span class="p">(</span><span class="nx">y</span><span class="p">,</span> <span class="nx">z</span><span class="p">);</span>
<span class="nx">writeln</span><span class="p">(</span><span class="s">&#39;outer:&#39;</span><span class="p">,</span> <span class="nx">yz</span><span class="p">);</span>
</pre></div>
</div>
<p>Matrix powers can be computed on square matrices with <code class="docutils literal notranslate"><span class="pre">matPow()</span></code>.
Only integer powers are currently supported:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">MM4</span> <span class="o">=</span> <span class="nx">matPow</span><span class="p">(</span><span class="nx">MM</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
</pre></div>
</div>
<p>Cross products of 3-element vectors can be computed with <code class="docutils literal notranslate"><span class="pre">cross()</span></code>:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crossProduct</span> <span class="o">=</span> <span class="nx">cross</span><span class="p">(</span><span class="nx">y</span><span class="p">,</span> <span class="nx">y</span><span class="p">);</span>

<span class="p">}</span> <span class="c1">// Operations scope</span>
</pre></div>
</div>
</div>
<div class="section" id="properties">
<h2><a class="toc-backref" href="#id12">Properties</a><a class="headerlink" href="#properties" title="Permalink to this headline">Â¶</a></h2>
<p>There are several functions for computing matrix properties.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">norm</span></code> procedures are documented in the <a class="reference internal" href="../modules/packages/Norm.html#module-Norm" title="Norm: Matrix and Vector Norms"><code class="xref chpl chpl-mod docutils literal notranslate"><span class="pre">Norm</span></code></a> module.</p>
<p>Trace of a matrix</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">tr</span> <span class="o">=</span> <span class="nx">trace</span><span class="p">(</span><span class="nx">diagMatrix</span><span class="p">);</span> <span class="c1">// 6.0</span>
</pre></div>
</div>
<p>Norm of a vector</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">N1</span> <span class="o">=</span> <span class="nx">norm</span><span class="p">(</span><span class="nx">vec</span><span class="p">);</span> <span class="c1">// 3.74166</span>
</pre></div>
</div>
<p>Norm of a matrix</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">N2</span> <span class="o">=</span> <span class="nx">norm</span><span class="p">(</span><span class="nx">diagMatrix</span><span class="p">);</span> <span class="c1">// 3.74166</span>
</pre></div>
</div>
</div>
<div class="section" id="structure">
<h2><a class="toc-backref" href="#id13">Structure</a><a class="headerlink" href="#structure" title="Permalink to this headline">Â¶</a></h2>
<p>There are several functions for inspecting and extracting matrix structure.</p>
<p>Below are a few examples. For the comprehensive list of available structural
functions, see the documentation starting at <a class="reference internal" href="../modules/packages/LinearAlgebra.html#LinearAlgebra.diag" title="LinearAlgebra.diag"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">LinearAlgebra.diag</span></code></a>.</p>
<p>Extract diagonal of matrix</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">diagVec</span> <span class="o">=</span> <span class="nx">diag</span><span class="p">(</span><span class="nx">diagMatrix</span><span class="p">);</span> <span class="c1">// 1.0 2.0 3.0</span>
</pre></div>
</div>
<p>Confirm that a matrix is diagonal</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">writeln</span><span class="p">(</span><span class="nx">isDiag</span><span class="p">(</span><span class="nx">diagMatrix</span><span class="p">));</span> <span class="c1">// true</span>
</pre></div>
</div>
<p>Extract upper triangle of matrix</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">onesMatrix</span> <span class="o">=</span> <span class="nx">Matrix</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">);</span>
<span class="nx">onesMatrix</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">onesMatrix</span><span class="p">);</span>
  <span class="c1">// Prints:</span>
  <span class="c1">//   1.0 1.0 1.0 1.0 1.0</span>
  <span class="c1">//   1.0 1.0 1.0 1.0 1.0</span>
  <span class="c1">//   1.0 1.0 1.0 1.0 1.0</span>
  <span class="c1">//   1.0 1.0 1.0 1.0 1.0</span>
  <span class="c1">//   1.0 1.0 1.0 1.0 1.0</span>
<span class="kd">var</span> <span class="nx">upper</span> <span class="o">=</span> <span class="nx">triu</span><span class="p">(</span><span class="nx">onesMatrix</span><span class="p">,</span> <span class="nx">k</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span> <span class="c1">// k=0 includes diagonal</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">upper</span><span class="p">);</span>
  <span class="c1">// Prints:</span>
  <span class="c1">//   1.0 1.0 1.0 1.0 1.0</span>
  <span class="c1">//   0.0 1.0 1.0 1.0 1.0</span>
  <span class="c1">//   0.0 0.0 1.0 1.0 1.0</span>
  <span class="c1">//   0.0 0.0 0.0 1.0 1.0</span>
  <span class="c1">//   0.0 0.0 0.0 0.0 1.0</span>
</pre></div>
</div>
<p>Confirm that a matrix is upper triangular</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">writeln</span><span class="p">(</span><span class="nx">isTriu</span><span class="p">(</span><span class="nx">upper</span><span class="p">));</span>         <span class="c1">// true</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">isTriu</span><span class="p">(</span><span class="nx">upper</span><span class="p">,</span> <span class="nx">k</span><span class="o">=</span><span class="mi">1</span><span class="p">));</span>    <span class="c1">// false (k=1 does not include diagonal)</span>
</pre></div>
</div>
</div>
<div class="section" id="linearalgebra-sparse">
<h2><a class="toc-backref" href="#id14">LinearAlgebra.Sparse</a><a class="headerlink" href="#linearalgebra-sparse" title="Permalink to this headline">Â¶</a></h2>
<p>The <a class="reference internal" href="../modules/packages/LinearAlgebra/Sparse.html#module-Sparse" title="Sparse: Linear Algebra Sparse Submodule"><code class="xref chpl chpl-mod docutils literal notranslate"><span class="pre">Sparse</span></code></a> submodule supports operations on sparse
matrices.</p>
<p>When using the <a class="reference internal" href="../modules/packages/LinearAlgebra.html#module-LinearAlgebra" title="LinearAlgebra: A high-level interface to linear algebra operations and procedures."><code class="xref chpl chpl-mod docutils literal notranslate"><span class="pre">LinearAlgebra</span></code></a> module, this submodule can be accessed
like so:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="kd">var</span> <span class="nx">A</span> <span class="o">=</span> <span class="nx">Sparse</span><span class="p">.</span><span class="nx">CSRDomain</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Alternatively, one can expose all the submodule symbols with an additional
use statement:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">LinearAlgebra</span><span class="p">.</span><span class="nx">Sparse</span><span class="p">;</span>
</pre></div>
</div>
<p>Now we can do:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="kd">var</span> <span class="nx">A</span> <span class="o">=</span> <span class="nx">CSRDomain</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="supported-sparse-layouts">
<h3><a class="toc-backref" href="#id15">Supported Sparse Layouts</a><a class="headerlink" href="#supported-sparse-layouts" title="Permalink to this headline">Â¶</a></h3>
<p>Currently only CSR matrices are supported. A CSR matrix is
composed of a 2D array that is domain-mapped to a <code class="docutils literal notranslate"><span class="pre">CS()</span></code> layout, from
the <a class="reference internal" href="../modules/layouts/LayoutCS.html#module-LayoutCS" title="LayoutCS"><code class="xref chpl chpl-mod docutils literal notranslate"><span class="pre">LayoutCS</span></code></a> layout module.</p>
<p>For example, the following CSR matrix (<code class="docutils literal notranslate"><span class="pre">CS(compressRows=true)</span></code>)
<strong>is supported</strong> by this submodule:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="k">use</span> <span class="nx">LayoutCS</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">parentDom</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="o">..</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="o">..</span><span class="mi">100</span><span class="p">};</span>
  <span class="kd">var</span> <span class="nx">csrDom</span><span class="p">:</span> <span class="k">sparse</span> <span class="k">subdomain</span><span class="p">(</span><span class="nx">parentDom</span><span class="p">)</span> <span class="k">dmapped</span> <span class="nx">CS</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">csrMatrix</span><span class="p">:</span> <span class="p">[</span><span class="nx">csrDom</span><span class="p">]</span> <span class="kt">real</span><span class="p">;</span> <span class="c1">// Supported by LinearAlgebra.Sparse</span>
<span class="p">}</span>
</pre></div>
</div>
<p>And as a counter-example, the following COO matrix (<code class="docutils literal notranslate"><span class="pre">DefaultSparse</span></code>)
<strong>is not supported</strong> by this module:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="kd">const</span> <span class="nx">parentDom</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="o">..</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="o">..</span><span class="mi">100</span><span class="p">};</span>
  <span class="kd">var</span> <span class="nx">cooDom</span><span class="p">:</span> <span class="k">sparse</span> <span class="k">subdomain</span><span class="p">(</span><span class="nx">parentDom</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">cooMatrix</span><span class="p">:</span> <span class="p">[</span><span class="nx">cooDom</span><span class="p">]</span> <span class="kt">real</span><span class="p">;</span> <span class="c1">// NOT supported by LinearAlgebra.Sparse</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For more information about working with sparse arrays in Chapel, see the
<a class="reference internal" href="sparse.html#primers-sparse"><span class="std std-ref">Sparse Primer</span></a>.</p>
</div>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id16">Factory Functions</a><a class="headerlink" href="#id1" title="Permalink to this headline">Â¶</a></h3>
<p>The <a class="reference internal" href="../modules/packages/LinearAlgebra/Sparse.html#module-Sparse" title="Sparse: Linear Algebra Sparse Submodule"><code class="xref chpl chpl-mod docutils literal notranslate"><span class="pre">Sparse</span></code></a> submodule provides
factory functions for both sparse domains and sparse matrices.</p>
<p>In Chapel, sparse domains can only be modified directly, so it is important
to maintain access to both
the sparse array and sparse domain.</p>
<p>Consider the following example:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="c1">// Bad example of LinearAlgebra.Sparse usage:</span>
  <span class="kd">var</span> <span class="nx">A</span> <span class="o">=</span> <span class="nx">CSRMatrix</span><span class="p">({</span><span class="mi">1</span><span class="o">..</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="o">..</span><span class="mi">100</span><span class="p">});</span> <span class="c1">// Create a CSR matrix from dense domain</span>
  <span class="nx">writeln</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="k">domain</span><span class="p">);</span> <span class="c1">// empty sparse domain, with no way to add elements..</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above sparse matrix is initialized with an empty domain, and the user
has no way of accessing that domain. Therefore, it is not possible to add
indices to the sparse domain.</p>
<p>Instead, users should interact with both the sparse domain and sparse array:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="c1">// Good example of LinearAlgebra.Sparse usage:</span>
  <span class="kd">var</span> <span class="nx">D</span> <span class="o">=</span> <span class="nx">CSRDomain</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span> <span class="c1">// empty sparse domain</span>
  <span class="kd">var</span> <span class="nx">A</span> <span class="o">=</span> <span class="nx">CSRMatrix</span><span class="p">(</span><span class="nx">D</span><span class="p">);</span> <span class="c1">// Create a CSR matrix from a sparse domain</span>
  <span class="nx">D</span> <span class="o">+=</span> <span class="p">[(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">24</span><span class="p">),</span> <span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">42</span><span class="p">)];</span> <span class="c1">// Add some indices to the sparse domain</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Below are a list of the available factory functions:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="c1">// Factory functions scope</span>
</pre></div>
</div>
<p>Creating CSR domains &amp; arrays in Chapel without <code class="docutils literal notranslate"><span class="pre">LinearAlgebra.Sparse</span></code>:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">LayoutCS</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">parentDom</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="o">..#</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="o">..#</span><span class="mi">3</span><span class="p">};</span> <span class="c1">// Parent domain</span>
<span class="kd">var</span> <span class="nx">csrDom</span><span class="p">:</span> <span class="k">sparse</span> <span class="k">subdomain</span><span class="p">(</span><span class="nx">parentDom</span><span class="p">)</span> <span class="k">dmapped</span> <span class="nx">CS</span><span class="p">();</span> <span class="c1">// CSR domain</span>
<span class="kd">var</span> <span class="nx">csrArr</span><span class="p">:</span> <span class="p">[</span><span class="nx">csrDom</span><span class="p">]</span> <span class="kt">real</span><span class="p">;</span> <span class="c1">// CSR array</span>
</pre></div>
</div>
<p>Adding indices to a sparse domain:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">csrDom</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="nx">csrDom</span> <span class="o">+=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)];</span>
</pre></div>
</div>
<p>Creating CSR domains with <code class="docutils literal notranslate"><span class="pre">LinearAlgebra.Sparse</span></code>:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">D1</span> <span class="o">=</span> <span class="nx">CSRDomain</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>                 <span class="c1">// from a length</span>
<span class="kd">var</span> <span class="nx">D2</span> <span class="o">=</span> <span class="nx">CSRDomain</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>              <span class="c1">// from a length and width</span>
<span class="kd">var</span> <span class="nx">D3</span> <span class="o">=</span> <span class="nx">CSRDomain</span><span class="p">(</span><span class="mi">0</span><span class="o">..#</span><span class="mi">3</span><span class="p">);</span>             <span class="c1">// from 1 range</span>
<span class="kd">var</span> <span class="nx">D4</span> <span class="o">=</span> <span class="nx">CSRDomain</span><span class="p">(</span><span class="mi">0</span><span class="o">..#</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="o">..#</span><span class="mi">3</span><span class="p">);</span>      <span class="c1">// from 2 ranges</span>
<span class="kd">var</span> <span class="nx">D5</span> <span class="o">=</span> <span class="nx">CSRDomain</span><span class="p">({</span><span class="mi">0</span><span class="o">..#</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="o">..#</span><span class="mi">3</span><span class="p">});</span>    <span class="c1">// from a 2D domain</span>
</pre></div>
</div>
<p>Creating CSR matrices:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">M1</span> <span class="o">=</span> <span class="nx">CSRMatrix</span><span class="p">(</span><span class="nx">D1</span><span class="p">);</span>             <span class="c1">// from a CSR domain</span>
<span class="kd">var</span> <span class="nx">M2</span> <span class="o">=</span> <span class="nx">CSRMatrix</span><span class="p">({</span><span class="mi">0</span><span class="o">..#</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="o">..#</span><span class="mi">3</span><span class="p">});</span> <span class="c1">// from a dense domain</span>
<span class="kd">var</span> <span class="nx">M3</span> <span class="o">=</span> <span class="nx">CSRMatrix</span><span class="p">(</span><span class="nx">M1</span><span class="p">);</span>             <span class="c1">// From a CSR matrix</span>
<span class="kd">const</span> <span class="nx">I</span> <span class="o">=</span> <span class="nx">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">M4</span> <span class="o">=</span> <span class="nx">CSRMatrix</span><span class="p">(</span><span class="nx">I</span><span class="p">);</span>              <span class="c1">// From a dense matrix</span>
                                    <span class="c1">// Indices holding non-zero elements are</span>
                                    <span class="c1">// added to M4&#39;s sparse domain</span>


<span class="p">}</span> <span class="c1">// Factory functions scope</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h3><a class="toc-backref" href="#id17">Operations</a><a class="headerlink" href="#id2" title="Permalink to this headline">Â¶</a></h3>
<p>Below is a list of the currently supported operations.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For sparse matrices, the element-wise operations such as <code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">-</span></code>, <code class="docutils literal notranslate"><span class="pre">*</span></code>, and <code class="docutils literal notranslate"><span class="pre">/</span></code>
are <a class="reference internal" href="../users-guide/datapar/promotion.html#ug-promotion"><span class="std std-ref">promoted</span></a>, and will result in an error
if there is a sparse domain mismatch.
To avoid this, it is preferred to use the element-wise methods:
<code class="docutils literal notranslate"><span class="pre">.plus()</span></code>, <code class="docutils literal notranslate"><span class="pre">.minus()</span></code>, <code class="docutils literal notranslate"><span class="pre">.times()</span></code>, and <code class="docutils literal notranslate"><span class="pre">.elementDiv()</span></code>.</p>
</div>
<p>Setup some sparse domains and arrays</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="c1">// Operations scope</span>

<span class="kd">var</span> <span class="nx">Adom</span> <span class="o">=</span> <span class="nx">CSRDomain</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="nx">Bdom</span> <span class="o">=</span> <span class="nx">CSRDomain</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="nx">Cdom</span> <span class="o">=</span> <span class="nx">CSRDomain</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>

<span class="nx">Adom</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="nx">Bdom</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="nx">Cdom</span> <span class="o">+=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)];</span>

<span class="kd">var</span> <span class="nx">A</span> <span class="o">=</span> <span class="nx">CSRMatrix</span><span class="p">(</span><span class="nx">Adom</span><span class="p">),</span>
    <span class="nx">B</span> <span class="o">=</span> <span class="nx">CSRMatrix</span><span class="p">(</span><span class="nx">Bdom</span><span class="p">),</span>
    <span class="nx">C</span> <span class="o">=</span> <span class="nx">CSRMatrix</span><span class="p">(</span><span class="nx">Cdom</span><span class="p">);</span>

<span class="nx">A</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
<span class="nx">B</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span>
<span class="nx">C</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">;</span>
</pre></div>
</div>
<p>Element-wise addition.</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">A</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span> <span class="c1">// 1.0, 2.0</span>
<span class="nx">A</span><span class="p">.</span><span class="nx">plus</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span> <span class="c1">// 5.0, 4.0</span>
</pre></div>
</div>
<p>Element-wise subtraction</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">A</span><span class="p">.</span><span class="nx">minus</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span> <span class="c1">// 1.0, -2.0</span>
</pre></div>
</div>
<p>Element-wise multiplication</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">A</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">B</span><span class="p">);</span> <span class="c1">// 0.0, 0.0</span>
<span class="nx">A</span><span class="p">.</span><span class="nx">times</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span> <span class="c1">// 4.0, 4.0</span>
</pre></div>
</div>
<p>Element-wise division</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">A</span><span class="p">.</span><span class="nx">elementDiv</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span> <span class="c1">// 0.25, 0.0</span>
<span class="nx">B</span><span class="p">.</span><span class="nx">elementDiv</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span> <span class="c1">// 0.0, 0.5</span>
</pre></div>
</div>
<p>Matrix-matrix multiplication</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">C</span><span class="p">.</span><span class="nx">dot</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span> <span class="c1">// 16.0, 16.0</span>
</pre></div>
</div>
<p>Matrix-vector multiplication</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">Vector</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="nx">a</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span>
<span class="nx">C</span><span class="p">.</span><span class="nx">dot</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
</pre></div>
</div>
<p>Matrix-scalar multiplication</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">C</span><span class="p">.</span><span class="nx">dot</span><span class="p">(</span><span class="mf">2.0</span><span class="p">);</span> <span class="c1">// equivalent to C.times(2.0);</span>
</pre></div>
</div>
<p>Matrix transpose</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">transpose</span><span class="p">(</span><span class="nx">C</span><span class="p">);</span>
<span class="nx">C</span><span class="p">.</span><span class="nx">T</span><span class="p">;</span> <span class="c1">// short-hand syntax</span>

<span class="p">}</span> <span class="c1">// Operations scope</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="LAPACKlib.html" class="btn btn-neutral float-right" title="LAPACK" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="timers.html" class="btn btn-neutral float-left" title="Timers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Hewlett Packard Enterprise Development LP

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
 



</body>
</html>